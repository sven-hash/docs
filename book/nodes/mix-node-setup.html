<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js coal">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Mix Node - Nym Docs</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="Nym technical documentation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/pagetoc.css">
        <link rel="stylesheet" href="../././mdbook-admonish.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "coal" : "coal";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('coal')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../introduction.html">Introduction</a></li><li class="chapter-item affix "><li class="part-title">Architecture</li><li class="chapter-item "><a href="../architecture/network-overview.html"><strong aria-hidden="true">1.</strong> Network Overview</a></li><li class="chapter-item "><a href="../architecture/traffic-flow.html"><strong aria-hidden="true">2.</strong> Mixnet Traffic Flow</a></li><li class="chapter-item "><a href="../architecture/network-rewards.html"><strong aria-hidden="true">3.</strong> Network Rewards</a></li><li class="chapter-item affix "><li class="part-title">Binaries</li><li class="chapter-item "><a href="../binaries/pre-built-binaries.html"><strong aria-hidden="true">4.</strong> Pre-built Binaries</a></li><li class="chapter-item "><a href="../binaries/building-nym.html"><strong aria-hidden="true">5.</strong> Building from Source</a></li><li class="chapter-item "><a href="../binaries/init-and-config.html"><strong aria-hidden="true">6.</strong> Binary Initialisation and Configuration</a></li><li class="chapter-item "><a href="../binaries/version-compatiblity.html"><strong aria-hidden="true">7.</strong> Version Compatibility Table</a></li><li class="chapter-item affix "><li class="part-title">Nodes</li><li class="chapter-item expanded "><a href="../nodes/setup-guides.html"><strong aria-hidden="true">8.</strong> Node Setup Guides</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../nodes/mix-node-setup.html" class="active"><strong aria-hidden="true">8.1.</strong> Mix Node</a></li><li class="chapter-item "><a href="../nodes/gateway-setup.html"><strong aria-hidden="true">8.2.</strong> Gateway</a></li><li class="chapter-item "><a href="../nodes/network-requester-setup.html"><strong aria-hidden="true">8.3.</strong> Network Requester</a></li><li class="chapter-item "><a href="../nodes/validator-setup.html"><strong aria-hidden="true">8.4.</strong> Validator</a></li></ol></li><li class="chapter-item "><a href="../nodes/troubleshooting.html"><strong aria-hidden="true">9.</strong> Troubleshooting</a></li><li class="chapter-item affix "><li class="part-title">Clients</li><li class="chapter-item "><a href="../clients/overview.html"><strong aria-hidden="true">10.</strong> Clients Overview</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../clients/websocket-client.html"><strong aria-hidden="true">10.1.</strong> Websocket</a></li><li class="chapter-item "><a href="../clients/socks5-client.html"><strong aria-hidden="true">10.2.</strong> Socks5</a></li><li class="chapter-item "><a href="../clients/webassembly-client.html"><strong aria-hidden="true">10.3.</strong> Webassembly</a></li></ol></li><li class="chapter-item "><a href="../clients/addressing-system.html"><strong aria-hidden="true">11.</strong> Addressing System</a></li><li class="chapter-item affix "><li class="part-title">SDK</li><li class="chapter-item "><a href="../sdk/typescript.html"><strong aria-hidden="true">12.</strong> Typescript SDK</a></li><li class="chapter-item "><a href="../sdk/rust.html"><strong aria-hidden="true">13.</strong> Rust SDK (coming soon)</a></li><li class="chapter-item affix "><li class="part-title">Wallet</li><li class="chapter-item "><a href="../wallet/desktop-wallet.html"><strong aria-hidden="true">14.</strong> Desktop Wallet</a></li><li class="chapter-item "><a href="../wallet/cli-wallet.html"><strong aria-hidden="true">15.</strong> CLI Wallet</a></li><li class="chapter-item affix "><li class="part-title">Explorers</li><li class="chapter-item "><a href="../explorers/mixnet-explorer.html"><strong aria-hidden="true">16.</strong> Mixnet Explorer</a></li><li class="chapter-item "><div><strong aria-hidden="true">17.</strong> Blockchain Explorers</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div><strong aria-hidden="true">17.1.</strong> Nodes Guru</div></li><li class="chapter-item "><div><strong aria-hidden="true">17.2.</strong> TODO Others</div></li></ol></li><li class="chapter-item "><li class="part-title">Nyx Blockchain</li><li class="chapter-item "><a href="../nyx/interacting-with-chain.html"><strong aria-hidden="true">18.</strong> Interacting with Nyx Chain and Smart Contracts</a></li><li class="chapter-item "><a href="../nyx/smart-contracts.html"><strong aria-hidden="true">19.</strong> Smart Contracts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../nyx/mixnet-contract.html"><strong aria-hidden="true">19.1.</strong> Mixnet Contract</a></li><li class="chapter-item "><a href="../nyx/vesting-contract.html"><strong aria-hidden="true">19.2.</strong> Vesting Contract</a></li></ol></li><li class="chapter-item "><a href="../nyx/rpc-node.html"><strong aria-hidden="true">20.</strong> RPC Nodes</a></li><li class="chapter-item affix "><li class="part-title">Tools</li><li class="chapter-item "><a href="../tools/nym-cli.html"><strong aria-hidden="true">21.</strong> NymCLI</a></li><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Misc.</li><li class="chapter-item "><a href="../coc.html"><strong aria-hidden="true">22.</strong> Code of Conduct</a></li><li class="chapter-item "><a href="../licensing.html"><strong aria-hidden="true">23.</strong> Licensing</a></li><li class="spacer"></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Nym Docs</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main><div class="sidetoc"><nav class="pagetoc"></nav></div>
                        <h1 id="mix-nodes"><a class="header" href="#mix-nodes">Mix Nodes</a></h1>
<blockquote>
<p>The Nym mix node binary was built in the <a href="../binaries/building-nym.html">building nym</a> section. If you haven’t yet built Nym and want to run the code, go there first.</p>
</blockquote>
<h2 id="preliminary-steps"><a class="header" href="#preliminary-steps">Preliminary steps</a></h2>
<p>There are a couple of steps that need completing before starting to set up your mix node:</p>
<ul>
<li>preparing your wallet</li>
<li>requisitioning a VPS (Virtual Private Server)</li>
</ul>
<h3 id="wallet-preparation"><a class="header" href="#wallet-preparation">Wallet preparation</a></h3>
<h4 id="mainnet"><a class="header" href="#mainnet">Mainnet</a></h4>
<p>Before you initialise and run your mixnode, head to our <a href="https://nymtech.net/download/">website</a> and download the Nym wallet for your operating system. If pre-compiled binaries for your operating system aren’t availiable, you can build the wallet yourself with instructions <a href="../wallet/desktop-wallet.html">here</a>.</p>
<p>If you don’t already have one, please create a Nym address using the wallet, and fund it with tokens. The minimum amount required to bond a mixnode is 100 <code>NYM</code>, but make sure you have a bit more to account for gas costs.</p>
<p><code>NYM</code> is currently present on several exchanges. Head to our <a href="https://t.me/nymchan">telegram channels</a> to find out where to get <code>NYM</code> tokens.</p>
<blockquote>
<p>Remember that you can <strong>only</strong> use Cosmos <code>NYM</code> tokens to bond your mixnode. You <strong>cannot</strong> use ERC20 representations of <code>NYM</code> to run a node.</p>
</blockquote>
<h4 id="sandbox-testnet"><a class="header" href="#sandbox-testnet">Sandbox testnet</a></h4>
<p>Make sure to download a wallet and create an account as outlined above. Then head to our <a href="https://faucet.nymtech.net/">token faucet</a> and get some tokens to use to bond it.</p>
<h3 id="vps-hardware-specs"><a class="header" href="#vps-hardware-specs">VPS Hardware Specs</a></h3>
<p>You will need to rent a VPS to run your mix node on. One key reason for this is that your node <strong>must be able to send TCP data using both IPv4 and IPv6</strong> (as other nodes you talk to may use either protocol).</p>
<p>For the moment, we haven’t put a great amount of effort into optimizing concurrency to increase throughput, so don’t bother provisioning a beastly server with multiple cores. This will change when we get a chance to start doing performance optimizations in a more serious way. Sphinx packet decryption is CPU-bound, so once we optimise, more fast cores will be better.</p>
<p>For now, see the below rough specs:</p>
<ul>
<li>Processors: 2 cores are fine. Get the fastest CPUs you can afford.</li>
<li>RAM: Memory requirements are very low - typically a mix node may use only a few hundred MB of RAM.</li>
<li>Disks: The mixnodes require no disk space beyond a few bytes for the configuration files. </li>
</ul>
<h2 id="mix-node-setup"><a class="header" href="#mix-node-setup">Mix node setup</a></h2>
<p>Now that you have built the codebase, set up your wallet, and have a VPS with the <code>nym-mixnode</code> binary, you can set up your mix node with the instructions below.</p>
<h3 id="viewing-command-help"><a class="header" href="#viewing-command-help">Viewing command help</a></h3>
<p>You can check that your binaries are properly compiled with:</p>
<pre><code>./nym-mixnode --help
</code></pre>
<p>Which should return a list of all avaliable commands.</p>
<details id="admonition-console-output" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="#admonition-console-output"></a></p>
</summary>
<div>
<pre><code>  _ __  _   _ _ __ ___
 | '_ \| | | | '_ \ _ \
 | | | | |_| | | | | | |
 |_| |_|\__, |_| |_| |_|
        |___/

         (mixnode - version 1.1.4)

        
nym-mixnode 1.1.4
Nymtech
Implementation of a Loopix-based Mixnode

USAGE:
    nym-mixnode [OPTIONS] &lt;SUBCOMMAND&gt;

OPTIONS:
        --config-env-file &lt;CONFIG_ENV_FILE&gt;
            Path pointing to an env file that configures the mixnode

    -h, --help
            Print help information

    -V, --version
            Print version information

SUBCOMMANDS:
    completions          Generate shell completions
    describe             Describe your mixnode and tell people why they should delegate state to you
    generate-fig-spec    Generate Fig specification
    help                 Print this message or the help of the given subcommand(s)
    init                 Initialise the mixnode
    node-details         Show details of this mixnode
    run                  Starts the mixnode
    sign                 Sign text to prove ownership of this mixnode
    upgrade              Try to upgrade the mixnode

    nym-mixnode 1.1.4
    Nymtech
</code></pre>
</div>
</details>
<p>You can also check the various arguments required for individual commands with:</p>
<pre><code>./nym-mixnode &lt;command&gt; --help
</code></pre>
<h3 id="initialising-your-mix-node"><a class="header" href="#initialising-your-mix-node">Initialising your mix node</a></h3>
<p>To check available configuration options for initializing your node use:</p>
<pre><code>./nym-mixnode init --help
</code></pre>
<details id="admonition-console-output-1" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="#admonition-console-output-1"></a></p>
</summary>
<div>
<pre><code>  _ __  _   _ _ __ ___
 | '_ \| | | | '_ \ _ \
 | | | | |_| | | | | | |
 |_| |_|\__, |_| |_| |_|
        |___/

         (mixnode - version 1.1.4)

        
nym-mixnode-init 
Initialise the mixnode

USAGE:
    nym-mixnode init [OPTIONS] --id &lt;ID&gt; --host &lt;HOST&gt; --wallet-address &lt;WALLET_ADDRESS&gt;

OPTIONS:
        --announce-host &lt;ANNOUNCE_HOST&gt;
            The custom host that will be reported to the directory server

    -h, --help
            Print help information

        --host &lt;HOST&gt;
            The host on which the mixnode will be running

        --http-api-port &lt;HTTP_API_PORT&gt;
            The port on which the mixnode will be listening for http requests

        --id &lt;ID&gt;
            Id of the mixnode we want to create config for

        --mix-port &lt;MIX_PORT&gt;
            The port on which the mixnode will be listening for mix packets

        --validators &lt;VALIDATORS&gt;
            Comma separated list of rest endpoints of the validators

        --verloc-port &lt;VERLOC_PORT&gt;
            The port on which the mixnode will be listening for verloc packets

        --wallet-address &lt;WALLET_ADDRESS&gt;
            The wallet address you will use to bond this mixnode, e.g.
            nymt1z9egw0knv47nmur0p8vk4rcx59h9gg4zuxrrr9
</code></pre>
</div>
</details>
<p>Initalise your mixnode with the following command, replacing the value of <code>--id</code> with the moniker you wish to give your mixnode, and the <code>--wallet-address</code> with the Nym address you created earlier. Your <code>--host</code> must be publicly routable on the internet in order to mix packets, and can be either an Ipv4 or IPv6 address. The <code>$(curl ifconfig.me)</code> command returns your IP automatically using an external service. If you enter your IP address manually, enter it <strong>without</strong> any port information.</p>
<pre><code>./nym-mixnode init --id winston-smithnode --host $(curl ifconfig.me) --wallet-address &lt;wallet-address&gt;
</code></pre>
<blockquote>
<p>The <code>init</code> command will refuse to destroy existing mix node keys.</p>
</blockquote>
<p>During the <code>init</code> process you will have the option to change the <code>http_api</code>, <code>verloc</code> and <code>mixnode</code> ports from their default settings. If you wish to change these in the future you can edit their values in the <code>config.toml</code> file created by the initialization process, which is located at <code>~/.nym/mixnodes/&lt;your-id&gt;/</code>.</p>
<h3 id="bonding-your-mix-node"><a class="header" href="#bonding-your-mix-node">Bonding your mix node</a></h3>
<div id="admonition-caution" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="#admonition-caution"></a></p>
</div>
<div>
<p>From <code>v1.1.3</code>, if you unbond your mixnode that means you are leaving the mixnet and you will lose all your delegations (permanently). You can join again with the same identity key, however, you will start with <strong>no delegations</strong>.</p>
</div>
</div>
<h4 id="bond-via-the-desktop-wallet-recommended"><a class="header" href="#bond-via-the-desktop-wallet-recommended">Bond via the Desktop wallet (recommended)</a></h4>
<p>You can bond your mix node via the Desktop wallet.</p>
<p>Open your wallet, and head to the <code>Bond</code> page, then select the node type and input your node details.</p>
<h4 id="bond-via-the-cli-power-users"><a class="header" href="#bond-via-the-cli-power-users">Bond via the CLI (power users)</a></h4>
<p>If you want to bond your Gateway via the CLI, then check out the <a href="../tools/nym-cli.html">Nym CLI</a> tool. </p>
<h3 id="running-your-mix-node"><a class="header" href="#running-your-mix-node">Running your mix node</a></h3>
<p>Now you’ve bonded your mix node, run it with:</p>
<pre><code>./nym-mixnode run --id winston-smithnode
</code></pre>
<details id="admonition-console-output-2" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="#admonition-console-output-2"></a></p>
</summary>
<div>
<pre><code>
Starting mixnode winston-smithnode...

To bond your mixnode you will need to install the Nym wallet, go to https://nymtech.net/get-involved and select the Download button.
Select the correct version and install it to your machine. You will need to provide the following:

Identity Key: GWrymUuLaxVHSs8iE7YW48MB81npnKjrVuJzJsGkeji6
Sphinx Key: FU89ULkS4YYDXcm5jShhJvoit7H4jG4EXHxRKbS9cXSJ
Owner Signature: Kd5StZtg5PsjLtWRJ5eQejuLHz3JUNzZrk6Jd4WVS5u9Q5bFt6DvuVzN7NbiX9WMZYpsYMJoegH3Bz94o6gsY6b
Host: 62.240.134.46 (bind address: 62.240.134.46)
Version: 1.1.4
Mix Port: 1789, Verloc port: 1790, Http Port: 8000

You are bonding to wallet address: n1x42mm3gsdg808qu2n3ah4l4r9y7vfdvwkw8az6


2022-04-27T16:08:01.159Z INFO  nym_mixnode::node &gt; Starting nym mixnode
2022-04-27T16:08:01.490Z INFO  nym_mixnode::node &gt; Starting node stats controller...
2022-04-27T16:08:01.490Z INFO  nym_mixnode::node &gt; Starting packet delay-forwarder...
2022-04-27T16:08:01.490Z INFO  nym_mixnode::node &gt; Starting socket listener...
2022-04-27T16:08:01.490Z INFO  nym_mixnode::node::listener &gt; Running mix listener on &quot;62.240.134.46:1789&quot;
2022-04-27T16:08:01.490Z INFO  nym_mixnode::node           &gt; Starting the round-trip-time measurer...

</code></pre>
</div>
</details>
<p>If everything worked, you’ll see your node running on the either the <a href="https://sandbox-explorer.nymtech.net">Sandbox testnet network explorer</a> or the <a href="https://explorer.nymtech.net">mainnet network explorer</a>, depending on which network you’re running.</p>
<p>Note that your node’s public identity key is displayed during startup, you can use it to identify your node in the list.</p>
<p>Keep reading to find out more about configuration options or troubleshooting if you’re having issues. There are also some tips for running on AWS and other cloud providers, some of which require minor additional setup.</p>
<p>Also have a look at the saved configuration files in <code>$HOME/.nym/mixnodes/</code> to see more configuration options.</p>
<h3 id="describe-your-mix-node-optional"><a class="header" href="#describe-your-mix-node-optional">Describe your mix node (optional)</a></h3>
<p>In order to easily identify your node via human-readable information later on in the development of the testnet when delegated staking is implemented, you can <code>describe</code> your mixnode with the following command:</p>
<pre><code>./nym-mixnode describe --id winston-smithnode
</code></pre>
<details id="admonition-console-output-3" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="#admonition-console-output-3"></a></p>
</summary>
<div>
<pre><code>name: winston-smithnode
description: nym-mixnode hosted on Linode VPS in &lt;location&gt; with the following specs: &lt;specs&gt;.
link, e.g. https://mixnode.yourdomain.com: mixnode.mydomain.net
location, e.g. City: London, Country: UK: &lt;your_location&gt;

This information will be shown in the mixnode's page in the Network Explorer, and help people make delegated staking decisions.
</code></pre>
</div>
</details>
<blockquote>
<p>Remember to restart your mix node process in order for the new description to be propogated</p>
</blockquote>
<h3 id="upgrading-your-mix-node"><a class="header" href="#upgrading-your-mix-node">Upgrading your mix node</a></h3>
<ul>
<li>pause your mix node process </li>
<li>replace the existing binary with the newest binary (which you can either compile yourself or grab from our <a href="https://github.com/nymtech/nym/releases">releases page</a>)</li>
<li>re-run <code>init</code> with the same values as you used initially. <strong>This will just update the config file, it will not overwrite existing keys</strong>. </li>
<li>restart your mix node process with the new binary. </li>
</ul>
<blockquote>
<p>Do <strong>not</strong> use the <code>upgrade</code> command: there is a known error with the command that will be fixed in the next release. </p>
</blockquote>
<h3 id="displaying-mix-node-information"><a class="header" href="#displaying-mix-node-information">Displaying mix node information</a></h3>
<p>You can always check the details of your mix node with the <code>node-details</code> command:</p>
<pre><code>./nym-mixnode node-details --id winston-smithnode
</code></pre>
<details id="admonition-console-output-4" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="#admonition-console-output-4"></a></p>
</summary>
<div>
<pre><code>
Identity Key: GWrymUuLaxVHSs8iE7YW48MB81npnKjrVuJzJsGkeji6
Sphinx Key: FU89ULkS4YYDXcm5jShhJvoit7H4jG4EXHxRKbS9cXSJ
Owner Signature: Kd5StZtg5PsjLtWRJ5eQejuLHz3JUNzZrk6Jd4WVS5u9Q5bFt6DvuVzN7NbiX9WMZYpsYMJoegH3Bz94o6gsY6b
Host: 62.240.134.46 (bind address: 62.240.134.46)
Version: 1.1.4
Mix Port: 1789, Verloc port: 1790, Http Port: 8000

You are bonding to wallet address: n1x42mm3gsdg808qu2n3ah4l4r9y7vfdvwkw8az6

</code></pre>
</div>
</details>
<h2 id="vps-setup-and-automation"><a class="header" href="#vps-setup-and-automation">VPS Setup and Automation</a></h2>
<h3 id="configure-your-firewall"><a class="header" href="#configure-your-firewall">Configure your firewall</a></h3>
<p>The following commands will allow you to set up a firewall using <code>ufw</code>.</p>
<pre><code># check if you have ufw installed
ufw version
# if it is not installed, install with
sudo apt install ufw -y
# enable ufw
sudo ufw enable
# check the status of the firewall
sudo ufw status
</code></pre>
<p>Finally open your mix node’s p2p port, as well as ports for ssh, http, and https connections, and ports <code>8000</code> and <code>1790</code> for verloc and measurement pings:</p>
<pre><code>sudo ufw allow 1789,1790,8000,22,80,443/tcp
# check the status of the firewall
sudo ufw status
</code></pre>
<p>For more information about your mix node’s port configuration, check the <a href="./mix-node-setup.html#mixnode-port-reference">mix node port reference table</a> below.</p>
<h3 id="automating-your-mix-node-with-systemd"><a class="header" href="#automating-your-mix-node-with-systemd">Automating your mix node with systemd</a></h3>
<p>It’s useful to have the mix node automatically start at system boot time. Here’s a systemd service file to do that:</p>
<pre><code class="language-ini">[Unit]
Description=Nym Mixnode (1.1.4)
StartLimitInterval=350
StartLimitBurst=10

[Service]
User=nym
LimitNOFILE=65536
ExecStart=/home/nym/nym-mixnode run --id mix0100
KillSignal=SIGINT
Restart=on-failure
RestartSec=30

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Put the above file onto your system at <code>/etc/systemd/system/nym-mixnode.service</code>.</p>
<p>Change the path in <code>ExecStart</code> to point at your mix node binary (<code>nym-mixnode</code>), and the <code>User</code> so it is the user you are running as.</p>
<p>If you have built nym on your server, and your username is <code>jetpanther</code>, then the start command might look like this:</p>
<p><code>ExecStart=/home/jetpanther/nym/target/release/nym-mixnode run --id your-id</code>. Basically, you want the full <code>/path/to/nym-mixnode run --id whatever-your-node-id-is</code></p>
<p>Then run:</p>
<pre><code>systemctl enable nym-mixnode.service
</code></pre>
<p>Start your node:</p>
<pre><code>service nym-mixnode start
</code></pre>
<p>This will cause your node to start at system boot time. If you restart your machine, the node will come back up automatically.</p>
<p>You can also do <code>service nym-mixnode stop</code> or <code>service nym-mixnode restart</code>.</p>
<p>Note: if you make any changes to your systemd script after you’ve enabled it, you will need to run:</p>
<pre><code>systemctl daemon-reload
</code></pre>
<p>This lets your operating system know it’s ok to reload the service configuration.</p>
<h4 id="setting-the-ulimit"><a class="header" href="#setting-the-ulimit">Setting the ulimit</a></h4>
<p>Linux machines limit how many open files a user is allowed to have. This is called a <code>ulimit</code>.</p>
<p><code>ulimit</code> is 1024 by default on most systems. It needs to be set higher, because mix nodes make and receive a lot of connections to other nodes.</p>
<p>If you see errors such as:</p>
<pre><code>Failed to accept incoming connection - Os { code: 24, kind: Other, message: &quot;Too many open files&quot; }
</code></pre>
<p>This means that the operating system is preventing network connections from being made.</p>
<h5 id="set-the-ulimit-via-systemd-service-file"><a class="header" href="#set-the-ulimit-via-systemd-service-file">Set the ulimit via <code>systemd</code> service file</a></h5>
<p>Query the <code>ulimit</code> of your mix node with:</p>
<pre><code>grep -i &quot;open files&quot; /proc/$(ps -A -o pid,cmd|grep nym-mixnode | grep -v grep |head -n 1 | awk '{print $1}')/limits
</code></pre>
<p>You’ll get back the hard and soft limits, which looks something like this:</p>
<pre><code>Max open files            65536                65536                files
</code></pre>
<p>If your output is <strong>the same as above</strong>, your node will not encounter any <code>ulimit</code> related issues.</p>
<p>However if either value is <code>1024</code>, you must raise the limit via the systemd service file. Add the line:</p>
<pre><code>LimitNOFILE=65536
</code></pre>
<p>Reload the daemon:</p>
<pre><code>systemctl daemon-reload
</code></pre>
<p>or execute this as root for system-wide setting of <code>ulimit</code>:</p>
<pre><code>echo &quot;DefaultLimitNOFILE=65535&quot; &gt;&gt; /etc/systemd/system.conf
</code></pre>
<p>Reboot your machine and restart your node. When it comes back, use <code>cat /proc/$(pidof nym-mixnode)/limits | grep &quot;Max open files&quot;</code> to make sure the limit has changed to 65535.</p>
<h5 id="set-the-ulimit-on-non-systemd-based-distributions"><a class="header" href="#set-the-ulimit-on-non-systemd-based-distributions">Set the ulimit on <code>non-systemd</code> based distributions</a></h5>
<p>Edit <code>etc/security/conf</code> and add the following lines:</p>
<pre><code># Example hard limit for max opened files
username        hard nofile 4096
# Example soft limit for max opened files
username        soft nofile 4096
</code></pre>
<p>Then reboot your server and restart your mixnode.</p>
<h2 id="node-families"><a class="header" href="#node-families">Node Families</a></h2>
<h3 id="joining-a-node-family"><a class="header" href="#joining-a-node-family">Joining a Node Family</a></h3>
<p>Ssh into the vps of the family head and run the following command to obtain the signature for the member. The value is the <strong>identity key</strong> of the mix node which wants to join the family: </p>
<pre><code>./nym-mixnode sign --id mixnode --text 4Yr4qmEHd9sgsuQ83191FR2hD88RfsbMmB4tzhhZWriz
</code></pre>
<p>This will return a signature which is going to be used below - in this example it is <code>3SEjfNcJ5L3cXdvWCdiQNT5DkCFJ2TurK5xsYyEdHH324nAA3bWvKoXmkjU9Xbr9ZyemGDLJ4dmGEHWUwL1LCWKq</code>. </p>
<p>The <code>--from</code> is going to be the mnemonic of the member wanting to join the family: </p>
<pre><code>./nyxd tx wasm execute ${MIXNET-CONTRACT} '{&quot;join_family&quot;: {&quot;signature&quot;: &quot;3SEjfNcJ5L3cXdvWCdiQNT5DkCFJ2TurK5xsYyEdHH324nAA3bWvKoXmkjU9Xbr9ZyemGDLJ4dmGEHWUwL1LCWKq&quot;,&quot;family_head&quot;: &quot;8A3Pv7Y9xGZdhUYd7sMHKp5y3nn5P3aBDDnJLataYE2J&quot;}}' --node ${VALIDATOR-ENDPOINT} --from mix1 --chain-id nyx --gas-prices 0.025unym --gas auto --gas-adjustment 1.3 -y -b block
</code></pre>
<h3 id="leaving-a-family"><a class="header" href="#leaving-a-family">Leaving a family</a></h3>
<p>If wanting to leave, run the same initial command as above, followed by:</p>
<pre><code>./nyxd tx wasm execute ${MIXNET-CONTRACT} '{&quot;leave_family&quot;: {&quot;signature&quot;: &quot;3SEjfNcJ5L3cXdvWCdiQNT5DkCFJ2TurK5xsYyEdHH324nAA3bWvKoXmkjU9Xbr9ZyemGDLJ4dmGEHWUwL1LCWKq&quot;,&quot;family_head&quot;: &quot;8A3Pv7Y9xGZdhUYd7sMHKp5y3nn5P3aBDDnJLataYE2J&quot;}}' --node ${VALIDATOR-ENDPOINT} --from mix1 --chain-id nyx --gas-prices 0.025unym --gas auto --gas-adjustment 1.3 -y -b block
</code></pre>
<h2 id="checking-that-your-node-is-mixing-correctly"><a class="header" href="#checking-that-your-node-is-mixing-correctly">Checking that your node is mixing correctly</a></h2>
<h3 id="network-explorers"><a class="header" href="#network-explorers">Network explorers</a></h3>
<p>Once you’ve started your mix node and it connects to the validator, your node will automatically show up in the ‘Mix nodes’ section of either the Nym Network Explorers:</p>
<ul>
<li><a href="https://explorer.nymtech.net/overview">Mainnet</a></li>
<li><a href="https://sandbox-explorer.nymtech.net/">Sandbox testnet</a></li>
</ul>
<p>Enter your <strong>identity key</strong> to find your node. There are numerous statistics about your node on that page that are useful for checking your uptime history, packets mixed, and any delegations your node may have.</p>
<p>There are also 2 community explorers which have been created by <a href="https://nodes.guru">Nodes Guru</a>:</p>
<ul>
<li><a href="https://mixnet.explorers.guru/">Mainnet</a></li>
<li><a href="https://sandbox.mixnet.explorers.guru/">Sandbox testnet</a></li>
</ul>
<p>For more details see <a href="../nodes/troubleshooting.html">Troubleshooting FAQ</a></p>
<h3 id="virtual-ips-and-hosting-via-google--aws"><a class="header" href="#virtual-ips-and-hosting-via-google--aws">Virtual IPs and hosting via Google &amp; AWS</a></h3>
<p>On some services (AWS, Google, etc), the machine’s available bind address is not the same as the public IP address. In this case, bind <code>--host</code> to the local machine address returned by <code>ifconfig</code>, but also specify <code>--announce-host</code> with the public IP. Please make sure that you pass the correct, routable <code>--announce-host</code>.</p>
<p>For example, on a Google machine, you may see the following output from the <code>ifconfig</code> command:</p>
<pre><code>ens4: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1460
        inet 10.126.5.7  netmask 255.255.255.255  broadcast 0.0.0.0
        ...
</code></pre>
<p>The <code>ens4</code> interface has the IP <code>10.126.5.7</code>. But this isn’t the public IP of the machine, it’s the IP of the machine on Google’s internal network. Google uses virtual routing, so the public IP of this machine is something else, maybe <code>36.68.243.18</code>.</p>
<p><code>nym-mixnode init --host 10.126.5.7</code>, initalises the mix node, but no packets will be routed because <code>10.126.5.7</code> is not on the public internet.</p>
<p>Trying <code>nym-mixnode init --host 36.68.243.18</code>, you’ll get back a startup error saying <code>AddrNotAvailable</code>. This is because the mix node doesn’t know how to bind to a host that’s not in the output of <code>ifconfig</code>.</p>
<p>The right thing to do in this situation is <code>nym-mixnode init --host 10.126.5.7 --announce-host 36.68.243.18</code>.</p>
<p>This will bind the mix node to the available host <code>10.126.5.7</code>, but announce the mix node’s public IP to the directory server as <code>36.68.243.18</code>. It’s up to you as a node operator to ensure that your public and private IPs match up properly.</p>
<h2 id="metrics--api-endpoints"><a class="header" href="#metrics--api-endpoints">Metrics / API endpoints</a></h2>
<p>The mix node binary exposes several API endpoints that can be pinged in order to gather information about the node, and the Validator API exposes numerous mix node related endpoints which provide network-wide information about mix nodes, the network topology (the list of avaliable mix nodes for packet routing), and information regarding uptime monitoring and rewarding history. </p>
<h3 id="mix-node-api-endpoints"><a class="header" href="#mix-node-api-endpoints">Mix node API endpoints</a></h3>
<p>Since the mix node binary exposes several API endpoints itself, you can ping these easily via curl: </p>
<div class="table-wrapper"><table><thead><tr><th>Endpoint</th><th>Description</th><th>Command</th></tr></thead><tbody>
<tr><td><code>/description</code></td><td>Returns the description of the node set with the <code>describe</code> command</td><td><code>curl &lt;NODE_IP_ADDRESS&gt;:8000/description</code></td></tr>
<tr><td><code>/hardware</code></td><td>Returns the hardware information of the node</td><td><code>curl &lt;NODE_IP_ADDRESS&gt;:8000/hardware</code></td></tr>
<tr><td><code>/verloc</code></td><td>Returns the verloc information of the node, updated every 12 hours</td><td><code>curl &lt;NODE_IP_ADDRESS&gt;:8000/verloc</code></td></tr>
</tbody></table>
</div>
<p>The code for exposed API endpoints can be found <a href="https://github.com/nymtech/nym/tree/develop/mixnode/src/node/http">here</a>. </p>
<h3 id="mix-node-related-validator-api-endpoints"><a class="header" href="#mix-node-related-validator-api-endpoints">Mix node related Validator API endpoints</a></h3>
<p>Numerous endpoints are documented on the Validator API’s <a href="https://validator.nymtech.net/api/swagger/index.html">Swagger Documentation</a>. There you can also try out various requests from your broswer, and download the response from the API. Swagger will also show you what commands it is running, so that you can run these from an app or from your CLI if you prefer. </p>
<h2 id="ports"><a class="header" href="#ports">Ports</a></h2>
<p>All mix node-specific port configuration can be found in <code>$HOME/.nym/mixnodes/&lt;your-id&gt;/config/config.toml</code>. If you do edit any port configs, remember to restart your mix node.</p>
<h3 id="mix-node-port-reference"><a class="header" href="#mix-node-port-reference">Mix node port reference</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td><code>1789</code></td><td>Listen for mixnet traffic</td></tr>
<tr><td><code>1790</code></td><td>Listen for VerLoc traffic</td></tr>
<tr><td><code>8000</code></td><td>Metrics http API endpoint</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../nodes/setup-guides.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../nodes/gateway-setup.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../nodes/setup-guides.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../nodes/gateway-setup.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../theme/pagetoc.js"></script>


    </body>
</html>
