<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js coal">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Nym Docs</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="Nym technical documentation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/pagetoc.css">
        <link rel="stylesheet" href="././mdbook-admonish.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "coal" : "coal";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('coal')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item affix "><li class="part-title">Architecture</li><li class="chapter-item "><a href="architecture/network-overview.html"><strong aria-hidden="true">1.</strong> Network Overview</a></li><li class="chapter-item "><a href="architecture/traffic-flow.html"><strong aria-hidden="true">2.</strong> Mixnet Traffic Flow</a></li><li class="chapter-item "><a href="architecture/network-rewards.html"><strong aria-hidden="true">3.</strong> Network Rewards</a></li><li class="chapter-item affix "><li class="part-title">Binaries</li><li class="chapter-item "><a href="binaries/pre-built-binaries.html"><strong aria-hidden="true">4.</strong> Pre-built Binaries</a></li><li class="chapter-item "><a href="binaries/building-nym.html"><strong aria-hidden="true">5.</strong> Building from Source</a></li><li class="chapter-item "><a href="binaries/init-and-config.html"><strong aria-hidden="true">6.</strong> Binary Initialisation and Configuration</a></li><li class="chapter-item "><a href="binaries/version-compatiblity.html"><strong aria-hidden="true">7.</strong> Version Compatibility Table</a></li><li class="chapter-item affix "><li class="part-title">Nodes</li><li class="chapter-item "><a href="nodes/setup-guides.html"><strong aria-hidden="true">8.</strong> Node Setup Guides</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="nodes/mix-node-setup.html"><strong aria-hidden="true">8.1.</strong> Mix Node</a></li><li class="chapter-item "><a href="nodes/gateway-setup.html"><strong aria-hidden="true">8.2.</strong> Gateway</a></li><li class="chapter-item "><a href="nodes/network-requester-setup.html"><strong aria-hidden="true">8.3.</strong> Network Requester</a></li><li class="chapter-item "><a href="nodes/validator-setup.html"><strong aria-hidden="true">8.4.</strong> Validator</a></li></ol></li><li class="chapter-item "><a href="nodes/troubleshooting.html"><strong aria-hidden="true">9.</strong> Troubleshooting</a></li><li class="chapter-item affix "><li class="part-title">Clients</li><li class="chapter-item "><a href="clients/overview.html"><strong aria-hidden="true">10.</strong> Clients Overview</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="clients/websocket-client.html"><strong aria-hidden="true">10.1.</strong> Websocket</a></li><li class="chapter-item "><a href="clients/socks5-client.html"><strong aria-hidden="true">10.2.</strong> Socks5</a></li><li class="chapter-item "><a href="clients/webassembly-client.html"><strong aria-hidden="true">10.3.</strong> Webassembly</a></li></ol></li><li class="chapter-item "><a href="clients/addressing-system.html"><strong aria-hidden="true">11.</strong> Addressing System</a></li><li class="chapter-item affix "><li class="part-title">SDK</li><li class="chapter-item "><a href="sdk/typescript.html"><strong aria-hidden="true">12.</strong> Typescript SDK</a></li><li class="chapter-item "><a href="sdk/rust.html"><strong aria-hidden="true">13.</strong> Rust SDK (coming soon)</a></li><li class="chapter-item affix "><li class="part-title">Wallet</li><li class="chapter-item "><a href="wallet/desktop-wallet.html"><strong aria-hidden="true">14.</strong> Desktop Wallet</a></li><li class="chapter-item "><a href="wallet/cli-wallet.html"><strong aria-hidden="true">15.</strong> CLI Wallet</a></li><li class="chapter-item affix "><li class="part-title">Explorers</li><li class="chapter-item "><a href="explorers/mixnet-explorer.html"><strong aria-hidden="true">16.</strong> Mixnet Explorer</a></li><li class="chapter-item "><div><strong aria-hidden="true">17.</strong> Blockchain Explorers</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div><strong aria-hidden="true">17.1.</strong> Nodes Guru</div></li><li class="chapter-item "><div><strong aria-hidden="true">17.2.</strong> TODO Others</div></li></ol></li><li class="chapter-item "><li class="part-title">Nyx Blockchain</li><li class="chapter-item "><a href="nyx/interacting-with-chain.html"><strong aria-hidden="true">18.</strong> Interacting with Nyx Chain and Smart Contracts</a></li><li class="chapter-item "><a href="nyx/smart-contracts.html"><strong aria-hidden="true">19.</strong> Smart Contracts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="nyx/mixnet-contract.html"><strong aria-hidden="true">19.1.</strong> Mixnet Contract</a></li><li class="chapter-item "><a href="nyx/vesting-contract.html"><strong aria-hidden="true">19.2.</strong> Vesting Contract</a></li></ol></li><li class="chapter-item "><a href="nyx/rpc-node.html"><strong aria-hidden="true">20.</strong> RPC Nodes</a></li><li class="chapter-item affix "><li class="part-title">Tools</li><li class="chapter-item "><a href="tools/nym-cli.html"><strong aria-hidden="true">21.</strong> NymCLI</a></li><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Misc.</li><li class="chapter-item "><a href="coc.html"><strong aria-hidden="true">22.</strong> Code of Conduct</a></li><li class="chapter-item "><a href="licensing.html"><strong aria-hidden="true">23.</strong> Licensing</a></li><li class="spacer"></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Nym Docs</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main><div class="sidetoc"><nav class="pagetoc"></nav></div>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>add a map here for </p>
<ul>
<li>what is here, </li>
<li>developer portal, and </li>
<li>shipyard site, </li>
<li>and why you’d use each </li>
</ul>
<hr />
<p><strong>OLD TEXT</strong></p>
<p>This is Nym’s technical documentation, containing information about the various pieces of Nym software such as different mixnet infrastructure nodes, application clients, and existing Nym applications like the Desktop Wallet and Mixnet Network Explorer. </p>
<p>If you are new to Nym, and want to learn about how to quickly connect to the mixnet check out the <a href="/docs/stable/quickstart/overview">Quick Start</a> section. </p>
<p>If you want to integrate Nym into existing applications or build new apps, check out the <a href="/docs/stable/tutorials/nym-simple-websocket-tutorial">Tutorials</a> and <a href="/docs/stable/integrations/overview">Integrations</a> sections. </p>
<p>If you want to run Nym infrastructure, check out the <a href="/docs/stable/run-nym-nodes/pre-built-binaries">Run Nodes</a> section. </p>
<p>If you are looking for information on grants and beta-release Nym apps, check out the <a href="https://shipyard.nymtech.net">Shipyard</a> site.</p>
<p>If you are unsure of any Nym terminology, check out the <a href="/docs/stable/glossary">Glossary</a> section.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="network-overview"><a class="header" href="#network-overview">Network Overview</a></h1>
<p>Nym is a privacy platform. It provides strong network-level privacy against sophisticated end-to-end attackers, and anonymous access control using blinded, re-randomizable, decentralized credentials. Our goal is to allow developers to build new applications, or upgrade existing apps, with privacy features unavailable in other systems.</p>
<p>The Nym platform knits together several privacy technologies, integrating them into a system of cooperating networked nodes.</p>
<p>At a high level, our technologies include:</p>
<ul>
<li>a <strong>mixnet</strong>, which encrypts and mixes Sphinx packet traffic so that it cannot be determined who is communicating with whom. Our mixnet is based on a modified version of the <strong>Loopix</strong> design.</li>
<li>a privacy enhancing signature scheme called <strong>Coconut</strong>. Coconut allows a shift in thinking about resource access control, from an identity-based paradigm based on <em>who you are</em> to a privacy-preserving paradigm based on <em>right to use</em>.</li>
<li><strong>Sphinx</strong>, a way of transmitting armoured, layer-encrypted information packets which are indistinguishable from each other at a binary level.</li>
<li>the <strong>Nyx</strong> blockchain, a general-purpose CosmWasm-enabled smart contract platform, and the home of the smart contracts which keep track of the mixnet. </li>
</ul>
<p>The most important thing to note is that these technologies ensure privacy at two different levels of the stack: <strong>network data transmission</strong>, and <strong>transactions</strong>.</p>
<p>Here’s an overview diagram of the different types of nodes making up the network: </p>
<p><strong>TODO IMPORT IN MDBOOK STYLE</strong> </p>
<p>&lt;ThemedImage
alt=“Overview diagram of the Nym network”
sources={{
light: useBaseUrl(‘/img/docs/nym-platform.png’),
dark: useBaseUrl(‘/img/docs/nym-platform-dark.png’),
}}
/&gt;</p>
<p>Developers can think of the network as being comprised of <strong>infrastructure nodes</strong> and <strong>clients</strong> for interacting with this infrastructure via privacy-enhanced applications (PEAPPs). </p>
<h2 id="mixnet-infrastructure"><a class="header" href="#mixnet-infrastructure">Mixnet Infrastructure</a></h2>
<p>The mixnet - the different pieces of software that your traffic will pass through when using an privacy-enhanced app (PEAPP) - is made up of several different types of nodes:</p>
<ul>
<li>
<p><strong>Mix Nodes</strong> provide network security for network content <em>and</em> metadata, making it impossible to see who is communicating with who, by performing packet-mixing on traffic travelling through the network. </p>
</li>
<li>
<p><strong>Gateways</strong> act as message storage for clients which may go offline and come back online again, and defend against denial of service attacks. The default gateway implementation included in the Nym platform code holds packets for later retrieval. For many applications (such as simple chat), this is usable out of the box, as it provides a place that potentially offline clients can retrieve packets from. The access token allows clients to pull messages from the gateway node.</p>
</li>
<li>
<p><strong>Services</strong> are applications that communicate with nym clients, listening and sending traffic to the mixnet. This is an umbrella term for a variety of different pieces of code, such as the <code>network-requester</code> binary <strong>TODO ADD LINK</strong> </p>
</li>
<li>
<p><strong>Nyx Blockchain Validators</strong> secure the network with proof-of-stake Sybil defenses, determine which nodes are included within the network, and work together to create Coconut threshold credentials which provide anonymous access to data and resources. They also produce blocks and secure the Nyx Blockchain. Initially, this chain was used only to house the CosmWasm smart contracts keeping track of Nym’s network topology, token vesting contracts, and the <code>NYM</code> token itself. In recent months, we’ve decided to expand the role of Nyx and instead expand its role by making it an open smart contract platform for anyone to upload CosmWasm smart contracts to. Validators also provide privacy-enhanced credentials based on the testimony of a set of decentralized, blockchain-based issuing authorities. Nym validators use the <a href="https://arxiv.org/abs/1802.07344">Coconut</a> <a href="https://en.wikipedia.org/wiki/Digital_signature">signature scheme</a> to issue credentials. This allows privacy apps to generate anonymous resource claims through decentralised authorities, then use them with Service Providers.</p>
</li>
</ul>
<h2 id="privacy-enhanced-applications-peapps"><a class="header" href="#privacy-enhanced-applications-peapps">Privacy-enhanced applications (PEAPPs)</a></h2>
<p><strong>TODO WHERE TO PUT THIS? MAYBE HAVE A LIL EXPLAINER BUT MOVE MOST OF THIS TO THE DEVELOPER PORTAL AND LINK THERE?</strong> </p>
<p><strong>IF YOU DONT MOVE THIS THEN ADD SOME SUBSECTIONS</strong></p>
<p>PEAPs use a Nym client to connect to the network in order to get the available Network Topology for traffic routing, and send/receive packets to other users and services. Clients, in order to send traffic through the mixnet, connect to gateways. Since applications may go online and offline, a client’s gateway provides a sort of mailbox where apps can receive their messages.</p>
<p>Nym clients connect to gateways. Messages are automatically piped to connected clients and deleted from the gateway’s disk storage. If a client is offline when a message arrives, it will be stored for later retrieval. When the client connects, all messages will be delivered, and deleted from the gateway’s disk. </p>
<p>When it starts up, a client registers itself with a gateway, and the gateway returns an access token. The access token plus the gateway’s IP can then be used as a form of addressing for delivering packets.</p>
<p>There are two basic kinds of privacy enhanced applications:</p>
<ol>
<li><strong>Client apps</strong> running on mobile or desktop devices. These will typically expose a user interface (UI) to a human user. These might be existing apps such as crypto wallets that communicate with Nym via our SOCKS5 proxy, or entirely new apps.</li>
<li><strong>Service Providers</strong>, which will usually run on a server, and take actions on behalf of users without knowing who they are.</li>
</ol>
<p>Service Providers (SPs) may interact with external systems on behalf of a user. For example, an SP might submit a Bitcoin, Ethereum or Cosmos transaction, proxy a network request, talk to a chat server, or provide anonymous access to a medical system such as a <a href="https://constructiveproof.com/posts/2020-04-24-coronavirus-tracking-app-privacy/">privacy-friendly coronavirus tracker</a>.</p>
<p>There is also a special category of Service Provider, namely SPs that do not visibly interact with any external systems. You might think of these as crypto-utopiapps: they’re doing something, but it’s not possible from outside to say with any certainty what their function is, or who is interacting with them.</p>
<p>All apps talk with gateways using Sphinx packets and a small set of simple control messages. These messages are sent to gateways over websockets. Each app client has a long-lived relationship with its gateway; Nym defines messages for clients registering and authenticating with gateways, as well as sending encrypted Sphinx packets. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mixnet-traffic-flow"><a class="header" href="#mixnet-traffic-flow">Mixnet Traffic Flow</a></h1>
<h2 id="technical-motivations"><a class="header" href="#technical-motivations">Technical Motivations</a></h2>
<p>When you send data across the internet, it can be recorded by a wide range of observers: your ISP, internet infrastructure providers, large tech companies, and governments.</p>
<p>Even if the content of a network request is encrypted, observers can still see that data was transmitted, its size, frequency of transmission, and gather metadata from unencrypted parts of the data (such as IP routing information). Adversaries may then combine all the leaked information to probabilistically de-anonymize users.</p>
<p>The Nym mixnet provides very strong security guarantees against this sort of surveillance. It <em>packetizes</em> and <em>mixes</em> together IP traffic from many users inside the <em>mixnet</em>. </p>
<p>:::note
If you’re into comparisons, the Nym mixnet is conceptually similar to other systems such as Tor, but provides improved protections against end-to-end timing attacks which can de-anonymize users. When Tor was first fielded, in 2002, those kinds of attacks were regarded as science fiction. But the future is now here.
:::</p>
<h2 id="mixnet-traffic-flow-1"><a class="header" href="#mixnet-traffic-flow-1">Mixnet Traffic Flow</a></h2>
<p>The Nym mixnet re-orders encrypted, indistinguishable <a href="https://cypherpunks.ca/~iang/pubs/Sphinx_Oakland09.pdf">Sphinx</a> packets as they travel through the gateways and mix nodes. </p>
<p>Traffic to send through the mixnet is broken up into uniformly-sized packets, encrypted in the Sphinx packet format according to the route the packet will take, and sent through the mixnet to be mixed among other real traffic and fake - but identical - ‘dummy traffic’. </p>
<p>At each ‘hop’ (i.e. as a packet is forwarded from one node in the sequence to another) a layer of decryption is removed from the Sphinx packet, revealing the address of the next hop, and another Sphinx packet. The packet is then held by the node for a variable amount of time, before being forwarded on to the next node in the route. </p>
<p>:::note
For more information on this, check out the <a href="architecture//docs/next/architecture/loopix">Loopix</a> design document on the next page. 
::: </p>
<p>Traffic always travels through the nodes of the mixnet like such:</p>
<p>&lt;ThemedImage
alt=“Overview diagram of the Nym network”
sources={{
light: useBaseUrl(‘/img/docs/traffic-flow.png’),
dark: useBaseUrl(‘/img/docs/traffic-flow-dark.png’),
}}
/&gt;</p>
<p>From your Nym client, your encrypted traffic is sent to:</p>
<ul>
<li>the gateway your client has registered with,</li>
<li>a mix node on Layer 1 of the Mixnet, </li>
<li>a mix node on Layer 2 of the Mixnet,</li>
<li>a mix node on Layer 3 of the Mixnet, </li>
<li>the recipient’s gateway, which forwards it finally to…</li>
<li>the recipient’s Nym client, which communicates with an application.</li>
</ul>
<p>:::note
If the recipient’s Nym client is offline at the time then the packets will be held by the Gateway their Nym client has registered with until they come online.
::: </p>
<p>Whatever is on the ‘other side’ of the mixnet from your client, all traffic will travel this way through the mixnet. If you are sending traffic to a service external to Nym (such as a chat application’s servers) then your traffic will be sent from the recieving Nym client to an application that will proxy it ‘out’ of the mixnet to these servers, shielding your metadata from them. P2P (peer-to-peer) applications, unlike the majority of apps, might want to keep all of their traffic entirely ‘within’ the mixnet, as they don’t have to necessarily make outbound network requests to application servers. They would simply have their local application code communicate with their Nym clients, and not forward traffic anywhere ‘outside’ of the mixnet. </p>
<h2 id="package-retransmission"><a class="header" href="#package-retransmission">Package Retransmission</a></h2>
<p>Nym clients now all also support packet <em>retransmission</em>. What this means is that if a client sends 100 packets to a gateway, but only receives an acknowledgement (‘ack’) for 95 of them, it will resend those 5 packets to the gateway again, to make sure that all packets are received.</p>
<h2 id="acks"><a class="header" href="#acks">Acks</a></h2>
<p>Whenever a hop is completed, the recieving node will send back an acknowledgement (‘ack’) so that the sending node knows that the packet was recieved. If it does not recieve an ack after sending, it will resend the packet, as it assumes that the packet was dropped for some reason. </p>
<p>This is done ‘under the hood’ by the binaries themselves, and is never something that developers and node operators have to worry about dealing with themselves. </p>
<h2 id="private-replies-using-surbs"><a class="header" href="#private-replies-using-surbs">Private Replies using SURBs</a></h2>
<p>SURBs (‘Single Use Reply Blocks’) allow apps to reply to other apps anonymously.</p>
<p>It will often be the case that a client app wants to interact with a service of some kind, or a P2P application on someone else’s machine. It sort of defeats the purpose of the whole system if your client app needs to reveal its own gateway public key and client public key in order to get a response from the service/app. </p>
<p>Luckily, SURBs allow for anonymous replies. A SURB is a layer encrypted set of Sphinx headers detailing a reply path ending in the original app’s address. SURBs are encrypted by the client, so the recieving service/app can attach its response and send back the resulting Sphinx packet, but it <strong>never has sight of who it is replying to</strong>.</p>
<p>MultiSURBs were implemented in <code>v1.1.4</code>. Clients, when sending a message to another client, attach a bundle of SURBs which can be used by the receiver to construct large anonymous replies, such as files. If a reply is too large still (i.e. it would use more SURBs than sent with the original message), the receiver will use a SURB to ask the sender for more SURBs. </p>
<p>What this means in practice is that files can now be sent via anonymous replies. </p>
<p><strong>TODO EDIT THIS : NOT ENABLED BY DEFAULT ANYWHERE YET - MAKE NOTE OF WHAT FLAG TO USE</strong> </p>
<p>:::note
Please note that the <code>nym-socks5-client</code> currently <strong>does not</strong> have multiSURBs enabled by default to allow for a non-breaking network update, allowing network requesters to update to <code>v1.1.4</code>
::: </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="network-rewards"><a class="header" href="#network-rewards">Network Rewards</a></h1>
<p>Node operator and delegator rewards are determined according to the principles laid out in the section 6 of <a href="https://nymtech.net/nym-whitepaper.pdf">Nym Whitepaper</a>. </p>
<p><strong>TODO MAKE 250 MILL AND 750 MILL INTO VARIABLES AND CHECK THEY’RE STILL UP TO DATE</strong> </p>
<p><strong>TODO REMOVE SANDBOX REFERENCES</strong> </p>
<p>Below is a TLDR of the variables and formulas involved in calculating these rewards per epoch. The initial reward pool contains 250 million NYM, leaving a circulating supply of 750 million NYM.</p>
<div class="table-wrapper"><table><thead><tr><th>Symbol</th><th>Definition</th></tr></thead><tbody>
<tr><td><img src="https://render.githubusercontent.com/render/math?math=R"></img></td><td>global share of rewards available, starts at 2% of the reward pool.</td></tr>
<tr><td><img src="https://render.githubusercontent.com/render/math?math=R_{i}"></img></td><td>node reward for mixnode <code>i</code>.</td></tr>
<tr><td><img src="https://render.githubusercontent.com/render/math?math=\sigma_{i}"></img></td><td>ratio of total node stake (node bond + all delegations) to the token circulating supply.</td></tr>
<tr><td><img src="https://render.githubusercontent.com/render/math?math=\lambda_{i}"></img></td><td>ratio of stake operator has pledged to their node to the token circulating supply.</td></tr>
<tr><td><img src="https://render.githubusercontent.com/render/math?math=\omega_{i}"></img></td><td>fraction of total effort undertaken by node <code>i</code>, set to <code>1/k</code> in testnet Sandbox.</td></tr>
<tr><td><img src="https://render.githubusercontent.com/render/math?math=k"></img></td><td>number of nodes stakeholders are incentivised to create, set by the validators, a matter of governance. Currently determined by the reward set size, and set to 720 in testnet Sandbox.</td></tr>
<tr><td><img src="https://render.githubusercontent.com/render/math?math=\alpha"></img></td><td>Sybil attack resistance parameter - the higher this parameter is set the stronger the reduction in competitivness gets for a Sybil attacker.</td></tr>
<tr><td><img src="https://render.githubusercontent.com/render/math?math=PM_{i}"></img></td><td>declared profit margin of operator <code>i</code>, defaults to 10% in testnet Sandbox.</td></tr>
<tr><td><img src="https://render.githubusercontent.com/render/math?math=PF_{i}"></img></td><td>uptime of node <code>i</code>, scaled to 0 - 1, for the rewarding epoch</td></tr>
<tr><td><img src="https://render.githubusercontent.com/render/math?math=PP_{i}"></img></td><td>cost of operating node <code>i</code> for the duration of the rewarding eopoch, set to 40 Nym for testnet Sandbox.</td></tr>
</tbody></table>
</div>
<p>Node reward for node <code>i</code> is determined as:</p>
<p><img src="https://render.githubusercontent.com/render/math?math=R_{i}=PF_{i} \cdot R \cdot (\sigma^'_{i} \cdot \omega_{i} \cdot k %2b \alpha \cdot \lambda^'_{i} \cdot \sigma^'_{i} \cdot k)/(1 %2b \alpha)"></img></p>
<p>where:</p>
<p><img src="https://render.githubusercontent.com/render/math?math=\sigma^'_{i} = min\{\sigma_{i}, 1/k\}"></img></p>
<p>and</p>
<p><img src="https://render.githubusercontent.com/render/math?math=\lambda^'_{i} = min\{\lambda_{i}, 1/k\}"></img></p>
<p>Operator of node <code>i</code> is credited with the following amount:</p>
<p><img src="https://render.githubusercontent.com/render/math?math=min\{PP_{i},R_{i}\} %2b max\{0, (PM_{i} %2b (1 - PM_{i}) \cdot \lambda_{i}/\delta_{i}) \cdot (R_{i} - PP_{i})\}"></img></p>
<p>Delegate with stake <code>s</code> recieves:</p>
<p><img src="https://render.githubusercontent.com/render/math?math=max\{0, (1-PM_{i}) \cdot (s^'/\sigma_{i}) \cdot (R_{i} - PP_{i})\}"></img></p>
<p>where <code>s'</code> is stake <code>s</code> scaled over total token circulating supply.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pre-built-binaries"><a class="header" href="#pre-built-binaries">Pre-built Binaries</a></h1>
<p>The <a href="https://github.com/nymtech/nym/releases">Github releases page</a> has pre-built binaries which should work on Ubuntu 20.04 and other Debian-based systems, but at this stage cannot be guaranteed to work everywhere.</p>
<p>If the pre-built binaries don’t work or are unavailable for your system, you will need to build the platform yourself.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="building-from-source"><a class="header" href="#building-from-source">Building from Source</a></h1>
<p>Nym runs on Mac OS X, Linux, and Windows. All nodes <strong>except the Desktop Wallet and NymConnect</strong> on Windows should be considered experimental - it works fine if you’re an app developer but isn’t recommended for running nodes. </p>
<h2 id="building-nym"><a class="header" href="#building-nym">Building Nym</a></h2>
<p>Nym has two main codebases:</p>
<ul>
<li>the Nym platform <strong>TODO ADD LINK</strong>, written in Rust. This contains all of our code <em>except</em> for the validators.</li>
<li>the Nym validators <strong>TODO ADD LINK</strong>, written in Go.</li>
</ul>
<blockquote>
<p>This page details how to build the main Nym platform code. <strong>If you want to build and run a validator, <a href="binaries/../nodes/validator-setup.html">go here</a> instead.</strong></p>
</blockquote>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<p><strong>TODO ADD FOR MAC AND ARCH BASED SYSTEMS?</strong> </p>
<ul>
<li>(Debian/Ubuntu) <code>pkg-config</code>, <code>build-essential</code>, <code>libssl-dev</code>, <code>curl</code>, <code>jq</code>, <code>git</code></li>
</ul>
<pre><code>sudo apt update
sudo apt install pkg-config build-essential libssl-dev curl jq git
</code></pre>
<ul>
<li><code>Rust &amp; cargo &gt;= v1.66</code></li>
</ul>
<p>We recommend using the <a href="https://www.rust-lang.org/tools/install">Rust shell script installer</a>. Installing cargo from your package manager (e.g. <code>apt</code>) is not recommended as the packaged versions are usually too old.</p>
<p>If you really don’t want to use the shell script installer, the <a href="https://forge.rust-lang.org/infra/other-installation-methods.html">Rust installation docs</a> contain instructions for many platforms.</p>
<h2 id="download-and-build-nym-binaries"><a class="header" href="#download-and-build-nym-binaries">Download and build Nym binaries</a></h2>
<p><strong>TODO ADD VARIABLES FOR VERSIONS, MOST RECENT BRANCH, ETC</strong>
The following commands will compile binaries into the <code>nym/target/release</code> directory:</p>
<pre><code>rustup update
git clone https://github.com/nymtech/nym.git
cd nym

git reset --hard # in case you made any changes on your branch
git pull # in case you've checked it out before

git checkout release/v1.1.5 # checkout to the latest release branch: `develop` will most likely be incompatible with deployed public networks  

cargo build --release # build your binaries with **mainnet** configuration
NETWORK=sandbox cargo build --release # build your binaries with **sandbox** configuration 
</code></pre>
<p>Quite a bit of stuff gets built. The key working parts are:</p>
<ul>
<li><a href="binaries/../nodes/mix-node-setup.html">mix node</a>: <code>nym-mixnode</code></li>
<li><a href="binaries/../nodes/gateway-setup.html">gateway node</a>: <code>nym-gateway</code></li>
<li><a href="binaries/../clients/websocket-client.html">websocket client</a>: <code>nym-client</code></li>
<li><a href="binaries/../clients/socks5-client.html">socks5 client</a>: <code>nym-socks5-client</code></li>
<li><a href="binaries/../nodes/network-requester-setup.html">network requester</a>: <code>nym-network-requester</code></li>
<li><a href="binaries/../tools/nym-cli.html">nym-cli tool</a>: <code>nym-cli</code> </li>
</ul>
<p>The repository also contains Typescript applications which aren’t built in this process. These can be built by following the instructions on their respective docs pages.</p>
<ul>
<li><a href="binaries/../wallet/desktop-wallet.html">Nym Wallet</a> </li>
<li><a href="binaries/">Nym Connect</a></li>
<li><a href="binaries/../explorers/mixnet-explorer.html">Network Explorer UI</a>. </li>
</ul>
<blockquote>
<p>You cannot build from GitHub’s .zip or .tar.gz archive files on the releases page - the Nym build scripts automatically include the current git commit hash in the built binary during compilation, so the build will fail if you use the archive code (which isn’t a Git repository). Check the code out from github using <code>git clone</code> instead. </p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="binary-initialisation-and-configuration"><a class="header" href="#binary-initialisation-and-configuration">Binary Initialisation and Configuration</a></h1>
<p><strong>TODO ADD NOTES ON CYCLE: ALL BINARIES ARE INIT-ED BEFORE THEY’RE RUN. INIT GIVES YOU CONFIG AND KEYPAIR CREATION (IF DOESNT ALREADY EXIST) IN ~/.NYM/ETCETCETC .tHEN YOU RUN THE BINARIES</strong></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="version-compatibility-table"><a class="header" href="#version-compatibility-table">Version Compatibility Table</a></h1>
<p>There are numerous components to Nym which are released independently of one another aside from when breaking changes occur in the <a href="https://github.com/nymtech/nym/">core platform code</a> - mix nodes, gateways, and clients.</p>
<p>Whilst in general it recommended to be running the most recent version of any software, if you cannot do that for whatever reason this table will tell you which versions of different components are mutually compatible with which platform code releases.</p>
<p><strong>TODO SIMPLIFY STRUCTURE OF THIS TABLE</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Mix node</th><th>Gateway</th><th>Clients</th><th>Network Requester</th><th>SDK</th><th>Wallet</th><th>NymConnect</th><th>Network Explorer</th><th>Mixnet contract</th><th>Vesting contract</th></tr></thead><tbody>
<tr><td>1.1.0 - 1.1.5</td><td>1.1.0 - 1.1.5</td><td>1.1.0 - 1.1.5</td><td>1.1.0 - 1.1.5</td><td>1.1.5</td><td>1.1.0 - 1.1.5</td><td>1.1.0 - 1.1.5</td><td>1.1.0 - 1.1.2</td><td>1.1.0</td><td>1.1.0</td></tr>
<tr><td>1.1.0 - 1.1.4</td><td>1.1.0 - 1.1.4</td><td>1.1.0 - 1.1.4</td><td>1.1.0 - 1.1.4</td><td>1.1.5</td><td>1.1.0 - 1.1.4</td><td>1.1.0 - 1.1.4</td><td>1.1.0 - 1.1.2</td><td>1.1.0</td><td>1.1.0</td></tr>
<tr><td>1.1.0 - 1.1.3</td><td>1.1.0 - 1.1.3</td><td>1.1.0 - 1.1.3</td><td>1.1.0 - 1.1.3</td><td>1.1.4</td><td>1.1.0 - 1.1.3</td><td>1.1.0 - 1.1.3</td><td>1.1.0 - 1.1.2</td><td>1.1.0</td><td>1.1.0</td></tr>
<tr><td>1.1.0 - 1.1.2</td><td>1.1.0 - 1.1.2</td><td>1.1.0 - 1.1.2</td><td>1.1.0 - 1.1.2</td><td>1.1.4</td><td>1.1.0 - 1.1.3</td><td>1.1.0 - 1.1.3</td><td>1.1.0 - 1.1.2</td><td>1.1.0</td><td>1.1.0</td></tr>
<tr><td>1.1.0 - 1.1.1</td><td>1.1.0 - 1.1.1</td><td>1.1.0 - 1.1.1</td><td>1.1.0 - 1.1.1</td><td>1.1.4</td><td>1.1.0 - 1.1.3</td><td>1.1.0 - 1.1.3</td><td>1.1.0 - 1.1.2</td><td>1.1.0</td><td>1.1.0</td></tr>
<tr><td>1.1.0 - 1.1.1</td><td>1.1.0 - 1.1.1</td><td>1.1.0 - 1.1.1</td><td>1.1.0 - 1.1.1</td><td>1.1.4</td><td>1.1.0 - 1.1.2</td><td>1.1.0 - 1.1.2</td><td>1.1.0 - 1.1.2</td><td>1.1.0</td><td>1.1.0</td></tr>
<tr><td>1.1.0 - 1.1.1</td><td>1.1.0 - 1.1.1</td><td>1.1.0 - 1.1.1</td><td>1.1.0 - 1.1.1</td><td>1.1.4</td><td>1.1.0</td><td>1.1.0 - 1.1.1</td><td>1.1.0</td><td>1.1.0</td><td>1.1.0</td></tr>
<tr><td>1.1.0</td><td>1.1.0</td><td>1.1.0</td><td>1.1.0 - 1.1.1</td><td>x</td><td>1.1.0</td><td>1.1.0</td><td>1.1.0</td><td>1.1.0</td><td>1.1.0</td></tr>
<tr><td>1.1.0</td><td>1.1.0</td><td>1.1.0</td><td>1.1.0</td><td>x</td><td>1.1.0</td><td>1.1.0</td><td>1.1.0</td><td>1.1.0</td><td>1.1.0</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Platform release changelog</th></tr></thead><tbody>
<tr><td>1.1.5 (<a href="https://github.com/nymtech/nym/blob/release/v1.1.5/CHANGELOG.md">CHANGELOG</a>)</td></tr>
<tr><td>1.1.4 (<a href="https://github.com/nymtech/nym/blob/release/v1.1.4/CHANGELOG.md">CHANGELOG</a>)</td></tr>
<tr><td>1.1.3 (<a href="https://github.com/nymtech/nym/blob/release/v1.1.3/CHANGELOG.md">CHANGELOG</a>)</td></tr>
<tr><td>1.1.2 (<a href="https://github.com/nymtech/nym/blob/develop/CHANGELOG.md">CHANGELOG</a>)</td></tr>
<tr><td>1.1.1 (<a href="https://github.com/nymtech/nym/blob/release/nym-connect-v1.1.1/CHANGELOG.md">CHANGELOG</a>)</td></tr>
<tr><td>1.1.0 (<a href="https://github.com/nymtech/nym/blob/release/v1.1.0/CHANGELOG.md">CHANGELOG</a>)</td></tr>
<tr><td>1.0.2 (<a href="https://github.com/nymtech/nym/blob/nym-binaries-1.0.2/CHANGELOG.md">CHANGELOG</a>)</td></tr>
<tr><td>1.0.1 (<a href="https://github.com/nymtech/nym/blob/nym-binaries-1.0.1/CHANGELOG.md">CHANGELOG</a>)</td></tr>
<tr><td>1.0.0 (<a href="https://github.com/nymtech/nym/blob/nym-binaries-1.0.0/CHANGELOG.md">CHANGELOG</a>)</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="node-setup-guides"><a class="header" href="#node-setup-guides">Node Setup Guides</a></h1>
<p>This section contains setup guides for the following node types:</p>
<ul>
<li><a href="nodes/./mix-node-setup.html">Mix node</a></li>
<li><a href="nodes/./gateway-setup.html">Gateway</a></li>
<li><a href="nodes/./network-requester-setup.html">Network Requester</a></li>
<li><a href="nodes/./validator-setup.html">Validator</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mix-nodes"><a class="header" href="#mix-nodes">Mix Nodes</a></h1>
<blockquote>
<p>The Nym mix node binary was built in the <a href="nodes/../binaries/building-nym.html">building nym</a> section. If you haven’t yet built Nym and want to run the code, go there first.</p>
</blockquote>
<h2 id="preliminary-steps"><a class="header" href="#preliminary-steps">Preliminary steps</a></h2>
<p>There are a couple of steps that need completing before starting to set up your mix node:</p>
<ul>
<li>preparing your wallet</li>
<li>requisitioning a VPS (Virtual Private Server)</li>
</ul>
<h3 id="wallet-preparation"><a class="header" href="#wallet-preparation">Wallet preparation</a></h3>
<h4 id="mainnet"><a class="header" href="#mainnet">Mainnet</a></h4>
<p>Before you initialise and run your mixnode, head to our <a href="https://nymtech.net/download/">website</a> and download the Nym wallet for your operating system. If pre-compiled binaries for your operating system aren’t availiable, you can build the wallet yourself with instructions <a href="nodes/../wallet/desktop-wallet.html">here</a>.</p>
<p>If you don’t already have one, please create a Nym address using the wallet, and fund it with tokens. The minimum amount required to bond a mixnode is 100 <code>NYM</code>, but make sure you have a bit more to account for gas costs.</p>
<p><code>NYM</code> is currently present on several exchanges. Head to our <a href="https://t.me/nymchan">telegram channels</a> to find out where to get <code>NYM</code> tokens.</p>
<blockquote>
<p>Remember that you can <strong>only</strong> use Cosmos <code>NYM</code> tokens to bond your mixnode. You <strong>cannot</strong> use ERC20 representations of <code>NYM</code> to run a node.</p>
</blockquote>
<h4 id="sandbox-testnet"><a class="header" href="#sandbox-testnet">Sandbox testnet</a></h4>
<p>Make sure to download a wallet and create an account as outlined above. Then head to our <a href="https://faucet.nymtech.net/">token faucet</a> and get some tokens to use to bond it.</p>
<h3 id="vps-hardware-specs"><a class="header" href="#vps-hardware-specs">VPS Hardware Specs</a></h3>
<p>You will need to rent a VPS to run your mix node on. One key reason for this is that your node <strong>must be able to send TCP data using both IPv4 and IPv6</strong> (as other nodes you talk to may use either protocol).</p>
<p>For the moment, we haven’t put a great amount of effort into optimizing concurrency to increase throughput, so don’t bother provisioning a beastly server with multiple cores. This will change when we get a chance to start doing performance optimizations in a more serious way. Sphinx packet decryption is CPU-bound, so once we optimise, more fast cores will be better.</p>
<p>For now, see the below rough specs:</p>
<ul>
<li>Processors: 2 cores are fine. Get the fastest CPUs you can afford.</li>
<li>RAM: Memory requirements are very low - typically a mix node may use only a few hundred MB of RAM.</li>
<li>Disks: The mixnodes require no disk space beyond a few bytes for the configuration files. </li>
</ul>
<h2 id="mix-node-setup"><a class="header" href="#mix-node-setup">Mix node setup</a></h2>
<p>Now that you have built the codebase, set up your wallet, and have a VPS with the <code>nym-mixnode</code> binary, you can set up your mix node with the instructions below.</p>
<h3 id="viewing-command-help"><a class="header" href="#viewing-command-help">Viewing command help</a></h3>
<p>You can check that your binaries are properly compiled with:</p>
<pre><code>./nym-mixnode --help
</code></pre>
<p>Which should return a list of all avaliable commands.</p>
<details id="admonition-console-output" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/mix-node-setup.html#admonition-console-output"></a></p>
</summary>
<div>
<pre><code>  _ __  _   _ _ __ ___
 | '_ \| | | | '_ \ _ \
 | | | | |_| | | | | | |
 |_| |_|\__, |_| |_| |_|
        |___/

         (mixnode - version 1.1.4)

        
nym-mixnode 1.1.4
Nymtech
Implementation of a Loopix-based Mixnode

USAGE:
    nym-mixnode [OPTIONS] &lt;SUBCOMMAND&gt;

OPTIONS:
        --config-env-file &lt;CONFIG_ENV_FILE&gt;
            Path pointing to an env file that configures the mixnode

    -h, --help
            Print help information

    -V, --version
            Print version information

SUBCOMMANDS:
    completions          Generate shell completions
    describe             Describe your mixnode and tell people why they should delegate state to you
    generate-fig-spec    Generate Fig specification
    help                 Print this message or the help of the given subcommand(s)
    init                 Initialise the mixnode
    node-details         Show details of this mixnode
    run                  Starts the mixnode
    sign                 Sign text to prove ownership of this mixnode
    upgrade              Try to upgrade the mixnode

    nym-mixnode 1.1.4
    Nymtech
</code></pre>
</div>
</details>
<p>You can also check the various arguments required for individual commands with:</p>
<pre><code>./nym-mixnode &lt;command&gt; --help
</code></pre>
<h3 id="initialising-your-mix-node"><a class="header" href="#initialising-your-mix-node">Initialising your mix node</a></h3>
<p>To check available configuration options for initializing your node use:</p>
<pre><code>./nym-mixnode init --help
</code></pre>
<details id="admonition-console-output-1" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/mix-node-setup.html#admonition-console-output-1"></a></p>
</summary>
<div>
<pre><code>  _ __  _   _ _ __ ___
 | '_ \| | | | '_ \ _ \
 | | | | |_| | | | | | |
 |_| |_|\__, |_| |_| |_|
        |___/

         (mixnode - version 1.1.4)

        
nym-mixnode-init 
Initialise the mixnode

USAGE:
    nym-mixnode init [OPTIONS] --id &lt;ID&gt; --host &lt;HOST&gt; --wallet-address &lt;WALLET_ADDRESS&gt;

OPTIONS:
        --announce-host &lt;ANNOUNCE_HOST&gt;
            The custom host that will be reported to the directory server

    -h, --help
            Print help information

        --host &lt;HOST&gt;
            The host on which the mixnode will be running

        --http-api-port &lt;HTTP_API_PORT&gt;
            The port on which the mixnode will be listening for http requests

        --id &lt;ID&gt;
            Id of the mixnode we want to create config for

        --mix-port &lt;MIX_PORT&gt;
            The port on which the mixnode will be listening for mix packets

        --validators &lt;VALIDATORS&gt;
            Comma separated list of rest endpoints of the validators

        --verloc-port &lt;VERLOC_PORT&gt;
            The port on which the mixnode will be listening for verloc packets

        --wallet-address &lt;WALLET_ADDRESS&gt;
            The wallet address you will use to bond this mixnode, e.g.
            nymt1z9egw0knv47nmur0p8vk4rcx59h9gg4zuxrrr9
</code></pre>
</div>
</details>
<p>Initalise your mixnode with the following command, replacing the value of <code>--id</code> with the moniker you wish to give your mixnode, and the <code>--wallet-address</code> with the Nym address you created earlier. Your <code>--host</code> must be publicly routable on the internet in order to mix packets, and can be either an Ipv4 or IPv6 address. The <code>$(curl ifconfig.me)</code> command returns your IP automatically using an external service. If you enter your IP address manually, enter it <strong>without</strong> any port information.</p>
<pre><code>./nym-mixnode init --id winston-smithnode --host $(curl ifconfig.me) --wallet-address &lt;wallet-address&gt;
</code></pre>
<blockquote>
<p>The <code>init</code> command will refuse to destroy existing mix node keys.</p>
</blockquote>
<p>During the <code>init</code> process you will have the option to change the <code>http_api</code>, <code>verloc</code> and <code>mixnode</code> ports from their default settings. If you wish to change these in the future you can edit their values in the <code>config.toml</code> file created by the initialization process, which is located at <code>~/.nym/mixnodes/&lt;your-id&gt;/</code>.</p>
<h3 id="bonding-your-mix-node"><a class="header" href="#bonding-your-mix-node">Bonding your mix node</a></h3>
<div id="admonition-caution" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="nodes/mix-node-setup.html#admonition-caution"></a></p>
</div>
<div>
<p>From <code>v1.1.3</code>, if you unbond your mixnode that means you are leaving the mixnet and you will lose all your delegations (permanently). You can join again with the same identity key, however, you will start with <strong>no delegations</strong>.</p>
</div>
</div>
<h4 id="bond-via-the-desktop-wallet-recommended"><a class="header" href="#bond-via-the-desktop-wallet-recommended">Bond via the Desktop wallet (recommended)</a></h4>
<p>You can bond your mix node via the Desktop wallet.</p>
<p>Open your wallet, and head to the <code>Bond</code> page, then select the node type and input your node details.</p>
<h4 id="bond-via-the-cli-power-users"><a class="header" href="#bond-via-the-cli-power-users">Bond via the CLI (power users)</a></h4>
<p>If you want to bond your Gateway via the CLI, then check out the <a href="nodes/../tools/nym-cli.html">Nym CLI</a> tool. </p>
<h3 id="running-your-mix-node"><a class="header" href="#running-your-mix-node">Running your mix node</a></h3>
<p>Now you’ve bonded your mix node, run it with:</p>
<pre><code>./nym-mixnode run --id winston-smithnode
</code></pre>
<details id="admonition-console-output-2" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/mix-node-setup.html#admonition-console-output-2"></a></p>
</summary>
<div>
<pre><code>
Starting mixnode winston-smithnode...

To bond your mixnode you will need to install the Nym wallet, go to https://nymtech.net/get-involved and select the Download button.
Select the correct version and install it to your machine. You will need to provide the following:

Identity Key: GWrymUuLaxVHSs8iE7YW48MB81npnKjrVuJzJsGkeji6
Sphinx Key: FU89ULkS4YYDXcm5jShhJvoit7H4jG4EXHxRKbS9cXSJ
Owner Signature: Kd5StZtg5PsjLtWRJ5eQejuLHz3JUNzZrk6Jd4WVS5u9Q5bFt6DvuVzN7NbiX9WMZYpsYMJoegH3Bz94o6gsY6b
Host: 62.240.134.46 (bind address: 62.240.134.46)
Version: 1.1.4
Mix Port: 1789, Verloc port: 1790, Http Port: 8000

You are bonding to wallet address: n1x42mm3gsdg808qu2n3ah4l4r9y7vfdvwkw8az6


2022-04-27T16:08:01.159Z INFO  nym_mixnode::node &gt; Starting nym mixnode
2022-04-27T16:08:01.490Z INFO  nym_mixnode::node &gt; Starting node stats controller...
2022-04-27T16:08:01.490Z INFO  nym_mixnode::node &gt; Starting packet delay-forwarder...
2022-04-27T16:08:01.490Z INFO  nym_mixnode::node &gt; Starting socket listener...
2022-04-27T16:08:01.490Z INFO  nym_mixnode::node::listener &gt; Running mix listener on &quot;62.240.134.46:1789&quot;
2022-04-27T16:08:01.490Z INFO  nym_mixnode::node           &gt; Starting the round-trip-time measurer...

</code></pre>
</div>
</details>
<p>If everything worked, you’ll see your node running on the either the <a href="https://sandbox-explorer.nymtech.net">Sandbox testnet network explorer</a> or the <a href="https://explorer.nymtech.net">mainnet network explorer</a>, depending on which network you’re running.</p>
<p>Note that your node’s public identity key is displayed during startup, you can use it to identify your node in the list.</p>
<p>Keep reading to find out more about configuration options or troubleshooting if you’re having issues. There are also some tips for running on AWS and other cloud providers, some of which require minor additional setup.</p>
<p>Also have a look at the saved configuration files in <code>$HOME/.nym/mixnodes/</code> to see more configuration options.</p>
<h3 id="describe-your-mix-node-optional"><a class="header" href="#describe-your-mix-node-optional">Describe your mix node (optional)</a></h3>
<p>In order to easily identify your node via human-readable information later on in the development of the testnet when delegated staking is implemented, you can <code>describe</code> your mixnode with the following command:</p>
<pre><code>./nym-mixnode describe --id winston-smithnode
</code></pre>
<details id="admonition-console-output-3" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/mix-node-setup.html#admonition-console-output-3"></a></p>
</summary>
<div>
<pre><code>name: winston-smithnode
description: nym-mixnode hosted on Linode VPS in &lt;location&gt; with the following specs: &lt;specs&gt;.
link, e.g. https://mixnode.yourdomain.com: mixnode.mydomain.net
location, e.g. City: London, Country: UK: &lt;your_location&gt;

This information will be shown in the mixnode's page in the Network Explorer, and help people make delegated staking decisions.
</code></pre>
</div>
</details>
<blockquote>
<p>Remember to restart your mix node process in order for the new description to be propogated</p>
</blockquote>
<h3 id="upgrading-your-mix-node"><a class="header" href="#upgrading-your-mix-node">Upgrading your mix node</a></h3>
<ul>
<li>pause your mix node process </li>
<li>replace the existing binary with the newest binary (which you can either compile yourself or grab from our <a href="https://github.com/nymtech/nym/releases">releases page</a>)</li>
<li>re-run <code>init</code> with the same values as you used initially. <strong>This will just update the config file, it will not overwrite existing keys</strong>. </li>
<li>restart your mix node process with the new binary. </li>
</ul>
<blockquote>
<p>Do <strong>not</strong> use the <code>upgrade</code> command: there is a known error with the command that will be fixed in the next release. </p>
</blockquote>
<h3 id="displaying-mix-node-information"><a class="header" href="#displaying-mix-node-information">Displaying mix node information</a></h3>
<p>You can always check the details of your mix node with the <code>node-details</code> command:</p>
<pre><code>./nym-mixnode node-details --id winston-smithnode
</code></pre>
<details id="admonition-console-output-4" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/mix-node-setup.html#admonition-console-output-4"></a></p>
</summary>
<div>
<pre><code>
Identity Key: GWrymUuLaxVHSs8iE7YW48MB81npnKjrVuJzJsGkeji6
Sphinx Key: FU89ULkS4YYDXcm5jShhJvoit7H4jG4EXHxRKbS9cXSJ
Owner Signature: Kd5StZtg5PsjLtWRJ5eQejuLHz3JUNzZrk6Jd4WVS5u9Q5bFt6DvuVzN7NbiX9WMZYpsYMJoegH3Bz94o6gsY6b
Host: 62.240.134.46 (bind address: 62.240.134.46)
Version: 1.1.4
Mix Port: 1789, Verloc port: 1790, Http Port: 8000

You are bonding to wallet address: n1x42mm3gsdg808qu2n3ah4l4r9y7vfdvwkw8az6

</code></pre>
</div>
</details>
<h2 id="vps-setup-and-automation"><a class="header" href="#vps-setup-and-automation">VPS Setup and Automation</a></h2>
<h3 id="configure-your-firewall"><a class="header" href="#configure-your-firewall">Configure your firewall</a></h3>
<p>The following commands will allow you to set up a firewall using <code>ufw</code>.</p>
<pre><code># check if you have ufw installed
ufw version
# if it is not installed, install with
sudo apt install ufw -y
# enable ufw
sudo ufw enable
# check the status of the firewall
sudo ufw status
</code></pre>
<p>Finally open your mix node’s p2p port, as well as ports for ssh, http, and https connections, and ports <code>8000</code> and <code>1790</code> for verloc and measurement pings:</p>
<pre><code>sudo ufw allow 1789,1790,8000,22,80,443/tcp
# check the status of the firewall
sudo ufw status
</code></pre>
<p>For more information about your mix node’s port configuration, check the <a href="nodes/./mix-node-setup.html#mixnode-port-reference">mix node port reference table</a> below.</p>
<h3 id="automating-your-mix-node-with-systemd"><a class="header" href="#automating-your-mix-node-with-systemd">Automating your mix node with systemd</a></h3>
<p>It’s useful to have the mix node automatically start at system boot time. Here’s a systemd service file to do that:</p>
<pre><code class="language-ini">[Unit]
Description=Nym Mixnode (1.1.4)
StartLimitInterval=350
StartLimitBurst=10

[Service]
User=nym
LimitNOFILE=65536
ExecStart=/home/nym/nym-mixnode run --id mix0100
KillSignal=SIGINT
Restart=on-failure
RestartSec=30

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Put the above file onto your system at <code>/etc/systemd/system/nym-mixnode.service</code>.</p>
<p>Change the path in <code>ExecStart</code> to point at your mix node binary (<code>nym-mixnode</code>), and the <code>User</code> so it is the user you are running as.</p>
<p>If you have built nym on your server, and your username is <code>jetpanther</code>, then the start command might look like this:</p>
<p><code>ExecStart=/home/jetpanther/nym/target/release/nym-mixnode run --id your-id</code>. Basically, you want the full <code>/path/to/nym-mixnode run --id whatever-your-node-id-is</code></p>
<p>Then run:</p>
<pre><code>systemctl enable nym-mixnode.service
</code></pre>
<p>Start your node:</p>
<pre><code>service nym-mixnode start
</code></pre>
<p>This will cause your node to start at system boot time. If you restart your machine, the node will come back up automatically.</p>
<p>You can also do <code>service nym-mixnode stop</code> or <code>service nym-mixnode restart</code>.</p>
<p>Note: if you make any changes to your systemd script after you’ve enabled it, you will need to run:</p>
<pre><code>systemctl daemon-reload
</code></pre>
<p>This lets your operating system know it’s ok to reload the service configuration.</p>
<h4 id="setting-the-ulimit"><a class="header" href="#setting-the-ulimit">Setting the ulimit</a></h4>
<p>Linux machines limit how many open files a user is allowed to have. This is called a <code>ulimit</code>.</p>
<p><code>ulimit</code> is 1024 by default on most systems. It needs to be set higher, because mix nodes make and receive a lot of connections to other nodes.</p>
<p>If you see errors such as:</p>
<pre><code>Failed to accept incoming connection - Os { code: 24, kind: Other, message: &quot;Too many open files&quot; }
</code></pre>
<p>This means that the operating system is preventing network connections from being made.</p>
<h5 id="set-the-ulimit-via-systemd-service-file"><a class="header" href="#set-the-ulimit-via-systemd-service-file">Set the ulimit via <code>systemd</code> service file</a></h5>
<p>Query the <code>ulimit</code> of your mix node with:</p>
<pre><code>grep -i &quot;open files&quot; /proc/$(ps -A -o pid,cmd|grep nym-mixnode | grep -v grep |head -n 1 | awk '{print $1}')/limits
</code></pre>
<p>You’ll get back the hard and soft limits, which looks something like this:</p>
<pre><code>Max open files            65536                65536                files
</code></pre>
<p>If your output is <strong>the same as above</strong>, your node will not encounter any <code>ulimit</code> related issues.</p>
<p>However if either value is <code>1024</code>, you must raise the limit via the systemd service file. Add the line:</p>
<pre><code>LimitNOFILE=65536
</code></pre>
<p>Reload the daemon:</p>
<pre><code>systemctl daemon-reload
</code></pre>
<p>or execute this as root for system-wide setting of <code>ulimit</code>:</p>
<pre><code>echo &quot;DefaultLimitNOFILE=65535&quot; &gt;&gt; /etc/systemd/system.conf
</code></pre>
<p>Reboot your machine and restart your node. When it comes back, use <code>cat /proc/$(pidof nym-mixnode)/limits | grep &quot;Max open files&quot;</code> to make sure the limit has changed to 65535.</p>
<h5 id="set-the-ulimit-on-non-systemd-based-distributions"><a class="header" href="#set-the-ulimit-on-non-systemd-based-distributions">Set the ulimit on <code>non-systemd</code> based distributions</a></h5>
<p>Edit <code>etc/security/conf</code> and add the following lines:</p>
<pre><code># Example hard limit for max opened files
username        hard nofile 4096
# Example soft limit for max opened files
username        soft nofile 4096
</code></pre>
<p>Then reboot your server and restart your mixnode.</p>
<h2 id="node-families"><a class="header" href="#node-families">Node Families</a></h2>
<h3 id="joining-a-node-family"><a class="header" href="#joining-a-node-family">Joining a Node Family</a></h3>
<p>Ssh into the vps of the family head and run the following command to obtain the signature for the member. The value is the <strong>identity key</strong> of the mix node which wants to join the family: </p>
<pre><code>./nym-mixnode sign --id mixnode --text 4Yr4qmEHd9sgsuQ83191FR2hD88RfsbMmB4tzhhZWriz
</code></pre>
<p>This will return a signature which is going to be used below - in this example it is <code>3SEjfNcJ5L3cXdvWCdiQNT5DkCFJ2TurK5xsYyEdHH324nAA3bWvKoXmkjU9Xbr9ZyemGDLJ4dmGEHWUwL1LCWKq</code>. </p>
<p>The <code>--from</code> is going to be the mnemonic of the member wanting to join the family: </p>
<pre><code>./nyxd tx wasm execute ${MIXNET-CONTRACT} '{&quot;join_family&quot;: {&quot;signature&quot;: &quot;3SEjfNcJ5L3cXdvWCdiQNT5DkCFJ2TurK5xsYyEdHH324nAA3bWvKoXmkjU9Xbr9ZyemGDLJ4dmGEHWUwL1LCWKq&quot;,&quot;family_head&quot;: &quot;8A3Pv7Y9xGZdhUYd7sMHKp5y3nn5P3aBDDnJLataYE2J&quot;}}' --node ${VALIDATOR-ENDPOINT} --from mix1 --chain-id nyx --gas-prices 0.025unym --gas auto --gas-adjustment 1.3 -y -b block
</code></pre>
<h3 id="leaving-a-family"><a class="header" href="#leaving-a-family">Leaving a family</a></h3>
<p>If wanting to leave, run the same initial command as above, followed by:</p>
<pre><code>./nyxd tx wasm execute ${MIXNET-CONTRACT} '{&quot;leave_family&quot;: {&quot;signature&quot;: &quot;3SEjfNcJ5L3cXdvWCdiQNT5DkCFJ2TurK5xsYyEdHH324nAA3bWvKoXmkjU9Xbr9ZyemGDLJ4dmGEHWUwL1LCWKq&quot;,&quot;family_head&quot;: &quot;8A3Pv7Y9xGZdhUYd7sMHKp5y3nn5P3aBDDnJLataYE2J&quot;}}' --node ${VALIDATOR-ENDPOINT} --from mix1 --chain-id nyx --gas-prices 0.025unym --gas auto --gas-adjustment 1.3 -y -b block
</code></pre>
<h2 id="checking-that-your-node-is-mixing-correctly"><a class="header" href="#checking-that-your-node-is-mixing-correctly">Checking that your node is mixing correctly</a></h2>
<h3 id="network-explorers"><a class="header" href="#network-explorers">Network explorers</a></h3>
<p>Once you’ve started your mix node and it connects to the validator, your node will automatically show up in the ‘Mix nodes’ section of either the Nym Network Explorers:</p>
<ul>
<li><a href="https://explorer.nymtech.net/overview">Mainnet</a></li>
<li><a href="https://sandbox-explorer.nymtech.net/">Sandbox testnet</a></li>
</ul>
<p>Enter your <strong>identity key</strong> to find your node. There are numerous statistics about your node on that page that are useful for checking your uptime history, packets mixed, and any delegations your node may have.</p>
<p>There are also 2 community explorers which have been created by <a href="https://nodes.guru">Nodes Guru</a>:</p>
<ul>
<li><a href="https://mixnet.explorers.guru/">Mainnet</a></li>
<li><a href="https://sandbox.mixnet.explorers.guru/">Sandbox testnet</a></li>
</ul>
<p>For more details see <a href="nodes/../nodes/troubleshooting.html">Troubleshooting FAQ</a></p>
<h3 id="virtual-ips-and-hosting-via-google--aws"><a class="header" href="#virtual-ips-and-hosting-via-google--aws">Virtual IPs and hosting via Google &amp; AWS</a></h3>
<p>On some services (AWS, Google, etc), the machine’s available bind address is not the same as the public IP address. In this case, bind <code>--host</code> to the local machine address returned by <code>ifconfig</code>, but also specify <code>--announce-host</code> with the public IP. Please make sure that you pass the correct, routable <code>--announce-host</code>.</p>
<p>For example, on a Google machine, you may see the following output from the <code>ifconfig</code> command:</p>
<pre><code>ens4: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1460
        inet 10.126.5.7  netmask 255.255.255.255  broadcast 0.0.0.0
        ...
</code></pre>
<p>The <code>ens4</code> interface has the IP <code>10.126.5.7</code>. But this isn’t the public IP of the machine, it’s the IP of the machine on Google’s internal network. Google uses virtual routing, so the public IP of this machine is something else, maybe <code>36.68.243.18</code>.</p>
<p><code>nym-mixnode init --host 10.126.5.7</code>, initalises the mix node, but no packets will be routed because <code>10.126.5.7</code> is not on the public internet.</p>
<p>Trying <code>nym-mixnode init --host 36.68.243.18</code>, you’ll get back a startup error saying <code>AddrNotAvailable</code>. This is because the mix node doesn’t know how to bind to a host that’s not in the output of <code>ifconfig</code>.</p>
<p>The right thing to do in this situation is <code>nym-mixnode init --host 10.126.5.7 --announce-host 36.68.243.18</code>.</p>
<p>This will bind the mix node to the available host <code>10.126.5.7</code>, but announce the mix node’s public IP to the directory server as <code>36.68.243.18</code>. It’s up to you as a node operator to ensure that your public and private IPs match up properly.</p>
<h2 id="metrics--api-endpoints"><a class="header" href="#metrics--api-endpoints">Metrics / API endpoints</a></h2>
<p>The mix node binary exposes several API endpoints that can be pinged in order to gather information about the node, and the Validator API exposes numerous mix node related endpoints which provide network-wide information about mix nodes, the network topology (the list of avaliable mix nodes for packet routing), and information regarding uptime monitoring and rewarding history. </p>
<h3 id="mix-node-api-endpoints"><a class="header" href="#mix-node-api-endpoints">Mix node API endpoints</a></h3>
<p>Since the mix node binary exposes several API endpoints itself, you can ping these easily via curl: </p>
<div class="table-wrapper"><table><thead><tr><th>Endpoint</th><th>Description</th><th>Command</th></tr></thead><tbody>
<tr><td><code>/description</code></td><td>Returns the description of the node set with the <code>describe</code> command</td><td><code>curl &lt;NODE_IP_ADDRESS&gt;:8000/description</code></td></tr>
<tr><td><code>/hardware</code></td><td>Returns the hardware information of the node</td><td><code>curl &lt;NODE_IP_ADDRESS&gt;:8000/hardware</code></td></tr>
<tr><td><code>/verloc</code></td><td>Returns the verloc information of the node, updated every 12 hours</td><td><code>curl &lt;NODE_IP_ADDRESS&gt;:8000/verloc</code></td></tr>
</tbody></table>
</div>
<p>The code for exposed API endpoints can be found <a href="https://github.com/nymtech/nym/tree/develop/mixnode/src/node/http">here</a>. </p>
<h3 id="mix-node-related-validator-api-endpoints"><a class="header" href="#mix-node-related-validator-api-endpoints">Mix node related Validator API endpoints</a></h3>
<p>Numerous endpoints are documented on the Validator API’s <a href="https://validator.nymtech.net/api/swagger/index.html">Swagger Documentation</a>. There you can also try out various requests from your broswer, and download the response from the API. Swagger will also show you what commands it is running, so that you can run these from an app or from your CLI if you prefer. </p>
<h2 id="ports"><a class="header" href="#ports">Ports</a></h2>
<p>All mix node-specific port configuration can be found in <code>$HOME/.nym/mixnodes/&lt;your-id&gt;/config/config.toml</code>. If you do edit any port configs, remember to restart your mix node.</p>
<h3 id="mix-node-port-reference"><a class="header" href="#mix-node-port-reference">Mix node port reference</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td><code>1789</code></td><td>Listen for mixnet traffic</td></tr>
<tr><td><code>1790</code></td><td>Listen for VerLoc traffic</td></tr>
<tr><td><code>8000</code></td><td>Metrics http API endpoint</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="gateways"><a class="header" href="#gateways">Gateways</a></h1>
<blockquote>
<p>The Nym gateway was built in the <a href="nodes/../binaries/building-nym.html">building nym</a> section. If you haven’t yet built Nym and want to run the code, go there first.</p>
</blockquote>
<h2 id="preliminary-steps-1"><a class="header" href="#preliminary-steps-1">Preliminary steps</a></h2>
<p>There are a couple of steps that need completing before starting to set up your gateway:</p>
<ul>
<li>preparing your wallet</li>
<li>requisitioning a VPS (Virtual Private Server)</li>
</ul>
<h3 id="wallet-preparation-1"><a class="header" href="#wallet-preparation-1">Wallet preparation</a></h3>
<h4 id="mainnet-1"><a class="header" href="#mainnet-1">Mainnet</a></h4>
<p>Before you initialise and run your gateway, head to our <a href="https://nymtech.net/download/">website</a> and download the Nym wallet for your operating system. If pre-compiled binaries for your operating system aren’t availiable, you can build the wallet yourself with instructions <a href="nodes/../wallet/desktop-wallet.html">here</a>. </p>
<p>If you don’t already have one, please create a Nym address using the wallet, and fund it with tokens. The minimum amount required to bond a gateway is 100 <code>NYM</code>, but make sure you have a bit more to account for gas costs. </p>
<p><code>NYM</code> is currently present on several exchanges. Head to our <a href="https://t.me/nymchan">telegram</a> or <a href="https://discord.com/invite/nym">Discord</a> channels to find out where to get <code>NYM</code> tokens. </p>
<blockquote>
<p>Remember that you can <strong>only</strong> use native Cosmos <code>NYM</code> tokens to bond your gateway. You <strong>cannot</strong> use ERC20 representations of <code>NYM</code> to run a node. </p>
</blockquote>
<h4 id="sandbox-testnet-1"><a class="header" href="#sandbox-testnet-1">Sandbox testnet</a></h4>
<p>Make sure to download a wallet and create an account as outlined above. Then head to our <a href="https://faucet.nymtech.net/">token faucet</a> and get some tokens to use to bond it. </p>
<h3 id="vps-hardware-specs-1"><a class="header" href="#vps-hardware-specs-1">VPS Hardware Specs</a></h3>
<p>You will need to rent a VPS to run your mix node on. One key reason for this is that your node <strong>must be able to send TCP data using both IPv4 and IPv6</strong> (as other nodes you talk to may use either protocol.</p>
<p>We currently have these <em>rough</em> specs for VPS hardware: </p>
<ul>
<li>Processors: 2 cores are fine. Get the fastest CPUs you can afford.</li>
<li>RAM: Memory requirements depend on the amount of users your Gateway will be serving at any one time. If you’re just going to be using it yourself, then minimal RAM is fine. <strong>If you’re running your Gateway as part of a Service Grant, get something with at least 4GB RAM.</strong> </li>
<li>Disks: much like the amount of RAM your Gateway could use, the amount of disk space required will vary with the amount of users your Gateway is serving. <strong>If you’re running your Gateway as part of a Service Grant, get something with at least 40GB storage.</strong> </li>
</ul>
<h2 id="gateway-setup"><a class="header" href="#gateway-setup">Gateway setup</a></h2>
<p>Now that you have built the codebase, set up your wallet, and have a VPS with the <code>nym-gateway</code> binary, you can set up your gateway with the instructions below.</p>
<h3 id="viewing-command-help-1"><a class="header" href="#viewing-command-help-1">Viewing command help</a></h3>
<p>You can check that your binaries are properly compiled with:</p>
<pre><code>./nym-gateway --help
</code></pre>
<details id="admonition-console-output" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/gateway-setup.html#admonition-console-output"></a></p>
</summary>
<div>
<pre><code>  _ __  _   _ _ __ ___
 | '_ \| | | | '_ \ _ \
 | | | | |_| | | | | | |
 |_| |_|\__, |_| |_| |_|
        |___/

         (gateway - version 1.1.4)

    
nym-gateway 1.1.4
Nymtech
Implementation of the Nym Mixnet Gateway

USAGE:
    nym-gateway [OPTIONS] &lt;SUBCOMMAND&gt;

OPTIONS:
        --config-env-file &lt;CONFIG_ENV_FILE&gt;
            Path pointing to an env file that configures the gateway

    -h, --help
            Print help information

    -V, --version
            Print version information

SUBCOMMANDS:
    completions          Generate shell completions
    generate-fig-spec    Generate Fig specification
    help                 Print this message or the help of the given subcommand(s)
    init                 Initialise the gateway
    node-details         Show details of this gateway
    run                  Starts the gateway
    sign                 Sign text to prove ownership of this mixnode
    upgrade              Try to upgrade the gateway
    
</code></pre>
</div>
</details>
<p>You can also check the various arguments required for individual commands with: </p>
<pre><code>./nym-gateway &lt;command&gt; --help
</code></pre>
<h3 id="initialising-your-gateway-standard-mode"><a class="header" href="#initialising-your-gateway-standard-mode">Initialising your gateway (standard mode)</a></h3>
<div id="admonition-caution" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="nodes/gateway-setup.html#admonition-caution"></a></p>
</div>
<div>
<p>If you are following these instructions to set up a gateway as part of a Service Grant, <strong>ignore these instructions and jump to the step <a href="nodes/./gateway-setup.html#initialising-your-gateway-stats-mode">below</a></strong></p>
</div>
</div>
<p>To check available configuration options use:</p>
<pre><code> ./nym-gateway init --help
</code></pre>
<details id="admonition-console-output-1" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/gateway-setup.html#admonition-console-output-1"></a></p>
</summary>
<div>
<pre><code>
  _ __  _   _ _ __ ___
 | '_ \| | | | '_ \ _ \
 | | | | |_| | | | | | |
 |_| |_|\__, |_| |_| |_|
        |___/

         (gateway - version 1.1.4)

    
nym-gateway-init 
Initialise the gateway

USAGE:
    nym-gateway init [OPTIONS] --id &lt;ID&gt; --host &lt;HOST&gt; --wallet-address &lt;WALLET_ADDRESS&gt;

OPTIONS:
        --announce-host &lt;ANNOUNCE_HOST&gt;
            The host that will be reported to the directory server

        --clients-port &lt;CLIENTS_PORT&gt;
            The port on which the gateway will be listening for clients gateway-requests

        --datastore &lt;DATASTORE&gt;
            Path to sqlite database containing all gateway persistent data

        --enabled-statistics &lt;ENABLED_STATISTICS&gt;
            Enable/disable gateway anonymized statistics that get sent to a statistics aggregator server

    -h, --help
            Print help information

        --host &lt;HOST&gt;
            The custom host on which the gateway will be running for receiving sphinx packets

        --id &lt;ID&gt;
            Id of the gateway we want to create config for

        --mix-port &lt;MIX_PORT&gt;
            The port on which the gateway will be listening for sphinx packets

        --mnemonic &lt;MNEMONIC&gt;
            Cosmos wallet mnemonic needed for double spending protection

        --statistics-service-url &lt;STATISTICS_SERVICE_URL&gt;
            URL where a statistics aggregator is running. The default value is a Nym aggregator server

        --validator-apis &lt;VALIDATOR_APIS&gt;
            Comma separated list of endpoints of the validators APIs

        --validators &lt;VALIDATORS&gt;
            Comma separated list of endpoints of the validator

        --wallet-address &lt;WALLET_ADDRESS&gt;
            The wallet address you will use to bond this gateway, e.g.
            nymt1z9egw0knv47nmur0p8vk4rcx59h9gg4zuxrrr9
</code></pre>
</div>
</details>
<p>The following command returns a gateway on your current IP with the <code>id</code> of <code>supergateway</code>:</p>
<pre><code>./nym-gateway init --id supergateway --host $(curl ifconfig.me) --wallet-address &lt;WALLET_ADDRESS&gt; --enabled-statistics true
</code></pre>
<p>The <code>$(curl ifconfig.me)</code> command above returns your IP automatically using an external service. Alternatively, you can enter your IP manually wish. If you do this, remember to enter your IP <strong>without</strong> any port information.</p>
<h3 id="initialising-your-gateway-stats-mode"><a class="header" href="#initialising-your-gateway-stats-mode">Initialising your gateway (stats mode)</a></h3>
<p>The following command returns a gateway on your current IP with the <code>id</code> of <code>supergateway</code> with statistics enabled:</p>
<pre><code>./nym-gateway init --id supergateway --host $(curl ifconfig.me) --wallet-address &lt;WALLET_ADDRESS&gt; --mnemonic &lt;MNEMONIC&gt; --enabled-statistics true
</code></pre>
<p>The <code>$(curl ifconfig.me)</code> command above returns your IP automatically using an external service. Alternatively, you can enter your IP manually wish. If you do this, remember to enter your IP <strong>without</strong> any port information.</p>
<h3 id="bonding-your-gateway"><a class="header" href="#bonding-your-gateway">Bonding your gateway</a></h3>
<h4 id="via-the-desktop-wallet-recommended"><a class="header" href="#via-the-desktop-wallet-recommended">Via the Desktop wallet (recommended)</a></h4>
<p>You can bond your gateway via the Desktop wallet. </p>
<p>Open your wallet, and head to the <code>Bond</code> page, then select the node type and input your node details. </p>
<h4 id="via-the-cli-power-users"><a class="header" href="#via-the-cli-power-users">Via the CLI (power users)</a></h4>
<p>If you want to bond your Gateway via the CLI, then check out the <a href="nodes/../tools/nym-cli.html">Nym CLI</a> tool. </p>
<h3 id="running-your-gateway-standard-mode"><a class="header" href="#running-your-gateway-standard-mode">Running your gateway (standard mode)</a></h3>
<div id="admonition-caution-1" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="nodes/gateway-setup.html#admonition-caution-1"></a></p>
</div>
<div>
<p>If you are following these instructions to set up a gateway as part of a Service Grant, <strong>ignore these instructions and jump to the step <a href="nodes/./gateway-setup.html#running-your-gateway-stats-mode">below</a></strong></p>
</div>
</div>
<p>The <code>run</code> command starts the gateway:</p>
<pre><code>./nym-gateway run --id supergateway
</code></pre>
<details id="admonition-console-output-2" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/gateway-setup.html#admonition-console-output-2"></a></p>
</summary>
<div>
<pre><code>Starting gateway supergateway...

To bond your gateway you will need to install the Nym wallet, go to https://nymtech.net/get-involved and select the Download button.
Select the correct version and install it to your machine. You will need to provide the following: 

Identity Key: 6jWSJZsQ888jwzi1CBfkHefiDdUEjgwfeMfJU4RNhDuk
Sphinx Key: HbqYJwjmtzDi4WzGp7ehj8Ns394sRvJnxtanX28upon
Owner Signature: wRKxr1CnoyBB9AYPSaXgE4dCP757ffMz5gkja8EKaYR82a63FK9HYV3HXZnLcSaNXkzN3CJnxG2FREv1ZE9xwvx
Host: 62.240.134.46 (bind address: 62.240.134.46)
Version: 1.1.
Mix Port: 1789, Clients port: 9000
Data store is at: &quot;/home/mx/.nym/gateways/supergateway/data/db.sqlite&quot;
2022-04-27T16:04:33.831Z INFO  nym_gateway::node &gt; Starting nym gateway!
2022-04-27T16:04:34.268Z INFO  nym_gateway::node &gt; Starting mix packet forwarder...
2022-04-27T16:04:34.269Z INFO  nym_gateway::node &gt; Starting mix socket listener...
2022-04-27T16:04:34.269Z INFO  nym_gateway::node::mixnet_handling::receiver::listener &gt; Running mix listener on &quot;62.240.134.46:1789&quot;
2022-04-27T16:04:34.269Z INFO  nym_gateway::node              
&gt; Starting client [web]socket listener...
2022-04-27T16:04:34.269Z INFO  nym_gateway::node                                      &gt; Finished nym gateway startup procedure - it should now be able to receive mix and client traffic!

</code></pre>
</div>
</details>
<h3 id="running-your-gateway-stats-mode"><a class="header" href="#running-your-gateway-stats-mode">Running your gateway (stats mode)</a></h3>
<pre><code>./nym-gateway run --id supergateway --enabled-statistics true
</code></pre>
<p>The <code>--enabled-statistics</code> flag starts the gateway in a mode which reports very minimal usage statistics - the amount of bytes sent to a service, and the number of requests - to a service we run, as part of the Nym Connect Beta testing. </p>
<p>Use the following command to ping our stats service to see what it has recorded (remember to change the <code>'until'</code> date):</p>
<pre><code>curl -d '{&quot;since&quot;:&quot;2022-07-26T12:46:00.000000+00:00&quot;, &quot;until&quot;:&quot;2022-07-26T12:57:00.000000+00:00&quot;}' -H &quot;Content-Type: application/json&quot; -X POST https://mainnet-stats.nymte.ch:8090/v1/all-statistics
</code></pre>
<details id="admonition-console-output-3" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/gateway-setup.html#admonition-console-output-3"></a></p>
</summary>
<div>
<pre><code>      [
        {
            &quot;Service&quot;:{
              &quot;requested_service&quot;:&quot;chat-0.core.keybaseapi.com:443&quot;,
              &quot;request_processed_bytes&quot;:294,
              &quot;response_processed_bytes&quot;:0,
              &quot;interval_seconds&quot;:60,
              &quot;timestamp&quot;:&quot;2022-07-26 12:55:44.459257091&quot;
            }
        },
        {
            &quot;Service&quot;:{
              &quot;requested_service&quot;:&quot;chat-0.core.keybaseapi.com:443&quot;,
              &quot;request_processed_bytes&quot;:890,
              &quot;response_processed_bytes&quot;:0,
              &quot;interval_seconds&quot;:60,
              &quot;timestamp&quot;:&quot;2022-07-26 12:56:44.459333653&quot;
            }
        },
        {
            &quot;Service&quot;:{
              &quot;requested_service&quot;:&quot;api-0.core.keybaseapi.com:443&quot;,
              &quot;request_processed_bytes&quot;:1473,
              &quot;response_processed_bytes&quot;:0,
              &quot;interval_seconds&quot;:60,
              &quot;timestamp&quot;:&quot;2022-07-26 12:56:44.459333653&quot;
            }
        },
        {
            &quot;Gateway&quot;:{
              &quot;gateway_id&quot;:&quot;Fo4f4SQLdoyoGkFae5TpVhRVoXCF8UiypLVGtGjujVPf&quot;,
              &quot;inbox_count&quot;:8,
              &quot;timestamp&quot;:&quot;2022-07-26 12:46:34.148075290&quot;
            }
        },
        {
            &quot;Gateway&quot;:{
              &quot;gateway_id&quot;:&quot;2BuMSfMW3zpeAjKXyKLhmY4QW1DXurrtSPEJ6CjX3SEh&quot;,
              &quot;inbox_count&quot;:6,
              &quot;timestamp&quot;:&quot;2022-07-26 12:46:51.578765358&quot;
            }
        },
        {
            &quot;Gateway&quot;:{
              &quot;gateway_id&quot;:&quot;Fo4f4SQLdoyoGkFae5TpVhRVoXCF8UiypLVGtGjujVPf&quot;,
              &quot;inbox_count&quot;:8,
              &quot;timestamp&quot;:&quot;2022-07-26 12:47:34.149270862&quot;
            }
        }
      ]                            
</code></pre>
</div>
</details>
<h3 id="upgrading-your-gateway"><a class="header" href="#upgrading-your-gateway">Upgrading your gateway</a></h3>
<ul>
<li>pause your gateway process </li>
<li>replace the existing binary with the newest binary (which you can either compile yourself or grab from our <a href="https://github.com/nymtech/nym/releases">releases page</a>)</li>
<li>restart your gateway process with the new binary.</li>
<li>rebond your gateway, updating the version number.</li>
</ul>
<blockquote>
<p>Do <strong>not</strong> use the <code>upgrade</code> command: there is a known error with the command that will be fixed in the next release. </p>
</blockquote>
<h2 id="vps-setup-and-automation-1"><a class="header" href="#vps-setup-and-automation-1">VPS Setup and Automation</a></h2>
<h3 id="configure-your-firewall-1"><a class="header" href="#configure-your-firewall-1">Configure your firewall</a></h3>
<p>Although your gateway is now ready to receive traffic, your server may not be - the following commands will allow you to set up a properly configured firewall using <code>ufw</code>:</p>
<pre><code># check if you have ufw installed
ufw version
# if it is not installed, install with
sudo apt install ufw -y
# enable ufw
sudo ufw enable
# check the status of the firewall
sudo ufw status
</code></pre>
<p>Finally open your gateway’s p2p port, as well as ports for ssh and incoming traffic connections:</p>
<pre><code>sudo ufw allow 1789,22,9000/tcp
# check the status of the firewall
sudo ufw status
</code></pre>
<p>For more information about your gateway’s port configuration, check the <a href="nodes/gateway-setup.html#gateway-port-reference">gateway port reference table</a> below.</p>
<h3 id="automating-your-gateway-with-systemd"><a class="header" href="#automating-your-gateway-with-systemd">Automating your gateway with systemd</a></h3>
<p>Although it’s not totally necessary, it’s useful to have the gateway automatically start at system boot time. Here’s a systemd service file to do that:</p>
<pre><code class="language-ini">[Unit]
Description=Nym Gateway (1.1.4)
StartLimitInterval=350
StartLimitBurst=10

[Service]
User=nym
LimitNOFILE=65536
ExecStart=/home/nym/nym-gateway run --id supergateway
KillSignal=SIGINT
Restart=on-failure
RestartSec=30

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Put the above file onto your system at <code>/etc/systemd/system/nym-gateway.service</code>.</p>
<p>If you want to enable statistics mode, the start command would be: 
<code>ExecStart=/home/nym/nym-gateway run --id supergateway --enabled-statistics true</code></p>
<p>Change the path in <code>ExecStart</code> to point at your gateway binary (<code>nym-gateway</code>), and the <code>User</code> so it is the user you are running as.</p>
<p>If you have built nym on your server, and your username is <code>jetpanther</code>, then the start command might look like this:</p>
<p><code>ExecStart=/home/jetpanther/nym/target/release/nym-gateway run --id your-id</code>. Basically, you want the full <code>/path/to/nym-gateway run --id whatever-your-node-id-is</code></p>
<p>Then run:</p>
<pre><code>systemctl enable nym-gateway.service
</code></pre>
<p>Start your node:</p>
<pre><code>service nym-gateway start
</code></pre>
<p>This will cause your node to start at system boot time. If you restart your machine, the node will come back up automatically.</p>
<p>You can also do <code>service nym-gateway stop</code> or <code>service nym-gateway restart</code>.</p>
<p>Note: if you make any changes to your systemd script after you’ve enabled it, you will need to run:</p>
<pre><code>systemctl daemon-reload
</code></pre>
<p>This lets your operating system know it’s ok to reload the service configuration.</p>
<h2 id="gateway-related-validator-api-endpoints"><a class="header" href="#gateway-related-validator-api-endpoints">Gateway related Validator API endpoints</a></h2>
<p>Numerous gateway related API endpoints are documented on the Validator API’s <a href="https://validator.nymtech.net/api/swagger/index.html">Swagger Documentation</a>. There you can also try out various requests from your broswer, and download the response from the API. Swagger will also show you what commands it is running, so that you can run these from an app or from your CLI if you prefer. </p>
<h2 id="ports-1"><a class="header" href="#ports-1">Ports</a></h2>
<p>All gateway specific port configuration can be found in <code>$HOME/.nym/gateways/&lt;your-id&gt;/config/config.toml</code>. If you do edit any port configs, remember to restart your gateway.</p>
<h3 id="gateway-port-reference"><a class="header" href="#gateway-port-reference">Gateway port reference</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td>1789</td><td>Listen for Mixnet traffic</td></tr>
<tr><td>9000</td><td>Listen for Client traffic</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="network-requesters"><a class="header" href="#network-requesters">Network Requesters</a></h1>
<blockquote>
<p>The Nym network requester was built in the <a href="nodes/../binaries/building-nym.html">building nym</a> section. If you haven’t yet built Nym and want to run the code on this page, go there first.</p>
</blockquote>
<h2 id="anatomy-of-a-network-requester-service"><a class="header" href="#anatomy-of-a-network-requester-service">Anatomy of a network requester service</a></h2>
<p>The network requester allows Nym users to make outbound network requests from your server.</p>
<p>The network requester is <strong>not</strong> an open proxy. It ships with a file called <code>allowed.list.sample</code>, which contains URLs used by the Blockstream Green and Electrum cryptographic wallets, which can be modified with the URLs of the web services it will connect to according to the maintainer of that instance.</p>
<p>A network requester service is comprised of 2 Nym binaries running on one VPS: </p>
<ul>
<li><code>nym-client</code> </li>
<li><code>nym-network-requester</code></li>
</ul>
<p>The <code>nym-network-requester</code> binary listens and sends responses to the <code>nym-client</code>, which is how it connects to the mixnet. </p>
<h2 id="nym-client"><a class="header" href="#nym-client">Nym client</a></h2>
<p>Before initalising your network requester, you must initalise and run an instance of the <code>nym-client</code> binary for it to communicate with. This would have been built in the same <code>build</code> process that built the <code>network-requester</code>. </p>
<h3 id="initialising-your-nym-client"><a class="header" href="#initialising-your-nym-client">Initialising your nym client</a></h3>
<p>First initialise your client with the command below (if you want to connect to a specific gateway, include the <code>--gateway</code> flag): </p>
<pre><code> ./nym-client init --id &lt;id&gt;
</code></pre>
<details id="admonition-console-output" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/network-requester-setup.html#admonition-console-output"></a></p>
</summary>
<div>
<pre><code>Initialising client...
Saved all generated keys
Saved configuration file to &quot;/home/nym/.nym/clients/requester-client/config/config.toml&quot;
Using gateway: 8yGFbT5feDpPmH66TveVjonpUn3tpvjobdvEWRbsTH9i
Client configuration completed.

The address of this client is: BUVD1uAXEWSfMDdewwfxUAd6gSsEfHHPvnsV8LTfe9ZG.DaY9kqXREEkvpJ1Nv3nrfxF6HDamsJmtZQDFuyTAXwJZ@8yGFbT5feDpPmH66TveVjonpUn3tpvjobdvEWRbsTH9i

</code></pre>
</div>
</details>
<h3 id="running-your-nym-client"><a class="header" href="#running-your-nym-client">Running your nym client</a></h3>
<p>You can check that your client is initialised correctly by running the following command and checking it starts up correctly: </p>
<pre><code>./nym-client run --id &lt;id&gt;
</code></pre>
<details id="admonition-console-output-1" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/network-requester-setup.html#admonition-console-output-1"></a></p>
</summary>
<div>
<pre><code>   _ __  _   _ _ __ ___
  | '_ \| | | | '_ \ _ \
  | | | | |_| | | | | | |
  |_| |_|\__, |_| |_| |_|
        |___/

        (client - version 1.1.4)

        
2022-08-09T15:06:03.276Z INFO  nym_client::client &gt; Starting nym client
2022-08-09T15:06:03.293Z INFO  nym_client::client &gt; Obtaining initial network topology
2022-08-09T15:06:04.957Z INFO  nym_client::client &gt; Starting topology refresher...
2022-08-09T15:06:04.957Z INFO  nym_client::client &gt; Starting received messages buffer controller...
</code></pre>
</div>
</details>
<h3 id="automating-your-client-with-systemd"><a class="header" href="#automating-your-client-with-systemd">Automating your client with systemd</a></h3>
<p>Stop the running process with <code>CTRL-C</code>, and create a service file at <code>/etc/systemd/system/nym-client.service</code> so you don’t have to manually restart your client if your server reboots or the process is killed for some reason: </p>
<pre><code class="language-ini">[Unit]
Description=Nym Client (1.1.4)
StartLimitInterval=350
StartLimitBurst=10

[Service]
User=nym # replace this with whatever user you wish 
LimitNOFILE=65536
ExecStart=/home/nym/nym-client run --id requester-client # remember to check the path to your nym-client binary and the id of your client 
KillSignal=SIGINT
Restart=on-failure
RestartSec=30

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Then enable and start your client with the following commands: </p>
<pre><code>systemctl enable nym-client.service
systemctl start nym-client.service

# you can always check your client has succesfully started with: 
systemctl status nym-client.service
</code></pre>
<p>With <code>systemctl status nym-client.service</code> you should be able to see the address of the client at startup. Alternatively you can use <code>journalctl -t nym-client -o cat -f</code> to get the output of the client in your console as it comes in. </p>
<p>Make a note of the client’s address:</p>
<pre><code> 2021-07-10T14:45:50.131 INFO  nym_client::client              &gt; The address of this client is: BLJ6SrgbaYjb7Px32G7zSZnocuim3HT9n3ocKcwQHETd.4WAAh7xRxWVeiohcw44G8wQ5bGHMEvq8j9LctDkGKUC7@8yGFbT5feDpPmH66TveVjonpUn3tpvjobdvEWRbsTH9i
</code></pre>
<h2 id="network-requester"><a class="header" href="#network-requester">Network requester</a></h2>
<h3 id="running-your-network-requester-standard-mode"><a class="header" href="#running-your-network-requester-standard-mode">Running your network requester (standard mode)</a></h3>
<div id="admonition-caution" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="nodes/network-requester-setup.html#admonition-caution"></a></p>
</div>
<div>
<p>If you are following these instructions to set up a requester as part of a Service Grant, <strong>ignore these instructions and jump to the step <a href="nodes/./network-requester-setup.html#running-your-network-requester-stats-mode">below</a></strong></p>
</div>
</div>
<p>Now that we have a running client for the requester to listen to, we can start it with the following command: </p>
<pre><code> ./nym-network-requester run  
</code></pre>
<details id="admonition-console-output-2" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/network-requester-setup.html#admonition-console-output-2"></a></p>
</summary>
<div>
<pre><code>Starting socks5 service provider:
2021-08-11T13:28:02.767Z INFO  nym_network_requester::core &gt; * connected to local websocket server at ws://localhost:1977

All systems go. Press CTRL-C to stop the server.
</code></pre>
</div>
</details>
<p>As you can see, it has connected to the nym client that we started before. </p>
<h3 id="running-your-network-requester-stats-mode"><a class="header" href="#running-your-network-requester-stats-mode">Running your network requester (stats mode)</a></h3>
<p>Now that we have a running client for the requester to listen to, we can start it with the following command. </p>
<pre><code> ./nym-network-requester run --enable-statistics
</code></pre>
<details id="admonition-console-output-3" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/network-requester-setup.html#admonition-console-output-3"></a></p>
</summary>
<div>
<pre><code>THE NETWORK REQUESTER STATISTICS ARE ENABLED. IT WILL COLLECT AND SEND ANONYMIZED STATISTICS TO A CENTRAL SERVER. PLEASE QUIT IF YOU DON'T WANT THIS TO HAPPEN AND START WITHOUT THE enable-statistics FLAG .

Starting socks5 service provider:
2022-08-09T12:26:45.154Z INFO  nym_network_requester::core &gt; * connected to local websocket server at ws://localhost:1977

All systems go. Press CTRL-C to stop the server.
</code></pre>
</div>
</details>
<p>As you can see, it has connected to the nym client that we started before. </p>
<p>The <code>--enable-statistics</code> flag starts the node in a mode which reports very minimal usage statistics - the amount of bytes sent to a service, and the number of requests - to a service we run, as part of the Nym Connect Beta testing. </p>
<p>Use the following command to ping our stats service to see what it has recorded (remember to change the <code>'until'</code> date): </p>
<pre><code>curl -d '{&quot;since&quot;:&quot;2022-07-26T12:46:00.000000+00:00&quot;, &quot;until&quot;:&quot;2022-07-26T12:57:00.000000+00:00&quot;}' -H &quot;Content-Type: application/json&quot; -X POST http://mainnet-stats.nymte.ch:8090/v1/all-statistics
</code></pre>
<details id="admonition-console-output-4" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="nodes/network-requester-setup.html#admonition-console-output-4"></a></p>
</summary>
<div>
<pre><code>      [
        {
            &quot;Service&quot;:{
              &quot;requested_service&quot;:&quot;chat-0.core.keybaseapi.com:443&quot;,
              &quot;request_processed_bytes&quot;:294,
              &quot;response_processed_bytes&quot;:0,
              &quot;interval_seconds&quot;:60,
              &quot;timestamp&quot;:&quot;2022-07-26 12:55:44.459257091&quot;
            }
        },
        {
            &quot;Service&quot;:{
              &quot;requested_service&quot;:&quot;chat-0.core.keybaseapi.com:443&quot;,
              &quot;request_processed_bytes&quot;:890,
              &quot;response_processed_bytes&quot;:0,
              &quot;interval_seconds&quot;:60,
              &quot;timestamp&quot;:&quot;2022-07-26 12:56:44.459333653&quot;
            }
        },
        {
            &quot;Service&quot;:{
              &quot;requested_service&quot;:&quot;api-0.core.keybaseapi.com:443&quot;,
              &quot;request_processed_bytes&quot;:1473,
              &quot;response_processed_bytes&quot;:0,
              &quot;interval_seconds&quot;:60,
              &quot;timestamp&quot;:&quot;2022-07-26 12:56:44.459333653&quot;
            }
        },
        {
            &quot;Gateway&quot;:{
              &quot;gateway_id&quot;:&quot;Fo4f4SQLdoyoGkFae5TpVhRVoXCF8UiypLVGtGjujVPf&quot;,
              &quot;inbox_count&quot;:8,
              &quot;timestamp&quot;:&quot;2022-07-26 12:46:34.148075290&quot;
            }
        },
        {
            &quot;Gateway&quot;:{
              &quot;gateway_id&quot;:&quot;2BuMSfMW3zpeAjKXyKLhmY4QW1DXurrtSPEJ6CjX3SEh&quot;,
              &quot;inbox_count&quot;:6,
              &quot;timestamp&quot;:&quot;2022-07-26 12:46:51.578765358&quot;
            }
        },
        {
            &quot;Gateway&quot;:{
              &quot;gateway_id&quot;:&quot;Fo4f4SQLdoyoGkFae5TpVhRVoXCF8UiypLVGtGjujVPf&quot;,
              &quot;inbox_count&quot;:8,
              &quot;timestamp&quot;:&quot;2022-07-26 12:47:34.149270862&quot;
            }
        }
      ]                            
</code></pre>
</div>
</details>
<h3 id="automating-your-network-requester-with-systemd"><a class="header" href="#automating-your-network-requester-with-systemd">Automating your network requester with systemd</a></h3>
<p>Stop the running process with <code>CTRL-C</code>, and create a service file for the requester as we did with our client instance previously at <code>/etc/systemd/system/nym-network-requester.service</code>:</p>
<pre><code class="language-ini">[Unit]
Description=Nym Network Requester (1.1.4)
StartLimitInterval=350
StartLimitBurst=10

[Service]
User=nym # replace this with whatever user you wish 
LimitNOFILE=65536
# remember to add the `--enable-statistics` flag if running as part of a service grant and check the path to your nym-network-requester binary 
ExecStart=/home/nym/nym-network-requester run 
KillSignal=SIGINT
Restart=on-failure
RestartSec=30

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Now enable and start your requester: </p>
<pre><code>systemctl enable nym-network-requester.service
systemctl start nym-network-requester.service

# you can always check your requester has succesfully started with: 
systemctl status nym-network-requester.service
</code></pre>
<h2 id="vps-setup"><a class="header" href="#vps-setup">VPS Setup</a></h2>
<h3 id="configure-your-firewall-2"><a class="header" href="#configure-your-firewall-2">Configure your firewall</a></h3>
<p>Although your requester is now ready to receive traffic, your server may not be - the following commands will allow you to set up a properly configured firewall using <code>ufw</code>:</p>
<pre><code># check if you have ufw installed
ufw version
# if it is not installed, install with
sudo apt install ufw -y
# enable ufw
sudo ufw enable
# check the status of the firewall
sudo ufw status
</code></pre>
<p>Finally open your requester’s p2p port, as well as ports for ssh and incoming traffic connections:</p>
<pre><code>sudo ufw allow 1789,22,9000/tcp
# check the status of the firewall
sudo ufw status
</code></pre>
<p>For more information about your requester’s port configuration, check the <a href="nodes/./network-requester-setup.html#requester-port-reference">requester port reference table</a> below.</p>
<h2 id="using-your-network-requester"><a class="header" href="#using-your-network-requester">Using your network requester</a></h2>
<div id="admonition-caution-1" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="nodes/network-requester-setup.html#admonition-caution-1"></a></p>
</div>
<div>
<p>Service Grant grantees should only whitelist a single application - edit your <code>allowed.list</code> accordingly!</p>
</div>
</div>
<p>You can safely share the address of your running <code>nym-client</code> with however you want - if you would like to run a Network Requester for the whole Nym network, give it to us and we can even put it in the Nym documentation.</p>
<p>Is this safe to do? If it was an open proxy, this would be unsafe, because any Nym user could make network requests to any system on the internet.</p>
<p>To make things a bit less stressful for administrators, the Network Requester drops all incoming requests by default. In order for it to make requests, you need to add specific domains to the <code>allowed.list</code> file at <code>$HOME/.nym/service-providers/network-requester/allowed.list</code>.</p>
<p>If you want, you can just use the domains in the default <code>allowed.list</code>, by running this command from the top-level <code>nym</code> code directory:</p>
<pre><code>cp service-providers/network-requester/allowed.list.sample ~/.nym/service-providers/network-requester/allowed.list
</code></pre>
<p>Those URLs will let through requests for the Blockstream Green and Electrum cryptocurrency wallets, as well as the KeyBase chat client.</p>
<blockquote>
<p>If you change your <code>allowed.list</code>, make sure you restart the <code>nym-network-requester.service</code> to pick up the new allowed request list</p>
</blockquote>
<h3 id="adding-urls-for-other-clients"><a class="header" href="#adding-urls-for-other-clients">Adding URLs for other clients</a></h3>
<p>It would suck if Nym was restricted to only three clients. How can we add support for a new application? It’s fairly easy to do.</p>
<p>Have a look in your nym-network-requester config directory:</p>
<pre><code>ls $HOME/.nym/service-providers/network-requester/

# returns: allowed.list  unknown.list
</code></pre>
<p>We already know that <code>allowed.list</code> is what lets requests go through. All unknown requests are logged to <code>unknown.list</code>. If you want to try using a new client type, just start the new application, point it at your local SOCKS5 proxy (configured to use your remote <code>nym-network-requester</code>), and keep copying URLs from <code>unknown.list</code> into <code>allowed.list</code> (it may take multiple tries until you get all of them, depending on the complexity of the application).</p>
<p>If you add support for a new application, we’d love to hear about it: let us know or submit a commented pull request on <code>allowed.list.sample</code>. </p>
<blockquote>
<p>If you are adding custom domains, please note that whilst they may appear in the logs of your network-requester as something like <code>api-0.core.keybaseapi.com:443</code>, you <strong>only need</strong> to include the main domain name, in this instance <code>keybaseapi.com</code></p>
</blockquote>
<h3 id="running-an-open-proxy"><a class="header" href="#running-an-open-proxy">Running an open proxy</a></h3>
<p>If you <em>really</em> want to run an open proxy, perhaps for testing purposes for your own use or among a small group of trusted friends, it is possible to do so. You can disable network checks by passing the flag <code>--open-proxy</code> flag when you run it. If you run in this configuration, you do so at your own risk.</p>
<h2 id="testing-your-network-requester"><a class="header" href="#testing-your-network-requester">Testing your network requester</a></h2>
<ol>
<li>
<p>Add <code>nymtech.net</code> to your <code>allowed.list</code> (remember to restart your network requester). </p>
</li>
<li>
<p>Initialise a local socks5 client with the address of your network requester as the value of the <code>--provider</code> flag, following instructions <a href="nodes/../clients/socks5-client.html">here</a></p>
</li>
<li>
<p>In another terminal window, run the following: </p>
</li>
</ol>
<pre><code>curl -x socks5h://localhost:1080 https://nymtech.net/.wellknown/connect/healthcheck.json 
</code></pre>
<p>This command should return the following:</p>
<pre><code>{ &quot;status&quot;: &quot;ok&quot; }
</code></pre>
<h2 id="ports-2"><a class="header" href="#ports-2">Ports</a></h2>
<h3 id="requester-port-reference"><a class="header" href="#requester-port-reference">Requester port reference</a></h3>
<p>All requester-specific port configuration can be found in <code>$HOME/.nym/clients/&lt;YOUR_ID&gt;/config/config.toml</code> &amp; <code>$HOME/.nym/service-providers/&lt;YOUR_ID&gt;/config/config.toml</code>. If you do edit any port configs, remember to restart your client and requester processes.</p>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td>1789</td><td>Listen for Mixnet traffic</td></tr>
<tr><td>9000</td><td>Listen for Client traffic</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="validators"><a class="header" href="#validators">Validators</a></h1>
<p>The validator is built using <a href="https://cosmos.network">Cosmos SDK</a> and <a href="https://tendermint.com">Tendermint</a>, with a <a href="https://cosmwasm.com">CosmWasm</a> smart contract controlling the directory service, node bonding, and delegated mixnet staking.</p>
<h2 id="building-your-validator"><a class="header" href="#building-your-validator">Building your validator</a></h2>
<h3 id="prerequisites-1"><a class="header" href="#prerequisites-1">Prerequisites</a></h3>
<ul>
<li><code>git</code></li>
</ul>
<pre><code>sudo apt update
sudo apt install git
</code></pre>
<p>Verify <code>git</code> is installed with:</p>
<pre><code>git version
# Should return: git version X.Y.Z
</code></pre>
<ul>
<li><code>Go</code></li>
</ul>
<p><code>Go</code> can be installed via the following commands (taken from the <a href="https://github.com/Agoric/agoric-sdk/wiki/Validator-Guide-for-Incentivized-Testnet#install-go">Agoric SDK docs</a>):</p>
<pre><code># First remove any existing old Go installation
sudo rm -rf /usr/local/go

# Install correct Go version
curl https://dl.google.com/go/go1.19.2.linux-amd64.tar.gz | sudo tar -C/usr/local -zxvf -

# Update environment variables to include go
cat &lt;&lt;'EOF' &gt;&gt;$HOME/.profile
export GOROOT=/usr/local/go
export GOPATH=$HOME/go
export GO111MODULE=on
export PATH=$PATH:/usr/local/go/bin:$HOME/go/bin
EOF
source $HOME/.profile
</code></pre>
<p>Verify <code>Go</code> is installed with:</p>
<pre><code>go version
# Should return: go version go1.19.2 linux/amd64
</code></pre>
<ul>
<li><code>gcc</code></li>
</ul>
<p><code>gcc</code> can be installed with:</p>
<pre><code>sudo apt install build-essential
# Optional additional manual pages can be installed with:
sudo apt-get install manpages-dev
</code></pre>
<p>Verify <code>gcc</code> is installed with:</p>
<pre><code>gcc --version
</code></pre>
<p>Which should return something like:</p>
<pre><code>gcc (Ubuntu 7.4.0-1ubuntu1~18.04) 7.4.0
Copyright (C) 2017 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
</code></pre>
<h3 id="building-your-validator-1"><a class="header" href="#building-your-validator-1">Building your validator</a></h3>
<p>We use the <code>wasmd</code> version of the Cosmos validator to run our blockchain. First define the correct variables by selecting the correct network below, as the instructions, files, and endpoints differ in the instructions from here on in: </p>
<Tabs groupId="nym-network">
    <TabItem value="mainnet" label="Nyx (Mainnet)">
      <pre>
      <code>
        BECH32_PREFIX=n
      </code>
    </pre>
      <pre>
      <code>
        WASMD_VERSION=v0.26.1
      </code>
    </pre>
        <pre>
      <code>
      NYM_APP_NAME=nyxd
      </code>
    </pre>
  </TabItem>
<TabItem value="sandbox" label="Sandbox (Testnet)">
    <pre>
      <code>
        BECH32_PREFIX=nymt
      </code>
    </pre>
        <pre>
      <code>
        WASMD_VERSION=v0.21.0
      </code>
    </pre>
    <pre>
      <code>
      NYM_APP_NAME=nymd
      </code>
    </pre>
    </TabItem>
</Tabs>
<p>Then run this to clone, compile, and build your validator:</p>
<pre><code>git clone git@github.com:nymtech/nyxd.git
cd nyxd
git checkout ${WASMD_VERSION}
mkdir build
go build -o ./build/${NYM_APP_NAME} -mod=readonly -tags &quot;netgo,ledger&quot; -ldflags &quot;-X github.com/cosmos/cosmos-sdk/version.Name=${NYM_APP_NAME} -X github.com/cosmos/cosmos-sdk/version.AppName=${NYM_APP_NAME} -X github.com/CosmWasm/wasmd/app.NodeDir=.${NYM_APP_NAME} -X github.com/cosmos/cosmos-sdk/version.Version=${WASMD_VERSION} -X github.com/cosmos/cosmos-sdk/version.Commit=2582f0aab7b2cbf66ade066fe570a4622cf0b098 -X github.com/CosmWasm/wasmd/app.Bech32Prefix=${BECH32_PREFIX} -X \&quot;github.com/cosmos/cosmos-sdk/version.BuildTags=netgo,ledger\&quot;&quot; -trimpath ./cmd/wasmd
</code></pre>
<p>At this point, you will have a copy of the <code>nymd</code> (for sandbox) or <code>nyxd</code> (for mainnet) binary in your <code>build/</code> directory. Test that it’s compiled properly by running:</p>
<pre><code>./build/${NYM_APP_NAME}
</code></pre>
<p>You should see help text print out.</p>
<p>Both the <code>nymd</code> or <code>nyxd</code> binary and the <code>libwasmvm.so</code> shared object library binary have been compiled. <code>libwasmvm.so</code> is the wasm virtual machine which is needed to execute smart contracts.</p>
<div id="admonition-caution" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="nodes/validator-setup.html#admonition-caution"></a></p>
</div>
<div>
<p>If you have compiled these files locally you need to upload both of them to the server on which the validator will run. <strong>If you have instead compiled them on the server skip to the step outlining setting <code>LD_LIBRARY PATH</code> below.</strong></p>
</div>
</div>
<p>To locate these files on your local system run (replace <code>nyxd</code> with <code>nymd</code> for Sandbox testnet builds):</p>
<pre><code>WASMVM_SO=$(ldd build/nyxd | grep libwasmvm.so | awk '{ print $3 }')
ls ${WASMVM_SO}      
</code></pre>
<p>This will output something like:</p>
<pre><code>'/home/username/go/pkg/mod/github.com/!cosm!wasm/wasmvm@v0.13.0/api/libwasmvm.so'
</code></pre>
<p>:::note</p>
<p>if you are on Mac OSX use this command instead:</p>
<pre><code>WASMVM_SO=$(otool -L build/nymd | grep libwasmvm.so | awk '{ print $3 }')
ls ${WASMVM_SO}
</code></pre>
<p>To get the location of the <code>libwasmvm.so</code> file.
:::</p>
<p>When you upload your <code>nymd</code>/<code>nyxd</code> binary, you’ll need to tell it where <code>libwasmvm.so</code> is when you start your validator, or it will not run. If you have compiled them on your server then this is not necessary, as the compiled <code>nymd</code>/<code>nyxd</code> already has access to <code>libwasmvm.so</code>.</p>
<p>Upload both <code>nymd</code>/<code>nyxd</code> and <code>libwasmvm.so</code> to your validator machine. If <code>nymd</code>/<code>nyxd</code> can’t find <code>libwasmvm.so</code> you will see an error like the following:</p>
<pre><code>./nyxd: error while loading shared libraries: libwasmvm.so: cannot open shared object file: No such file or directory
</code></pre>
<p>You’ll need to set <code>LD_LIBRARY_PATH</code> in your user’s <code>~/.bashrc</code> file, and add that to our path. Replace <code>/home/youruser/path/to/nym/binaries</code> in the command below to the locations of <code>nymd</code> and <code>libwasmvm.so</code> and run it. If you have compiled these on the server, they will be in the <code>build/</code> folder:</p>
<pre><code>NYX_BINARIES=/home/youruser/path/to/nym/binaries
# if you are using another shell like zsh replace '.bashrc' with the relevant config file
echo 'export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:'NYX_BINARIES &gt;&gt; ~/.bashrc 
echo 'export PATH=$PATH:'${NYX_BINARIES} &gt;&gt; ~/.bashrc
source ~/.bashrc
</code></pre>
<p>Test everything worked:</p>
<Tabs groupId="nym-network">
    <TabItem value="mainnet" label="Nyx (Mainnet)">
      <pre>
      <code>
        nyxd      
      </code>
    </pre>
  </TabItem>
    <TabItem value="sandbox" label="Sandbox (Testnet)">
    <pre>
      <code>
        nymd  
      </code>
    </pre>
    </TabItem>
</Tabs>
<p>This should return the regular help text.</p>
<h3 id="initialising-your-validator"><a class="header" href="#initialising-your-validator">Initialising your validator</a></h3>
<p>Prerequisites:</p>
<ul>
<li>FQDN Domain name</li>
<li>IPv4 and IPv6 connectivity</li>
</ul>
<p>Choose a name for your validator and use it in place of <code>YOUR_NAME</code> in the following command:</p>
<Tabs groupId="nym-network">
    <TabItem value="mainnet" label="Nyx (Mainnet)">
    <pre>
      nyxd init YOUR_NAME --chain-id=nyx 
    </pre>
  </TabItem>
  <TabItem value="sandbox" label="Sandbox (Testnet)">
    <pre>
      nymd init YOUR_NAME --chain-id=nym-sandbox 
    </pre>
  </TabItem>
</Tabs>
<div id="admonition-caution-1" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="nodes/validator-setup.html#admonition-caution-1"></a></p>
</div>
<div>
<p><code>init</code> generates <code>priv_validator_key.json</code> and <code>node_key.json</code>.</p>
<p>If you have already set up a validator on a previous testnet, <strong>make sure to back up the key located at</strong> 
<code>~/.nymd/config/priv_validator_key.json</code>. </p>
<p>If you don’t save the validator key, then it can’t sign blocks and will be jailed all the time, and
there is no way to deterministically (re)generate this key.</p>
</div>
</div>
<Tabs groupId="nym-network">
    <TabItem value="mainnet" label="Nyx (Mainnet)">
      At this point, you have a new validator, with its own genesis file located at <code>$HOME/.nyxd/config/genesis.json</code>. You will need to replace the contents of that file that with the Nyx Mainnet <a href="https://nymtech.net/genesis/genesis.json">genesis file</a>. You can use the following command to download the one for the Nyx Mainnet:
      <pre>
      <code>
      wget  -O $HOME/.nyxd/config/genesis.json https://nymtech.net/genesis/genesis.json
      </code>
    </pre>
  </TabItem>
  <TabItem value="sandbox" label="Sandbox (Testnet)">
    At this point, you have a new validator, with its own genesis file located at <code>$HOME/.nymd/config/genesis.json</code>. You will need to replace the contents of that file that with the Sandbox Testnet <a href="https://nymtech.net/testnets/sandbox/genesis.json">genesis file</a>. You can use the following command to download the one for the Sandbox testnet:
    <pre>
      <code>
      wget  -O $HOME/.nymd/config/genesis.json https://nymtech.net/testnets/sandbox/genesis.json
      </code>
      </pre>
  </TabItem>
</Tabs>
<h3 id="configtoml-configuration"><a class="header" href="#configtoml-configuration"><code>config.toml</code> configuration</a></h3>
<Tabs groupId="nym-network">
    <TabItem value="mainnet" label="Nyx (Mainnet)">
    Edit the following config options in <code>$HOME/.nyxd/config/config.toml</code> to match the information below:
    <pre>
      persistent_peers = "ee03a6777fb76a2efd0106c3769daaa064a3fcb5@51.79.21.187:26656" 
    </pre>
    <pre>
      create_empty_blocks = false 
    </pre>
    <pre>
      laddr = "tcp://0.0.0.0:26656" 
    </pre>
  </TabItem>
  <TabItem value="sandbox" label="Sandbox (Testnet)">
    Add the Nym validator as a persistent peer so that your validator can start pulling blocks from the rest of the network, by editing the following config options in <code>$HOME/.nymd/config/config.toml</code> to match the information below:
    <pre>
      cors_allowed_origins = ["*"] 
    </pre>
    <pre>
      persistent_peers = "d24ee58d85a65d34ad5adfc3302c3614b36e8b14@sandbox-validator.nymtech.net:26656" 
    </pre>
    <pre>
      create_empty_blocks = false 
    </pre>
    <pre>
      laddr = "tcp://0.0.0.0:26656" 
    </pre>
  </TabItem>
</Tabs>
<p>These affect the following: </p>
<ul>
<li><code>persistent_peers = &quot;&lt;PEER_ADDRESS&gt;@&lt;DOMAIN&gt;.nymtech.net:26656&quot;</code> allows your validator to start pulling blocks from other validators</li>
<li><code>create_empty_blocks = false</code> will save space </li>
<li><code>laddr = &quot;tcp://0.0.0.0:26656&quot;</code> is in your p2p configuration options </li>
</ul>
<p>Optionally, if you want to enable <a href="https://prometheus.io/">Prometheus</a> metrics then the following must also match in the <code>config.toml</code>:</p>
<ul>
<li><code>prometheus = true</code></li>
<li><code>prometheus_listen_addr = &quot;:26660&quot;</code></li>
</ul>
<blockquote>
<p>Remember to enable metrics in the ‘Configuring Prometheus metrics’ section below as well.</p>
</blockquote>
<p>And if you wish to add a human-readable moniker to your node:</p>
<ul>
<li><code>moniker = &quot;yourname&quot;</code></li>
</ul>
<p>Finally, if you plan on using <a href="https://cockpit-project.org/documentation.html">Cockpit</a> on your server, change the <code>grpc</code> port from <code>9090</code> as this is the port used by Cockpit.</p>
<h3 id="apptoml-configuration"><a class="header" href="#apptoml-configuration"><code>app.toml</code> configuration</a></h3>
<p>In the file <code>$HOME/.${NYM_APP_NAME}/config/app.toml</code>, set the following values:</p>
<Tabs groupId="nym-network">
    <TabItem value="mainnet" label="Nyx (Mainnet)">
    <pre>
      enable = true in the `[api]` section to get the API server running
    </pre>
  </TabItem>
  <TabItem value="sandbox" label="Sandbox (Testnet)">
    <pre>
      minimum-gas-prices = "0.025unymt" 
    </pre>
    <pre>
      enable = true` in the `[api]` section to get the API server running
    </pre>
  </TabItem>
</Tabs>
<h3 id="setting-up-your-validators-admin-user"><a class="header" href="#setting-up-your-validators-admin-user">Setting up your validator’s admin user</a></h3>
<p>You’ll need an admin account to be in charge of your validator. Set that up with:</p>
<Tabs groupId="nym-network">
    <TabItem value="mainnet" label="Nyx (Mainnet)">
    <pre>
      <code>
      nyxd keys add nyxd-admin
      </code>
    </pre>
  </TabItem>
  <TabItem value="sandbox" label="Sandbox (Testnet)">
    <pre>
      <code>
      nymd keys add nymd-admin
      </code>
    </pre>
  </TabItem>
</Tabs>
<p>This will add keys for your administrator account to your system’s keychain and log your name, address, public key, and mnemonic. As the instructions say, remember to <strong>write down your mnemonic</strong>.</p>
<p>You can get the admin account’s address with:</p>
<Tabs groupId="nym-network">
    <TabItem value="mainnet" label="Nyx (Mainnet)">
    <pre>
      <code>
      nyxd keys show nyxd-admin -a
      </code>
    </pre>
  </TabItem>
  <TabItem value="sandbox" label="Sandbox (Testnet)">
    <pre>
      <code>
      nymd keys show nymd-admin -a
      </code>
    </pre>
  </TabItem>
</Tabs>
<p>Type in your keychain <strong>password</strong>, not the mnemonic, when asked. </p>
<h3 id="starting-your-validator"><a class="header" href="#starting-your-validator">Starting your validator</a></h3>
<p>Everything should now be ready to go. You’ve got the validator set up, all changes made in <code>config.toml</code> and <code>app.toml</code>, the Nym genesis file copied into place (replacing the initial auto-generated one). Now let’s validate the whole setup:</p>
<Tabs groupId="nym-network">
    <TabItem value="mainnet" label="Nyx (Mainnet)">
    <pre>
      <code>
      nyxd validate-genesis
      </code>
    </pre>
  </TabItem>
  <TabItem value="sandbox" label="Sandbox (Testnet)">
    <pre>
      <code>
      nymd validate-genesis
      </code>
    </pre>
  </TabItem>
</Tabs>
<p>If this check passes, you should receive the following output:</p>
<pre><code>File at /path/to/genesis.json is a valid genesis file
</code></pre>
<blockquote>
<p>If this test did not pass, check that you have replaced the contents of <code>/path/to/.nymd/config/genesis.json</code> with that of the correct genesis file.</p>
</blockquote>
<p>Before starting the validator, we will need to open the firewall ports:</p>
<pre><code># if ufw is not already installed:
sudo apt install ufw
sudo ufw enable
sudo ufw allow 1317,26656,26660,22,80,443/tcp
# to check everything worked
sudo ufw status
</code></pre>
<p>Ports <code>22</code>, <code>80</code>, and <code>443</code> are for ssh, http, and https connections respectively. The rest of the ports are documented <a href="https://docs.cosmos.network/v0.42/core/grpc_rest.html">here</a>.</p>
<p>For more information about your validator’s port configuration, check the <a href="nodes/validator-setup.html#validator-port-reference">validator port reference table</a> below.</p>
<blockquote>
<p>If you are planning to use <a href="https://cockpit-project.org/">Cockpit</a> on your validator server then you will have defined a different <code>grpc</code> port in your <code>config.toml</code> above: remember to open this port as well.</p>
</blockquote>
<p>Start the validator:
<Tabs groupId="nym-network">
<TabItem value="mainnet" label="Nyx (Mainnet)">
<pre>
<code>
nyxd start
</code>
</pre>
</TabItem>
<TabItem value="sandbox" label="Sandbox (Testnet)">
<pre>
<code>
nymd start
</code>
</pre>
</TabItem>
</Tabs></p>
<p>Once your validator starts, it will start requesting blocks from other validators. This may take several hours. Once it’s up to date, you can issue a request to join the validator set with the command below. </p>
<blockquote>
<p>If you are having trouble upgrading your validator binary, try replacing (or re-compile) the <code>libwasmvm.so</code> file and replace it on your validator server.</p>
</blockquote>
<div id="admonition-caution-2" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="nodes/validator-setup.html#admonition-caution-2"></a></p>
</div>
<div>
<p>When joining consensus, make sure that you do not disrupt (or worse - halt) the network by coming in with a disproportionately large amount of staked tokens. </p>
<p>Please initially stake a small amount of tokens compared to existing validators, then delegate to yourself in tranches over time.</p>
</div>
</div>
<Tabs groupId="nym-network">
  <TabItem value="mainnet" label="Nyx (Mainnet)">
    <pre>
      nyxd tx staking create-validator
        --amount=10000000unyx
        --fees=0unyx 
        --pubkey=$(/home/youruser/path/to/nyxd/binaries/nyxd tendermint show-validator | jq -r '.["key"]')
        --moniker="whatever you called your validator"
        --chain-id=nyx
        --commission-rate="0.10"
        --commission-max-rate="0.20"
        --commission-max-change-rate="0.01"
        --min-self-delegation="1"
        --gas="auto"
        --gas-adjustment=1.15
        --from="KEYRING_NAME"
        --node https://rpc-1.nyx.nodes.guru:443     
      </pre>
  </TabItem>
  <TabItem value="sandbox" label="Sandbox (Testnet)">
    <pre>
      nymd tx staking create-validator
        --amount=10000000unyxt
        --fees=5000unyxt
        --pubkey=$(/home/youruser/path/to/nym/binaries/nymd tendermint show-validator)
        --moniker="whatever you called your validator"
        --chain-id=nym-sandbox
        --commission-rate="0.10"
        --commission-max-rate="0.20"
        --commission-max-change-rate="0.01"
        --min-self-delegation="1"
        --gas="auto"
        --gas-adjustment=1.15
        --from="KEYRING_NAME"
        --node https://sandbox-validator.nymtech.net:443 
    </pre>
  </TabItem>
</Tabs>
<p>You’ll need either <code>unyxt</code> tokens on Sandbox, or <code>unyx</code> tokens on mainnet to perform this command.</p>
<p>Note: we are currently working towards building up a closed set of reputable validators. You can ask us for coins to get in, but please don’t be offended if we say no - validators are part of our system’s core security and we are starting out with people we already know or who have a solid reputation.</p>
<p>If you want to edit some details for your node you will use a command like this:</p>
<Tabs groupId="nym-network">
  <TabItem value="mainnet" label="Nyx (Mainnet)">
    <pre>
      nymd tx staking edit-validator   
        --chain-id=nym   
        --moniker="whatever you called your validator"
        --details="Nym validator"   
        --security-contact="your email"   
        --identity="your identity"   
        --gas="auto"   
        --gas-adjustment=1.15   
        --from="KEYRING_NAME"
        --fees 2000unyx
    </pre>
  </TabItem>
  <TabItem value="sandbox" label="Sandbox (Testnet)">
    <pre>
      nymd tx staking edit-validator   
        --chain-id=nym-sandbox   
        --moniker="whatever you called your validator"
        --details="Nym validator"   
        --security-contact="your email"   
        --identity="your identity"   
        --gas="auto"   
        --gas-adjustment=1.15   
        --from="KEYRING_NAME"
        --fees 2000unyxt
    </pre>
  </TabItem>
</Tabs>
<p>With above command you can specify the <code>gpg</code> key last numbers (as used in <code>keybase</code>) as well as validator details and your email for security contact. </p>
<h3 id="automating-your-validator-with-systemd"><a class="header" href="#automating-your-validator-with-systemd">Automating your validator with systemd</a></h3>
<p>You will most likely want to automate your validator restarting if your server reboots. Below is a systemd unit file to place at <code>/etc/systemd/system/nymd.service</code>:</p>
<pre><code class="language-ini">[Unit]
Description=Nymd (1.1.0)
StartLimitInterval=350
StartLimitBurst=10

[Service]
User=nym                                                          # change to your user
Type=simple
Environment=&quot;LD_LIBRARY_PATH=/home/youruser/path/to/nym/binaries&quot; # change to correct path
ExecStart=/home/youruser/path/to/nym/binaries/nymd start          # change to correct path
Restart=on-failure
RestartSec=30
LimitNOFILE=infinity

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Proceed to start it with:</p>
<pre><code>systemctl daemon-reload # to pickup the new unit file
systemctl enable nymd   # to enable the service
systemctl start nymd    # to actually start the service
journalctl -f           # to monitor system logs showing the service start
</code></pre>
<h3 id="installing-and-configuring-nginx-for-https"><a class="header" href="#installing-and-configuring-nginx-for-https">Installing and configuring nginx for HTTPS</a></h3>
<h4 id="setup"><a class="header" href="#setup">Setup</a></h4>
<p><a href="https://www.nginx.com/resources/glossary/nginx/#:~:text=NGINX%20is%20open%20source%20software,%2C%20media%20streaming%2C%20and%20more.&amp;text=In%20addition%20to%20its%20HTTP,%2C%20TCP%2C%20and%20UDP%20servers.">Nginx</a> is an open source software used for operating high-performance web servers. It allows us to set up reverse proxying on our validator server to improve performance and security.</p>
<p>Install <code>nginx</code> and allow the ‘Nginx Full’ rule in your firewall:</p>
<pre><code>sudo ufw allow 'Nginx Full'
</code></pre>
<p>Check nginx is running via systemctl:</p>
<pre><code>systemctl status nginx
</code></pre>
<p>Which should return:</p>
<pre><code>● nginx.service - A high performance web server and a reverse proxy server
   Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: enabled)
   Active: active (running) since Fri 2018-04-20 16:08:19 UTC; 3 days ago
     Docs: man:nginx(8)
 Main PID: 2369 (nginx)
    Tasks: 2 (limit: 1153)
   CGroup: /system.slice/nginx.service
           ├─2369 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;
           └─2380 nginx: worker process
</code></pre>
<h4 id="configuration"><a class="header" href="#configuration">Configuration</a></h4>
<p>Proxying your validator’s port <code>26657</code> to nginx port <code>80</code> can then be done by creating a file with the following at <code>/etc/nginx/conf.d/validator.conf</code>:</p>
<pre><code>server {
  listen 80;
  listen [::]:80;
  server_name &quot;{{ domain }}&quot;;

  location / {
    proxy_pass http://127.0.0.1:26657;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  }
}
</code></pre>
<p>Followed by:</p>
<pre><code>sudo apt install certbot nginx python3
certbot --nginx -d nym-validator.yourdomain.com -m you@yourdomain.com --agree-tos --noninteractive --redirect
</code></pre>
<div id="admonition-caution-3" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="nodes/validator-setup.html#admonition-caution-3"></a></p>
</div>
<div>
<p>If using a VPS running Ubuntu 20: replace <code>certbot nginx python3</code> with <code>python3-certbot-nginx</code></p>
</div>
</div>
<p>These commands will get you an https encrypted nginx proxy in front of the API.</p>
<h3 id="configuring-prometheus-metrics-optional"><a class="header" href="#configuring-prometheus-metrics-optional">Configuring Prometheus metrics (optional)</a></h3>
<p>Configure Prometheus with the following commands (adapted from NodesGuru’s <a href="https://nodes.guru/agoric/setup-guide/en">Agoric setup guide</a>):</p>
<pre><code>echo 'export OTEL_EXPORTER_PROMETHEUS_PORT=9464' &gt;&gt; $HOME/.bashrc
source ~/.bashrc
sed -i '/\[telemetry\]/{:a;n;/enabled/s/false/true/;Ta}' $HOME/.nymd/config/app.toml
sed -i &quot;s/prometheus-retention-time = 0/prometheus-retention-time = 60/g&quot; $HOME/.nymd/config/app.toml
sudo ufw allow 9464
echo 'Metrics URL: http://'$(curl -s ifconfig.me)':26660/metrics'
</code></pre>
<p>Your validator’s metrics will be available to you at the returned ‘Metrics URL’.</p>
<details>
  <summary>console output</summary>
<pre><code># HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.
# TYPE go_gc_duration_seconds summary
go_gc_duration_seconds{quantile=&quot;0&quot;} 6.7969e-05
go_gc_duration_seconds{quantile=&quot;0.25&quot;} 7.864e-05
go_gc_duration_seconds{quantile=&quot;0.5&quot;} 8.4591e-05
go_gc_duration_seconds{quantile=&quot;0.75&quot;} 0.000115919
go_gc_duration_seconds{quantile=&quot;1&quot;} 0.001137591
go_gc_duration_seconds_sum 0.356555301
go_gc_duration_seconds_count 2448
# HELP go_goroutines Number of goroutines that currently exist.
# TYPE go_goroutines gauge
go_goroutines 668
# HELP go_info Information about the Go environment.
# TYPE go_info gauge
go_info{version=&quot;go1.15.7&quot;} 1
# HELP go_memstats_alloc_bytes Number of bytes allocated and still in use.
# TYPE go_memstats_alloc_bytes gauge
go_memstats_alloc_bytes 1.62622216e+08
# HELP go_memstats_alloc_bytes_total Total number of bytes allocated, even if freed.
# TYPE go_memstats_alloc_bytes_total counter
go_memstats_alloc_bytes_total 2.09341707264e+11
# HELP go_memstats_buck_hash_sys_bytes Number of bytes used by the profiling bucket hash table.
# TYPE go_memstats_buck_hash_sys_bytes gauge
go_memstats_buck_hash_sys_bytes 5.612319e+06
# HELP go_memstats_frees_total Total number of frees.
# TYPE go_memstats_frees_total counter
go_memstats_frees_total 2.828263344e+09
# HELP go_memstats_gc_cpu_fraction The fraction of this program's available CPU time used by the GC since the program started.
# TYPE go_memstats_gc_cpu_fraction gauge
go_memstats_gc_cpu_fraction 0.03357798610671518
# HELP go_memstats_gc_sys_bytes Number of bytes used for garbage collection system metadata.
# TYPE go_memstats_gc_sys_bytes gauge
go_memstats_gc_sys_bytes 1.3884192e+07
</code></pre>
</details>
<h3 id="setting-the-ulimit-1"><a class="header" href="#setting-the-ulimit-1">Setting the ulimit</a></h3>
<p>Linux machines limit how many open files a user is allowed to have. This is called a <code>ulimit</code>.</p>
<p><code>ulimit</code> is 1024 by default on most systems. It needs to be set higher, because validators make and receive a lot of connections to other nodes.</p>
<p>If you see errors such as:</p>
<pre><code>Failed to accept incoming connection - Os { code: 24, kind: Other, message: &quot;Too many open files&quot; }
</code></pre>
<p>This means that the operating system is preventing network connections from being made.</p>
<h5 id="set-the-ulimit-via-systemd-service-file-1"><a class="header" href="#set-the-ulimit-via-systemd-service-file-1">Set the ulimit via <code>systemd</code> service file</a></h5>
<p>Query the <code>ulimit</code> of your validator with:</p>
<pre><code>grep -i &quot;open files&quot; /proc/$(ps -A -o pid,cmd|grep nymd | grep -v grep |head -n 1 | awk '{print $1}')/limits
</code></pre>
<p>You’ll get back the hard and soft limits, which looks something like this:</p>
<pre><code>Max open files            65536                65536                files
</code></pre>
<p>If your output is <strong>the same as above</strong>, your node will not encounter any <code>ulimit</code> related issues.</p>
<p>However if either value is <code>1024</code>, you must raise the limit via the systemd service file. Add the line:</p>
<pre><code>LimitNOFILE=65536
</code></pre>
<p>Reload the daemon:</p>
<pre><code>systemctl daemon-reload
</code></pre>
<p>or execute this as root for system-wide setting of <code>ulimit</code>:</p>
<pre><code>echo &quot;DefaultLimitNOFILE=65535&quot; &gt;&gt; /etc/systemd/system.conf
</code></pre>
<p>Reboot your machine and restart your node. When it comes back, use <code>cat /proc/$(pidof nym-validator)/limits | grep &quot;Max open files&quot;</code> to make sure the limit has changed to 65535.</p>
<h5 id="set-the-ulimit-on-non-systemd-based-distributions-1"><a class="header" href="#set-the-ulimit-on-non-systemd-based-distributions-1">Set the ulimit on <code>non-systemd</code> based distributions</a></h5>
<p>Edit <code>etc/security/conf</code> and add the following lines:</p>
<pre><code># Example hard limit for max opened files
username        hard nofile 4096
# Example soft limit for max opened files
username        soft nofile 4096
</code></pre>
<p>Then reboot your server and restart your validator.</p>
<h3 id="unjailing-your-validator"><a class="header" href="#unjailing-your-validator">Unjailing your validator</a></h3>
<p>If your validator gets jailed, you can fix it with the following command:</p>
<Tabs groupId="nym-network">
  <TabItem value="mainnet" label="Nyx (Mainnet)">
    <pre>
      nyxd tx slashing unjail 
        --broadcast-mode=block 
        --from="KEYRING_NAME"
        --chain-id=nyx 
        --gas=auto 
        --gas-adjustment=1.4 
        --fees=7000unyx
    </pre>
  </TabItem>
  <TabItem value="sandbox" label="Sandbox (Testnet)">
    <pre>
      nymd tx slashing unjail 
        --broadcast-mode=block 
        --from="KEYRING_NAME"
        --chain-id=nym-sandbox 
        --gas=auto 
        --gas-adjustment=1.4 
        --fees=7000unyxt
    </pre>
  </TabItem>
</Tabs>
<h4 id="common-reasons-for-your-validator-being-jailed"><a class="header" href="#common-reasons-for-your-validator-being-jailed">Common reasons for your validator being jailed</a></h4>
<p>The most common reason for your validator being jailed is that your validator is out of memory because of bloated syslogs.</p>
<p>Running the command <code>df -H</code> will return the size of the various partitions of your VPS.</p>
<p>If the <code>/dev/sda</code> partition is almost full, try pruning some of the <code>.gz</code> syslog archives and restart your validator process.</p>
<h3 id="day-2-operations-with-your-validator"><a class="header" href="#day-2-operations-with-your-validator">Day 2 operations with your validator</a></h3>
<p>You can check your current balances with:</p>
<pre><code>nymd query bank balances ${ADDRESS}
</code></pre>
<p>For example, on the Sanbox testnet this would return:</p>
<pre><code class="language-yaml">balances:
- amount: &quot;919376&quot;
denom: unymt
pagination:
next_key: null
total: &quot;0&quot;
</code></pre>
<p>You can, of course, stake back the available balance to your validator with the following command. </p>
<blockquote>
<p>Remember to save some tokens for gas costs! </p>
</blockquote>
<Tabs groupId="nym-network">
  <TabItem value="mainnet" label="Nyx (Mainnet)">
    <pre>
      nyxd tx staking delegate VALOPERADDRESS AMOUNTunym 
        --from="KEYRING_NAME"
        --keyring-backend=os 
        --chain-id=nyx 
        --gas="auto" 
        --gas-adjustment=1.15 
        --fees 5000unyx
    </pre>
  </TabItem>
  <TabItem value="sandbox" label="Sandbox (Testnet)">
    <pre>
      nymd tx staking delegate VALOPERADDRESS AMOUNTunymt 
        --from="KEYRING_NAME"
        --keyring-backend=os 
        --chain-id=nym-sandbox
        --gas="auto" 
        --gas-adjustment=1.15 
        --fees 5000unyxt
    </pre>
  </TabItem>
</Tabs>
<h3 id="validator-port-reference"><a class="header" href="#validator-port-reference">Validator port reference</a></h3>
<p>All validator-specific port configuration can be found in <code>$HOME/.nymd/config/config.toml</code>. If you do edit any port configs, remember to restart your validator.</p>
<div class="table-wrapper"><table><thead><tr><th>Default port</th><th>Use</th></tr></thead><tbody>
<tr><td>1317</td><td>REST API server endpoint</td></tr>
<tr><td>26656</td><td>Listen for incoming peer connections</td></tr>
<tr><td>26660</td><td>Listen for Prometheus connections</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h1>
<h2 id="binary-build-problems"><a class="header" href="#binary-build-problems">Binary Build Problems</a></h2>
<h3 id="i-am-trying-to-build-from-the-github-archive-files-and-the-build-fails"><a class="header" href="#i-am-trying-to-build-from-the-github-archive-files-and-the-build-fails">I am trying to build from the GitHub archive files and the build fails</a></h3>
<p>GitHub automatically includes .zip and tar.gz files of the Nym repository in its release. You cannot extract these and build - you’ll see something like this:</p>
<pre><code>  process didn't exit successfully: `/build/nym/src/nym-0.12.1/target/release/build/nym-socks5-client-c1d0f76a8c7d7e9a/build-script-build` (exit status: 101)
  --- stderr
  thread 'main' panicked at 'failed to extract build metadata: could not find repository from '/build/nym/src/nym-0.12.1/clients/socks5'; class=Repository (6); code=NotFound (-3)', clients/socks5/build.rs:7:31
  note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
warning: build failed, waiting for other jobs to finish...
error: build failed
</code></pre>
<p>Why does this happen? </p>
<p>We have scripts which automatically include the Git commit hash and Git tag in the binary for easier debugging later. If you download a .zip and try building from that, it’s not a Git repository and build will fail as above.</p>
<h2 id="general-node-config"><a class="header" href="#general-node-config">General Node Config</a></h2>
<h3 id="where-can-i-find-my-private-and-public-keys-and--config"><a class="header" href="#where-can-i-find-my-private-and-public-keys-and--config">Where can I find my private and public keys and  config?</a></h3>
<p>All config and keys files are stored in a directory named after your <code>id</code> which you chose during the <code>init</code> process, and can be found at the following PATH: <code>$HOME/.nym/&lt;NODE_TYPE&gt;/&lt;NODE_ID&gt;</code> where <code>$HOME</code> is a home directory of the user (your current user in this case) that launched the node or client.</p>
<p>The directory structure for each node will be roughly as follows:</p>
<pre><code>bob@nym:~$ tree /home/nym/.nym/mixnodes/
/home/nym/.nym/mixnodes/
|-- nym010
|   |-- config
|   |   `-- config.toml
|   `-- data
|       |-- private_identity.pem
|       |-- private_sphinx.pem
|       |-- public_identity.pem
|       `-- public_sphinx.pem
</code></pre>
<blockquote>
<p>If you <code>cat</code> the <code>public_sphinx.pem key</code>, the output will be different from the public key you will see on Nym <a href="https://sandbox-explorer.nymtech.net/">dashboard</a>. The reason for this is that <code>.pem</code> files are encoded in <strong>base64</strong>, however on the web they are in <strong>base58</strong>. Don’t be confused if your keys look different. They are the same keys, just with different encoding :)</p>
</blockquote>
<h2 id="mix-nodes-1"><a class="header" href="#mix-nodes-1">Mix Nodes</a></h2>
<h3 id="how-can-i-tell-my-node-is-up-and-running-and-mixing-traffic"><a class="header" href="#how-can-i-tell-my-node-is-up-and-running-and-mixing-traffic">How can I tell my node is up and running and mixing traffic?</a></h3>
<p>First of all check the ‘Mixnodes’ section of either the Nym Network Explorers: </p>
<ul>
<li><a href="https://explorer.nymtech.net/overview">Mainnet</a> </li>
<li><a href="https://sandbox-explorer.nymtech.net/">Sandbox testnet</a> </li>
</ul>
<p>Enter your <strong>identity key</strong> to find your node. Check the contents of the ‘mixnode stats’ and ‘uptime story’ sections.</p>
<p>There are 2 community explorers currently, which have been created by <a href="https://nodes.guru">Nodes Guru</a>: </p>
<ul>
<li><a href="https://mixnet.explorers.guru/">Mainnet</a></li>
<li><a href="https://sandbox.mixnet.explorers.guru/">Sandbox testnet</a></li>
</ul>
<p>If you want more information, or if your node isn’t showing up on the explorer of your choice and you want to double-check, here are some examples on how to check if the node is configured properly.</p>
<h4 id="check-from-your-vps"><a class="header" href="#check-from-your-vps">Check from your VPS</a></h4>
<p>Additional details can be obtained via various methods after you connect to your VPS:</p>
<h5 id="socket-statistics-with-ss"><a class="header" href="#socket-statistics-with-ss">Socket statistics with <code>ss</code></a></h5>
<pre><code>sudo ss -s -t | grep 1789 # if you have specified a different port in your mixnode config, change accordingly
</code></pre>
<p>This command should return a lot of data containing <code>ESTAB</code>. This command should work on every unix based system.</p>
<h5 id="list-open-files-and-reliant-processes-with-lsof"><a class="header" href="#list-open-files-and-reliant-processes-with-lsof">List open files and reliant processes with <code>lsof</code></a></h5>
<pre><code># check if lsof is installed:
lsof -v
# install if not installed
sudo apt install lsof
# run against mixnode port
sudo lsof -i TCP:1789 # if you have specified a different port in your mixnode config, change accordingly
</code></pre>
<p>This command should return something like this:</p>
<pre><code>nym-mixno 103349 root   53u  IPv6 1333229972      0t0  TCP [2a03:b0c0:3:d0::ff3:f001]:57844-&gt;[2a01:4f9:c011:38ae::5]:1789 (ESTABLISHED)
nym-mixno 103349 root   54u  IPv4 1333229973      0t0  TCP nym:57104-&gt;194.5.78.73:1789 (ESTABLISHED)
nym-mixno 103349 root   55u  IPv4 1333229974      0t0  TCP nym:48130-&gt;static.236.109.119.168.clients.your-server.de:1789 (ESTABLISHED)
nym-mixno 103349 root   56u  IPv4 1333229975      0t0  TCP nym:52548-&gt;vmi572614.contaboserver.net:1789 (ESTABLISHED)
nym-mixno 103349 root   57u  IPv6 1333229976      0t0  TCP [2a03:b0c0:3:d0::ff3:f001]:43244-&gt;[2600:1f18:1031:2401:c04b:2f25:ca79:fef3]:1789 (ESTABLISHED)
</code></pre>
<h5 id="query-systemd-journal-with-journalctl"><a class="header" href="#query-systemd-journal-with-journalctl">Query <code>systemd</code> journal with <code>journalctl</code></a></h5>
<pre><code>sudo journalctl -u nym-mixnode -o cat | grep &quot;Since startup mixed&quot;
</code></pre>
<p>If you have created <code>nym-mixnode.service</code> file (i.e. you are running your mixnode via <code>systemd</code>) then this command shows you how many packets have you mixed so far, and should return a list of messages like this:</p>
<pre><code>2021-05-18T12:35:24.057Z INFO  nym_mixnode::node::metrics                      &gt; Since startup mixed 233639 packets!
2021-05-18T12:38:02.178Z INFO  nym_mixnode::node::metrics                      &gt; Since startup mixed 233739 packets!
2021-05-18T12:40:32.344Z INFO  nym_mixnode::node::metrics                      &gt; Since startup mixed 233837 packets!
2021-05-18T12:46:08.549Z INFO  nym_mixnode::node::metrics                      &gt; Since startup mixed 234081 packets!
2021-05-18T12:56:57.129Z INFO  nym_mixnode::node::metrics                      &gt; Since startup mixed 234491 packets!
</code></pre>
<p>You can add <code> | tail</code> to the end of the command to watch for new entries in real time if needed.</p>
<h4 id="check-from-your-local-machine"><a class="header" href="#check-from-your-local-machine">Check from your local machine</a></h4>
<h5 id="scan-ports-with-nmap"><a class="header" href="#scan-ports-with-nmap">Scan ports with <code>nmap</code>:</a></h5>
<pre><code>nmap -p 1789 &lt;IP ADDRESS&gt; -Pn
</code></pre>
<p>If your mixnode is configured properly it should output something like this:</p>
<pre><code>bob@desktop:~$ nmap -p 1789 95.296.134.220 -Pn

Host is up (0.053s latency).

PORT     STATE SERVICE
1789/tcp open  hello
</code></pre>
<h5 id="query-online-nodes"><a class="header" href="#query-online-nodes">Query online nodes:</a></h5>
<pre><code>curl --location --request GET 'https://validator.nymtech.net/api/v1/mixnodes/'
</code></pre>
<p>Will return a list all nodes currently online.</p>
<p>You can query gateways by replacing <code>mixnodes</code> with <code>gateways</code> in the above command, and can query for the mixnodes and gatways on the Sandbox testnet by replacing <code>validator</code> with <code>sandbox-validator</code>. </p>
<h4 id="check-with-network-api"><a class="header" href="#check-with-network-api">Check with Network API</a></h4>
<p>We currently have an API set up returning our metrics tests of the network. There are two endpoints to ping for information about your mixnode, <code>report</code> and <code>history</code>. Find more information about this in the <a href="nodes/../nodes/mix-node-setup.html#metrics--api-endpoints">Mixnodes metrics documentation</a>.</p>
<h3 id="why-is-my-node-not-mixing-any-packets"><a class="header" href="#why-is-my-node-not-mixing-any-packets">Why is my node not mixing any packets?</a></h3>
<p>If you are still unable to see your node on the dashboard, or your node is declaring it has not mixed any packets, there are several potential issues:</p>
<ul>
<li>The firewall on your host machine is not configured properly.</li>
<li>You provided incorrect information when bonding your node.</li>
<li>You are running your mixnode from a VPS without IPv6 support.</li>
<li>You did not use the <code>--announce-host</code> flag while running the mixnode from your local machine behind NAT.</li>
<li>You did not configure your router firewall while running the mixnode from your local machine behind NAT, or you are lacking IPv6 support.</li>
<li>Your mixnode is not running at all, it has either exited / panicked or you closed the session without making the node persistent.</li>
</ul>
<div id="admonition-caution" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="nodes/troubleshooting.html#admonition-caution"></a></p>
</div>
<div>
<p>Your mixnode <strong>must speak both IPv4 and IPv6</strong> in order to cooperate with other nodes and route traffic. This is a common reason behind many errors we are seeing among node operators, so check with your provider that your VPS is able to do this!</p>
</div>
</div>
<h4 id="incorrectly-configured-firewall"><a class="header" href="#incorrectly-configured-firewall">Incorrectly configured firewall</a></h4>
<p>The most common reason your mixnode might not be mixing packets is due to a poorly configured firewall. The following commands will allow you to set up a firewall using <code>ufw</code>.</p>
<pre><code># check if you have ufw installed
ufw version
# if it is not installed, install with
sudo apt install ufw -y
# enable ufw
sudo ufw enable
# check the status of the firewall
sudo ufw status
</code></pre>
<p>Finally open your mixnode’s p2p port, as well as ports for ssh, http, and https connections, and ports <code>8000</code> and <code>1790</code> for verloc and measurement pings:</p>
<pre><code>sudo ufw allow 1789,1790,8000,22,80,443/tcp
# check the status of the firewall
sudo ufw status
</code></pre>
<h4 id="incorrect-bonding-information"><a class="header" href="#incorrect-bonding-information">Incorrect bonding information</a></h4>
<p>Check that you have provided the correct information when bonding your mixnode in the web wallet <a href="https://sandbox-wallet.nymtech.net/">interface</a>. When in doubt, unbond and then rebond your node!</p>
<h4 id="missing-announce-host-flag"><a class="header" href="#missing-announce-host-flag">Missing <code>announce-host</code> flag</a></h4>
<p>On certain cloud providers such as AWS and Google Cloud, you need to do some additional configuration of your firewall and use <code>--host</code> with your <strong>local ip</strong> and <code>--announce-host</code> with the <strong>public ip</strong> of your mixnode host.</p>
<h4 id="no-ipv6-connectivity"><a class="header" href="#no-ipv6-connectivity">No IPv6 connectivity</a></h4>
<p>Make sure that your VPS has IPv6 connectivity available with whatever provider you are using.</p>
<p>To get all ip addresses of your host, try following commands:</p>
<pre><code>hostname -i
</code></pre>
<p>Will return your <strong>local ip</strong> address.</p>
<pre><code>hostname -I
</code></pre>
<p>Will return all of the ip addresses of your host. This output should look something like this:</p>
<pre><code>bob@nym:~$ hostname -I
88.36.11.23 172.18.0.1 2a01:28:ca:102::1:641
</code></pre>
<ul>
<li>The first <strong>ipv4</strong> is the public ip you need to use for the <code>--announce-host</code> flag.</li>
<li>The second <strong>ipv4</strong> is the local ip you need to use for the <code>--host</code> flag.</li>
<li>The 3rd output should confirm if your machine has ipv6 available.</li>
</ul>
<h3 id="running-on-a-local-machine-behind-nat-with-no-fixed-ip-address"><a class="header" href="#running-on-a-local-machine-behind-nat-with-no-fixed-ip-address">Running on a local machine behind NAT with no fixed IP address</a></h3>
<p>Your ISP has to be IPv6 ready if you want to run a mixnode on your local machine. Sadly, in 2020, most of them are not and you won’t get an IPv6 address by default from your ISP. Usually it is a extra paid service or they simply don’t offer it.</p>
<p>Before you begin, check if you have IPv6 <a href="https://test-ipv6.cz/">here</a>. If not, then don’t waste your time to run a node which won’t ever be able to mix any packet due to this limitation. Call your ISP and ask for IPv6, there is a plenty of it for everyone!</p>
<p>If all goes well and you have IPv6 available, then you will need to <code>init</code> the mixnode with an extra flag, <code>--announce-host</code>. You will also need to edit your <code>config.toml</code> file each time your IPv4 address changes, that could be a few days or a few weeks.</p>
<p>Additional configuration on your router might also be needed to allow traffic in and out to port 1789 and IPv6 support.</p>
<p>Here is a sample of the <code>init</code> command to create the mixnode config.</p>
<pre><code>./target/release/nym-mixnode init --id nym-nat --host 0.0.0.0 --announce-host 85.160.12.13 --layer 3
</code></pre>
<ul>
<li>
<p><code>--host 0.0.0.0</code> should work everytime even if your local machine IPv4 address changes. For example on Monday your router gives your machine an address <code>192.168.0.13</code> and on Wednesday, the DHCP lease will end and you will be asigned <code>192.168.0.14</code>. Using <code>0.0.0.0</code> should avoid this without having to set any static ip in your router`s configuration.</p>
</li>
<li>
<p>you can get your current IPv4 address by either using <code>curl ipinfo.io</code> if you’re on MacOS or Linux or visiting <a href="https://www.whatsmyip.org/">whatsmyip site</a>. Simply copy it and use it as <code>--anounce-host</code> address.</p>
</li>
</ul>
<p>Make sure you check if your node is really mixing. You will need a bit of luck to set this up from your home behind NAT.</p>
<h3 id="accidentally-killing-your-node-process-on-exiting-session"><a class="header" href="#accidentally-killing-your-node-process-on-exiting-session">Accidentally killing your node process on exiting session</a></h3>
<p>When you close your current terminal session, you need to make sure you don’t kill the mixnode process! There are multiple ways on how to make it persistent even after exiting your ssh session, the easiest solution is to use <code>nohup</code>, and the more elegant solution is to run the node with <code>systemd</code>.</p>
<h3 id="running-your-mixnode-as-a-background-process-with-nohup"><a class="header" href="#running-your-mixnode-as-a-background-process-with-nohup">Running your mixnode as a background process with <code>nohup</code></a></h3>
<p><code>nohup</code> is a command with which your terminal is told to ignore the <code>HUP</code> or ‘hangup’ signal. This will stop the mixnode process ending if you kill your session.</p>
<pre><code>nohup ./nym-mixnode run --id NYM # where `--id NYM` is the id you set during the `init` command.
</code></pre>
<h3 id="running-your-mixnode-as-a-background-process-with-systemd"><a class="header" href="#running-your-mixnode-as-a-background-process-with-systemd">Running your mixnode as a background process with <code>systemd</code></a></h3>
<p>The most reliable and elegant solution is to create a <code>systemd.service</code> file and run the nym-mixnode with <code>systemctl</code> command.</p>
<p>Create a file with <code>nano</code> at <code>/etc/systemd/system/nym-mixnode.service</code> containing the following:</p>
<pre><code class="language-ini">[Unit]
Description=nym mixnode service
After=network.target

[Service]
Type=simple
User=nym                                      # change as appropriate
LimitNOFILE=65536
ExecStart=/home/nym/nym-mixnode run --id nym  # change as appropriate
KillSignal=SIGINT
Restart=on-failure
RestartSec=30
Restart=on-abort
[Install]
WantedBy=multi-user.target
</code></pre>
<pre><code># enable the service
sudo systemctl enable nym-mixnode
# start the service
sudo systemctl start nym-mixnode
# check if the service is running properly and mixnode is mixing
sudo systemctl status nym-mixnode
</code></pre>
<p>Now your node should be mixing all the time, and restart if you reboot your server!</p>
<p>Anytime you change your <code>systemd</code> service file you need to <code>sudo systemctl daemon-reload</code> in order to restart the service.</p>
<h3 id="network-configuration-seems-fine-but-log-still-claims-since-startup-mixed-0-packets"><a class="header" href="#network-configuration-seems-fine-but-log-still-claims-since-startup-mixed-0-packets">Network configuration seems fine but log still claims <code>Since startup mixed 0 packets!</code></a></h3>
<p>This behavior is most likely caused by a mismatch between your node configuration and the bonding information. Unbond and then rebond your node.</p>
<p>Also make sure to enter all the information in the web wallet exactly as it appears in the log when you start the mixnode process. In particular, the <code>host</code> field must contain the <em>port</em> on which your mixnode will listen:</p>
<ul>
<li>correct host: <code>34.12.3.43:1789</code></li>
<li>incorrect host:<code>34.12.3.43</code></li>
</ul>
<h3 id="common-errors-and-warnings"><a class="header" href="#common-errors-and-warnings">Common errors and warnings</a></h3>
<p>Most of the <code>ERROR</code> and <code>WARN</code> messages in your node logs are benign - as long as your node outputs <code>since startup mixed X packets!</code> in your logs (and this number increases over time), your node is mixing packets. If you want to be sure, check the Nym <a href="https://sandbox-explorer.nymtech.net/">dashboard</a> or see other ways on how to check if your node is mixing properly as outlined in the section <strong>How can I tell my node is up and running and mixing traffic?</strong> above.</p>
<p>More specific errors and warnings are covered below.</p>
<h4 id="tokio-runtime-worker-error"><a class="header" href="#tokio-runtime-worker-error"><code>tokio runtime worker</code> error</a></h4>
<p>If you are running into issues with an error including the following:</p>
<pre><code>thread 'tokio-runtime-worker' panicked at 'Failed to create TCP listener: Os { code: 99, kind: AddrNotAvailable, message: &quot;Cannot assign requested address&quot; }'
</code></pre>
<p>Then you need to <code>--announce-host &lt;public ip&gt;</code> and ``–host <local ip>` on startup. This issue arises because of your use of a provider like AWS or Google Cloud, and the fact that your VPS’ available bind address is not the same as the public IP address (see <a href="nodes/../nodes/mix-node-setup.html#virtual-ips-and-hosting-via-google--aws">Virtual IPs and hosting via Google and AWS</a> for more information on this issue).</p>
<h4 id="rocketlaunch-warnings"><a class="header" href="#rocketlaunch-warnings"><code>rocket::launch</code> warnings</a></h4>
<p>These warnings are not an issue, please ignore them. Rocket is a web framework for rust which we are using to provide mixnodes with <code>/verloc</code> and <code>/description</code> http APIs.</p>
<p>Find more information about this in the <a href="nodes/../nodes/mix-node-setup.html#metrics--api-endpoints">Mixnodes metrics documentation</a>.</p>
<p>Rocket runs on port <code>8000</code> by default. Although at this stage of the testnet we need Rocket to be reachable via this port, in the future customization of the particular port it uses will be possible.</p>
<h4 id="failed-to-receive-reply-to-our-echo-packet-within-15s-stopping-the-test"><a class="header" href="#failed-to-receive-reply-to-our-echo-packet-within-15s-stopping-the-test"><code>failed to receive reply to our echo packet within 1.5s. Stopping the test</code></a></h4>
<p>This relates to the VerLoc implementation that appeared in <code>0.10.1</code>, which has a particularly high log sensitivity. This warning means that the echo packet sent to the mixnode was received, but not sent back. <em>This will not affect the rate of rewards or performance metrics of your mixnode in the testnet at this point.</em></p>
<h4 id="connection-to-ip1789-seems-to-be-dead"><a class="header" href="#connection-to-ip1789-seems-to-be-dead"><code>Connection to &lt;IP&gt;:1789 seems to be dead</code></a></h4>
<p>This warning is normal at the moment, and is <em>nothing to do with your mixnode!</em> It is simply a warning that your node is unable to connect to other peoples’ mixnodes for some reason, most likely because they are offline or poorly configured.</p>
<h3 id="can-i-use-a-port-other-than-1789-"><a class="header" href="#can-i-use-a-port-other-than-1789-">Can I use a port other than 1789 ?</a></h3>
<p>Yes! Here is what you will need to do:</p>
<p>Assuming you would like to use port <code>1337</code> for your mixnode, you need to open the new port (and close the old one):</p>
<pre><code>sudo ufw allow 1337
sudo ufw deny 1789
</code></pre>
<p>And then edit the mixnode’s config.</p>
<blockquote>
<p>If you want to change the port for an already running node, you need to stop the process before editing your config file.</p>
</blockquote>
<p>Assuming your node name is <code>nym</code>, the config file is located at <code>~/.nym/mixnodes/nym/config/config.toml</code>.</p>
<pre><code>nano ~/.nym/mixnodes/nym/config/config.toml
</code></pre>
<p>You will need to edit two parts of the file. <code>announce_address</code> and <code>listening_address</code> in the config.toml file. Simply replace <code>:1789</code> (the default port) with <code>:1337</code> (your new port) after your IP address.</p>
<p>Finally, restart your node. You should see if the mixnode is using the port you have changed in the config.toml file right after you run the node.</p>
<h3 id="what-is-verloc-and-do-i-have-to-configure-my-mixnode-to-implement-it"><a class="header" href="#what-is-verloc-and-do-i-have-to-configure-my-mixnode-to-implement-it">What is <code>verloc</code> and do I have to configure my mixnode to implement it?</a></h3>
<p><code>verloc</code> is short for <em>verifiable location</em>. Mixnodes and gateways now measure speed-of-light distances to each other, in an attempt to verify how far apart they are. In later releases, this will allow us to algorithmically verify node locations in a non-fakeable and trustworthy manner.</p>
<p>You don’t have to do any additional configuration for your node to implement this, it is a passive process that runs in the background of the mixnet from version <code>0.10.1</code> onwards.</p>
<h3 id="where-can-i-get-more-help"><a class="header" href="#where-can-i-get-more-help">Where can I get more help?</a></h3>
<p>The fastest way to reach one of us or get a help from the community, visit our <a href="https://t.me/nymchan_help_chat">Telegram help chat</a> or head to our <a href="https://Discord.gg/nym">Discord</a></p>
<p>For more tech heavy questions join our Keybase channel. Get Keybase <a href="https://keybase.io/">here</a>, then click Teams -&gt; Join a team. Type nymtech.friends into the team name and hit continue. For general chat, hang out in the #general channel. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="clients-overview"><a class="header" href="#clients-overview">Clients Overview</a></h1>
<p>A large proportion of the Nym mixnet’s functionality is implemented client-side. </p>
<p>Clients perform the following actions on behalf of users: </p>
<ul>
<li>determine network topology - what mixnodes exist, what their keys are, etc.</li>
<li>register with a gateway</li>
<li>authenticate with a gateway</li>
<li>receive and decrypt messages from the gateway</li>
<li>create layer-encrypted Sphinx packets</li>
<li>send Sphinx packets with real messages</li>
<li>send Sphinx packet <em>cover traffic</em> when no real messages are being sent</li>
<li>retransmit un-acknowledged packet sends - if a client sends 100 packets to a gateway, but only receives an acknowledgement (‘ack’) for 95 of them, it will resend those 5 packets to the gateway again, to make sure that all packets are received.</li>
</ul>
<h2 id="types-of-nym-clients"><a class="header" href="#types-of-nym-clients">Types of Nym clients</a></h2>
<p>At present, there are three Nym clients:</p>
<ul>
<li>the websocket (native) client</li>
<li>the SOCKS5 client</li>
<li>the wasm (webassembly) client</li>
</ul>
<p>You need to choose which one you want incorporate into your app. Which one you use will depend largely on your preferred programming style and the purpose of your app.</p>
<h3 id="the-websocket-client"><a class="header" href="#the-websocket-client">The websocket client</a></h3>
<p>Your first option is the native websocket client (<code>nym-client</code>). This is a compiled program that can run on Linux, Mac OS X, and Windows machines. It runs as a persistent process on a desktop or server machine. You can connect to it with <strong>any language that supports websockets</strong>.</p>
<h3 id="the-webassembly-client"><a class="header" href="#the-webassembly-client">The webassembly client</a></h3>
<p>If you’re working in JavaScript or Typescript in the browser, or building an <a href="https://en.wikipedia.org/wiki/Edge_computing">edge computing</a> app, you’ll likely want to choose the webassembly client. </p>
<p>It’s packaged and <a href="https://www.npmjs.com/package/@nymproject/nym-client-wasm">available on the npm registry</a>, so you can <code>npm install</code> it into your JavaScript or TypeScript application. </p>
<p>The webassembly client is most easily used via the <a href="clients/../sdk/typescript.html">sdk</a>. </p>
<h3 id="the-socks5-client"><a class="header" href="#the-socks5-client">The SOCKS5 client</a></h3>
<p>This client (<code>nym-socks5-client</code>) is useful for allowing existing applications to use the Nym mixnet without any code changes. All that’s necessary is that they can use one of the SOCKS5, SOCKS4a, or SOCKS4 proxy protocols (which many applications can - crypto wallets, browsers, chat applications etc). </p>
<p>It’s less flexible as a way of writing custom applications than the other clients, but able to be used to proxy application traffic through the mixnet without having to make any code changes. </p>
<h2 id="commonalities-between-clients"><a class="header" href="#commonalities-between-clients">Commonalities between clients</a></h2>
<p>All Nym client packages present basically the same capabilities to the privacy application developer. They need to run as a persistent process in order to stay connected and ready to receive any incoming messages from their gateway nodes. They register and authenticate to gateways, and encrypt Sphinx packets.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="websocket-client"><a class="header" href="#websocket-client">Websocket Client</a></h1>
<blockquote>
<p>The Nym Websocket Client was built in the <a href="clients/../binaries/building-nym.html">building nym</a> section. If you haven’t yet built Nym and want to run the code on this page, go there first.</p>
</blockquote>
<h2 id="client-setup"><a class="header" href="#client-setup">Client setup</a></h2>
<h3 id="viewing-command-help-2"><a class="header" href="#viewing-command-help-2">Viewing command help</a></h3>
<p>You can check that your binaries are properly compiled with:</p>
<pre><code>./nym-client --help
</code></pre>
<details id="admonition-console-output" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="clients/websocket-client.html#admonition-console-output"></a></p>
</summary>
<div>
<pre><code>
      _ __  _   _ _ __ ___
     | '_ \| | | | '_ \ _ \
     | | | | |_| | | | | | |
     |_| |_|\__, |_| |_| |_|
            |___/

             (client - version 1.1.4)

    
      nym-client 1.1.4
      Nymtech
      Implementation of the Nym Client

      USAGE:
          nym-client [OPTIONS] &lt;SUBCOMMAND&gt;

      OPTIONS:
              --config-env-file &lt;CONFIG_ENV_FILE&gt;
                  Path pointing to an env file that configures the client

          -h, --help
                  Print help information

          -V, --version
                  Print version information

      SUBCOMMANDS:
          completions          Generate shell completions
          generate-fig-spec    Generate Fig specification
          help                 Print this message or the help of the given subcommand(s)
          init                 Initialise a Nym client. Do this first!
          run                  Run the Nym client with provided configuration client optionally
                                  overriding set parameters
          upgrade              Try to upgrade the client


</code></pre>
</div>
</details>
<p>The two most important commands you will issue to the client are: </p>
<ul>
<li><code>init</code> - initalise a new client instance. </li>
<li><code>run</code> - run a mixnet client process. </li>
</ul>
<p>You can check the necessary parameters for the available commands by running:</p>
<pre><code>./nym-client &lt;command&gt; --help 
</code></pre>
<h3 id="initialising-your-client"><a class="header" href="#initialising-your-client">Initialising your client</a></h3>
<p>Before you can use the client, you need to initalise a new instance of it. Each instance of the client has its own public/private keypair, and connects to its own gateway node. Taken together, these 3 things (public/private keypair + gateway node) make up an app’s identity.</p>
<p>Initialising a new client instance can be done with the following command:</p>
<pre><code>./nym-client init --id &lt;client_id&gt; 
</code></pre>
<details id="admonition-console-output-1" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="clients/websocket-client.html#admonition-console-output-1"></a></p>
</summary>
<div>
<pre><code>      Initialising client...
      Saved all generated keys
      Saved configuration file to &quot;/home/mx/.nym/clients/client/config/config.toml&quot;
      Using gateway: BNjYZPxzcJwczXHHgBxCAyVJKxN6LPteDRrKapxWmexv
      Client configuration completed.




      The address of this client is: 7bxykcEH1uGNMr8mxGABvLJA44nbYt6Rp7xXHhJ4wQVk.HpnFbaMJ8NN1cp5ZPdPTc2GoBDnG4Jd51Sti32tbf3tF@BNjYZPxzcJwczXHHgBxCAyVJKxN6LPteDRrKapxWmexv

</code></pre>
</div>
</details>
<p>The <code>--id</code> in the example above is a local identifier so that you can name your clients; it is <strong>never</strong> transmitted over the network.</p>
<p>There is an optional <code>--gateway</code> flag that you can use if you want to use a specific gateway. The supplied argument is the <code>Identity Key</code> of the gateway you wish to use, which can be found on the <a href="https://explorer.nymtech.net/network-components/gateways">mainnet Network Explorer</a> or <a href="https://sandbox-explorer.nymtech.net/network-components/gateways">Sandbox Testnet Explorer</a> depending on which network you are on. </p>
<p>Not passing this argument will randomly select a gateway for your client.</p>
<h3 id="configuring-your-client"><a class="header" href="#configuring-your-client">Configuring your client</a></h3>
<p>When you initalise a client instance, a configuration directory will be generated and stored in <code>$HOME_DIR/.nym/clients/&lt;client-name&gt;/</code>.</p>
<pre><code>/home/&lt;user&gt;/.nym/clients/&lt;client_id&gt;/
├── config
│   └── config.toml
└── data
    ├── private_identity.pem
    └── public_identity.pem
</code></pre>
<p>The <code>config.toml</code> file contains client configuration options, while the two <code>pem</code> files contain client key information.</p>
<p>The generated files contain the client name, public/private keypairs, and gateway address. The name <code>&lt;client_id&gt;</code> in the example above is just a local identifier so that you can name your clients.</p>
<h3 id="running-your-client"><a class="header" href="#running-your-client">Running your client</a></h3>
<p>You can run the initalised client by doing this:</p>
<pre><code>./nym-client run --id &lt;client_id&gt;
</code></pre>
<p>When you run the client, it immediately starts generating (fake) cover traffic and sending it to the mixnet.</p>
<p>When the client is first started, it will reach out to the Nym network’s validators, and get a list of available Nym nodes (gateways, mixnodes, and validators). We call this list of nodes the network <em>topology</em>. The client does this so that it knows how to connect, register itself with the network, and know which mixnodes it can route Sphinx packets through.</p>
<h2 id="using-your-client"><a class="header" href="#using-your-client">Using your client</a></h2>
<h3 id="connecting-to-the-local-websocket"><a class="header" href="#connecting-to-the-local-websocket">Connecting to the local websocket</a></h3>
<p>The Nym native client exposes a websocket interface that your code connects to. To program your app, choose a websocket library for whatever language you’re using. The <strong>default</strong> websocket port is <code>1977</code>, you can override that in the client config if you want.</p>
<p>The Nym monorepo includes websocket client example code for Rust, Go, Javacript, and Python, all of which can be found <a href="https://github.com/nymtech/nym/tree/develop/clients/native/examples">here</a></p>
<blockquote>
<p>Rust users can run the examples with <code>cargo run --example &lt;rust_file&gt;.rs</code>, as the examples are not organised in the same way as the other examples, due to already being inside a Cargo project. </p>
</blockquote>
<p>All of these code examples will do the following: </p>
<ul>
<li>connect to a running websocket client on port <code>1977</code></li>
<li>format a message to send in either JSON or Binary format. Nym messages have defined JSON formats.</li>
<li>send the message into the websocket. The native client packages the message into a Sphinx packet and sends it to the mixnet</li>
<li>wait for confirmation that the message hit the native client</li>
<li>wait to receive messages from other Nym apps</li>
</ul>
<p>By varying the message content, you can easily build sophisticated service provider apps. For example, instead of printing the response received from the mixnet, your service provider might take some action on behalf of the user - perhaps initiating a network request, a blockchain transaction, or writing to a local data store.</p>
<blockquote>
<p>You can find an example of building both frontend and service provider code with the websocket client in the [Simple Service Provider Tutorial](FILL IN) in the Developer Portal. </p>
</blockquote>
<h3 id="message-types"><a class="header" href="#message-types">Message Types</a></h3>
<p>There are a small number of messages that your application sends up the websocket to interact with the native client, as follows.</p>
<h4 id="sending-text"><a class="header" href="#sending-text">Sending text</a></h4>
<p>If you want to send text information through the mixnet, format a message like this one and poke it into the websocket:</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;send&quot;,
  &quot;message&quot;: &quot;the message&quot;,
  &quot;recipient&quot;: &quot;71od3ZAupdCdxeFNg8sdonqfZTnZZy1E86WYKEjxD4kj@FWYoUrnKuXryysptnCZgUYRTauHq4FnEFu2QGn5LZWbm&quot;
}
</code></pre>
<p>In some applications, e.g. where people are chatting with friends who they know, you might want to include unencrypted reply information in the message field. This provides an easy way for the receiving chat to then turn around and send a reply message:</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;send&quot;,
  &quot;message&quot;: {
    &quot;sender&quot;: &quot;198427b63ZAupdCdxeFNg8sdonqfZTnZZy1E86WYKEjxD4kj@FWYoUrnKuXryysptnCZgUYRTauHq4FnEFu2QGn5LZWbm&quot;,
    &quot;chatMessage&quot;: &quot;hi julia!&quot;
  },
  &quot;recipient&quot;: &quot;71od3ZAupdCdxeFNg8sdonqfZTnZZy1E86WYKEjxD4kj@FWYoUrnKuXryysptnCZgUYRTauHq4FnEFu2QGn5LZWbm&quot;
}
</code></pre>
<p>If that fits your security model, good. However, it may be the case that you want to send <strong>anonymous replies using Single Use Reply Blocks (SURBs)</strong>.</p>
<pre><code class="language-json">{
    &quot;type&quot;: &quot;send&quot;, 
    &quot;message&quot;: &quot;something you want to keep secret&quot;
    &quot;recipient&quot;: &quot;71od3ZAupdCdxeFNg8sdonqfZTnZZy1E86WYKEjxD4kj@FWYoUrnKuXryysptnCZgUYRTauHq4FnEFu2QGn5LZWbm&quot;
    &quot;withReplySurb&quot;: &quot;true&quot;
}
</code></pre>
<p>You can read more about SURBs <a href="clients/../architecture/traffic-flow.html#private-replies-using-surbs">here</a> but in short they are ways for the receiver of this message to anonymously reply to you - the sender - without them having to know your nym address. </p>
<h4 id="sending-binary-data"><a class="header" href="#sending-binary-data">Sending binary data</a></h4>
<p>You can also send bytes instead of JSON. For that you have to send a binary websocket frame containing a binary encoded
Nym <a href="https://github.com/nymtech/nym/blob/develop/clients/native/websocket-requests/src/requests.rs#L25"><code>ClientRequest</code></a> containing the same information. </p>
<p>As a response the <code>native-client</code> will send a <code>ServerResponse</code> to be decoded. </p>
<p>You can find examples of sending and receiving binary data in the Rust, Python and Go <a href="https://github.com/nymtech/nym/tree/develop/clients/native/examples">code examples</a>, and an example project from the Nym community <a href="https://github.com/sgeisler/btcbc-rs/">BTC-BC</a>: Bitcoin transaction transmission via Nym, a client and service provider written in Rust.</p>
<h4 id="receiving-messages"><a class="header" href="#receiving-messages">Receiving messages</a></h4>
<p>When another PEAP sends a message to you, all extraneous information is stripped and you just get the message. So if an app sends the following message:</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;send&quot;,
  &quot;message&quot;: &quot;2 + 2 = 4&quot;,
  &quot;recipient_address&quot;: &quot;71od3ZAupdCdxeFNg8sdonqfZTnZZy1E86WYKEjxD4kj@FWYoUrnKuXryysptnCZgUYRTauHq4FnEFu2QGn5LZWbm&quot;
}
</code></pre>
<p>The receiving user will get only <code>2 + 2 = 4</code>.</p>
<h4 id="getting-your-own-address"><a class="header" href="#getting-your-own-address">Getting your own address</a></h4>
<p>Sometimes, when you start your app, it can be convenient to ask the native client to tell you what your own address is (from the saved configuration files). To do this, send:</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;selfAddress&quot;
}
</code></pre>
<p>You’ll get back:</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;selfAddress&quot;,
  &quot;address&quot;: &quot;the-address&quot;
}
</code></pre>
<h4 id="error-messages"><a class="header" href="#error-messages">Error messages</a></h4>
<p>Errors from the app’s client, or from the gateway, will be sent down the websocket to your code in the following format:</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;error&quot;,
  &quot;message&quot;: &quot;string message&quot;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="socks5-client"><a class="header" href="#socks5-client">Socks5 Client</a></h1>
<blockquote>
<p>The Nym socks5 client was built in the <a href="clients//docs/next/run-nym-nodes/build-nym/">building nym</a> section. If you haven’t yet built Nym and want to run the code on this page, go there first.</p>
</blockquote>
<p>Many existing applications are able to use either the SOCKS4, SOCKS4A, or SOCKS5 proxy protocols. If you want to send such an application’s traffic through the mixnet, you can use the <code>nym-socks5-client</code> to bounce network traffic through the Nym network, like this:</p>
<p>&lt;ThemedImage
alt=“Overview diagram of the Nym network”
sources={{
light: useBaseUrl(‘/img/docs/nym-socks5-architecture.png’),
dark: useBaseUrl(‘/img/docs/nym-socks5-architecture-dark.png’),
}}
/&gt;</p>
<p>There are 2 pieces of software that work together to send SOCKS traffic through the mixnet: the <code>nym-socks5-client</code>, and the <code>nym-network-requester</code>. </p>
<p>The <code>nym-socks5-client</code> allows you to do the following from your local machine:</p>
<ul>
<li>Take a TCP data stream from a application that can send traffic via SOCKS5. </li>
<li>Chop up the TCP stream into multiple Sphinx packets, assigning sequence numbers to them, while leaving the TCP connection open for more data</li>
<li>Send the Sphinx packets through the mixnet to a <a href="clients//docs/next/run-nym-nodes/nodes/requester">Nym Network Requester</a>. Packets are shuffled and mixed as they transit the mixnet.</li>
</ul>
<p>The <code>nym-network-requester</code> then reassembles the original TCP stream using the packets’ sequence numbers, and make the intended request. It will then chop up the response into Sphinx packets and send them back through the mixnet to your  <code>nym-socks5-client</code>. The application will then receive its data, without even noticing that it wasn’t talking to a “normal” SOCKS5 proxy!</p>
<h2 id="client-setup-1"><a class="header" href="#client-setup-1">Client setup</a></h2>
<h3 id="viewing-command-help-3"><a class="header" href="#viewing-command-help-3">Viewing command help</a></h3>
<p>You can check that your binaries are properly compiled with:</p>
<pre><code>./nym-socks5-client --help
</code></pre>
<details id="admonition-console-output" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="clients/socks5-client.html#admonition-console-output"></a></p>
</summary>
<div>
<hr />
<pre><code>    | '_ \| | | | '_ \ _ \
    | | | | |_| | | | | | |
    |_| |_|\__, |_| |_| |_|
            |___/

            (socks5 proxy - version 1.1.4)


    nym-socks5-client 1.1.4
    Nymtech
    A SOCKS5 localhost proxy that converts incoming messages to Sphinx and sends them to a Nym address

    USAGE:
    nym-socks5-client [OPTIONS] &lt;SUBCOMMAND&gt;

    OPTIONS:
            --config-env-file &lt;CONFIG_ENV_FILE&gt;
            Path pointing to an env file that configures the client

    -h, --help
            Print help information

    -V, --version
            Print version information

    SUBCOMMANDS:
    completions          Generate shell completions
    generate-fig-spec    Generate Fig specification
    help                 Print this message or the help of the given subcommand(s)
    init                 Initialise a Nym client. Do this first!
    run                  Run the Nym client with provided configuration client optionally
                            overriding set parameters
    upgrade              Try to upgrade the client
</code></pre>
</div>
</details>
<p>You can check the necessary parameters for the available commands by running:</p>
<pre><code>./nym-client &lt;command&gt; --help 
</code></pre>
<h3 id="initialising-a-new-client-instance"><a class="header" href="#initialising-a-new-client-instance">Initialising a new client instance</a></h3>
<p>Before you can use the client, you need to initalise a new instance of it, which can be done with the following command:</p>
<pre><code>./nym-socks5-client init --id &lt;id&gt; --provider &lt;provider&gt;
</code></pre>
<p>The <code>--id</code> in the example above is a local identifier so that you can name your clients; it is <strong>never</strong> transmitted over the network.</p>
<p>The <code>--provider</code> field needs to be filled with the Nym address of a Network Requester that can make network requests on your behalf. If you can’t find one from the community, you’ll have to <a href="clients//docs/next/run-nym-nodes/nodes/requester">run your own</a>. A nicer way of discovering public Service Providers is incoming, but at the moment just ask around in community channels and someone will give you an address to use. </p>
<div id="admonition-caution" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="clients/socks5-client.html#admonition-caution"></a></p>
</div>
<div>
<p>Please note that the <code>nym-socks5-client</code> currently <strong>does not</strong> have <a href="clients//docs/next/architecture/traffic-flow#private-replies-using-surbs">multiSURBs</a> enabled by default to allow for a non-breaking network update, allowing network requesters to update to <code>v1.1.4</code>. This should be enabled in the next release once requesters have had time to update without interrupting network services. </p>
<p>If you <strong>know</strong> that your client is communicating with a network requester which is &gt;= <code>v1.1.4</code> then <code>init</code> your <code>nym-socks5-client</code> binary with the <code>--use-anonymous-sender-tag</code> flag like so: </p>
<pre><code>./nym-socks5-client init --id &lt;id&gt; --provider &lt;provider&gt; --use-anonymous-sender-tag
</code></pre>
</div>
</div>
<h3 id="running-the-socks5-client"><a class="header" href="#running-the-socks5-client">Running the socks5 client</a></h3>
<p>You can run the initalised client by doing this:</p>
<pre><code>./nym-socks5-client run --id &lt;id&gt;
</code></pre>
<details id="admonition-console-output-1" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="clients/socks5-client.html#admonition-console-output-1"></a></p>
</summary>
<div>
<pre><code>2022-04-27T16:15:45.843Z INFO  nym_socks5_client::client &gt; Starting nym client
2022-04-27T16:15:45.889Z INFO  nym_socks5_client::client &gt; Obtaining initial network topology
2022-04-27T16:15:51.470Z INFO  nym_socks5_client::client &gt; Starting topology refresher...
2022-04-27T16:15:51.470Z INFO  nym_socks5_client::client &gt; Starting received messages buffer controller...
2022-04-27T16:15:51.648Z INFO  gateway_client::client    &gt; Claiming more bandwidth for your tokens. This will use 1 token(s) from your wallet. Stop the process now if you don't want that to happen.
2022-04-27T16:15:51.648Z WARN  gateway_client::client    &gt; Not enough bandwidth. Trying to get more bandwidth, this might take a while
2022-04-27T16:15:51.648Z INFO  gateway_client::client    &gt; The client is running in disabled credentials mode - attempting to claim bandwidth without a credential
2022-04-27T16:15:51.706Z INFO  nym_socks5_client::client &gt; Starting mix traffic controller...
2022-04-27T16:15:51.706Z INFO  nym_socks5_client::client &gt; Starting real traffic stream...
2022-04-27T16:15:51.706Z INFO  nym_socks5_client::client &gt; Starting loop cover traffic stream...
2022-04-27T16:15:51.707Z INFO  nym_socks5_client::client &gt; Starting socks5 listener...
2022-04-27T16:15:51.707Z INFO  nym_socks5_client::socks::server &gt; Listening on 127.0.0.1:1080
2022-04-27T16:15:51.707Z INFO  nym_socks5_client::client&gt; Client startup finished!
2022-04-27T16:15:51.707Z INFO  nym_socks5_client::client&gt; The address of this client is: BFKhbyNsSVwbsGSLwHDkfwH5mwZqZYpnpNjjV7Xo25Xc.EFWd1geWspzyVeinwXrY5fCBMRtAKV1QmK1CNFhAA8VG@BNjYZPxzcJwczXHHgBxCAyVJKxN6LPteDRrKapxWmexv
2022-04-27T16:15:51.707Z INFO  nym_socks5_client::socks::server &gt; Serving Connections...
</code></pre>
</div>
</details>
<h2 id="using-your-socks5-client"><a class="header" href="#using-your-socks5-client">Using your Socks5 Client</a></h2>
<p>After completing the steps above, your local Socks5 Client will be listening on <code>localhost:1080</code> ready to proxy traffic to the Network Requester set as the <code>--provider</code> when initialising. </p>
<p>When trying to connect your app, generally the proxy settings are found in <code>settings-&gt;advanced</code> or <code>settings-&gt;connection</code>. </p>
<p>Here is an example of setting the proxy connecting in Blockstream Green:</p>
<p><img src="clients//img/docs/wallet-proxy-settings/blockstream-green.gif" alt="Blockstream Green settings" /></p>
<p>Most wallets and other applications will work basically the same way: find the network proxy settings, enter the proxy url (host: <strong>localhost</strong>, port: <strong>1080</strong>).</p>
<p>In some other applications, this might be written as <strong>localhost:1080</strong> if there’s only one proxy entry field.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="webassembly-client"><a class="header" href="#webassembly-client">Webassembly Client</a></h1>
<p>The Nym webassembly client allows any webassembly-capable runtime to build and send Sphinx packets to the Nym network, for uses in edge computing and browser-based applications. </p>
<p>This is currently packaged and distributed for ease of use via the <a href="clients/../sdk/typescript.html">Nym Typescript SDK library</a>. </p>
<p>The webassembly client allows for the easy creation of Sphinx packets from within mobile apps and browser-based client-side apps (including Electron or similar). </p>
<h2 id="building-apps-with-nym-client-wasm"><a class="header" href="#building-apps-with-nym-client-wasm">Building apps with nym-client-wasm</a></h2>
<p>Check out the <a href="clients/../sdk/typescript.html#using-the-sdk">examples section</a> of the SDK docs for examples of simple application framework setups. There are also two example applications located in the <code>clients/webassembly</code> directory in the main Nym platform codebase. The <code>js-example</code> is a simple, bare-bones JavaScript app. </p>
<h2 id="think-about-what-youre-sending"><a class="header" href="#think-about-what-youre-sending">Think about what you’re sending!</a></h2>
<div id="admonition-caution" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="clients/webassembly-client.html#admonition-caution"></a></p>
</div>
<div>
<p>Think about what information your app sends. That goes for whatever you put into your Sphinx packet messages as well as what your app’s environment may leak.</p>
</div>
</div>
<p>Whenever you write client PEAPs using HTML/JavaScript, we recommend that you do not load external resources from CDNs. Webapp developers do this all the time, to save load time for common resources, or just for convenience. But when you’re writing privacy apps it’s better not to make these kinds of requests. Pack everything locally.</p>
<p>If you use only local resources within your Electron app or your browser extensions, explicitly encoding request data in a Sphinx packet does protect you from the normal leakage that gets sent in a browser HTTP request. <a href="https://panopticlick.eff.org/">There’s a lot of stuff that leaks when you make an HTTP request from a browser window</a>. Luckily, all that metadata and request leakage doesn’t happen in Nym, because you’re choosing very explicitly what to encode into Sphinx packets, instead of sending a whole browser environment by default.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="addressing-system"><a class="header" href="#addressing-system">Addressing System</a></h1>
<p>When a Nym client is initalised, it generates and stores its own public/private keypair locally. When the client starts, it automatically connects to the Nym network and finds out what Nym infrastructure exists. It then chooses and connects to a specific Gateway node via websocket.</p>
<p>All apps in the Nym network therefore have an address, in the format:</p>
<pre><code>user-identity-key.user-encryption-key@gateway-identity-key
</code></pre>
<p>Which in practice, looks something like this: </p>
<pre><code>DguTcdkWWtDyUFLvQxRdcA8qZhardhE1ZXy1YCC7Zfmq.Dxreouj5RhQqMb3ZaAxgXFdGkmfbDKwk457FdeHGKmQQ@4kjgWmFU1tcGAZYRZR57yFuVAexjLbJ5M7jvo3X5Hkcf
</code></pre>
<p>This is obviously not very user-friendly and the moment, and will be developed on in the coming months. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="typescript-sdk"><a class="header" href="#typescript-sdk">Typescript SDK</a></h1>
<p>The Nym Typescript SDK allows developers to start building browser-based Mixnet applications quickly, by simply importing the SDK into their code via NPM as they would any other Typescript library. </p>
<p>You can find the source code <a href="https://github.com/nymtech/nym/tree/develop/sdk">here</a> and the library on NPM <a href="https://www.npmjs.com/package/@nymproject/sdk">here</a>. </p>
<p>Currently developers can use the SDK to do the following <strong>entirely in the browser</strong>: </p>
<ul>
<li>Create a client</li>
<li>Listen for incoming messages and reply to them</li>
<li>Encrypt text and binary-encoded messages as Sphinx packets and send these through the mixnet</li>
</ul>
<blockquote>
<p>We will be fleshing out further mixnet-related features in the coming weeks with functionality such as importing/exporting keypairs for developing apps with a retained identity over time.</p>
</blockquote>
<p>In the future the SDK will be made up of several components, each of which will allow developers to interact with different parts of Nym’s infrastructure.</p>
<div class="table-wrapper"><table><thead><tr><th>Component</th><th>Functionality</th><th>Released</th></tr></thead><tbody>
<tr><td>Mixnet</td><td>Create clients &amp; keypairs, subscribe to Mixnet events, send &amp; receive messages</td><td>✔️</td></tr>
<tr><td>Coconut</td><td>Create &amp; verify Coconut credentials</td><td>❌</td></tr>
<tr><td>Validator</td><td>Sign &amp; broadcast Nyx blockchain transactions, query the blockchain</td><td>❌</td></tr>
</tbody></table>
</div>
<h3 id="using-the-sdk"><a class="header" href="#using-the-sdk">Using the SDK</a></h3>
<p>The following code snippet shows the basic flow of initialising a client, subscribing to an event on the websocket connection, and sending yourself a message through the Mixnet: </p>
<pre><code class="language-javascript">import { createNymMixnetClient } from '@nymproject/sdk';

const main = async () =&gt; {
  
  // create your client
  const nym = await createNymMixnetClient();

  // define which validator API you wish to ping to receive network topology on startup 
  const validatorApiUrl = 'https://validator.nymtech.net/api';

  // show message payload content when received 
  nym.events.subscribeToTextMessageReceivedEvent((e) =&gt; {
    console.log('Got a message: ', e.args.payload);
  });

  // start the client and connect to a gateway
  await nym.client.start({
    clientId: 'My awesome client',
    validatorApiUrl,
  });

  // send a message to yourself
  const payload = 'Hello mixnet';
  const recipient = nym.client.selfAddress();
  nym.client.sendMessage({ payload, recipient });
  
};
</code></pre>
<p>You can send a message to another user (you will need to know their address at a Gateway) with: </p>
<pre><code class="language-javascript">const payload = 'Hello mixnet';
const recipient = '&lt;&lt; RECIPIENT ADDRESS GOES HERE &gt;&gt;';
await nym.client.sendMessage({ payload, recipient });
</code></pre>
<p>There are also examples for several different frameworks which can be run in the browser: </p>
<ul>
<li><a href="https://github.com/nymtech/nym/tree/release/v1.1.2/sdk/typescript/examples/plain-html">Plain html</a></li>
<li><a href="https://github.com/nymtech/nym/tree/release/v1.1.2/sdk/typescript/examples/react-webpack-with-theme-example">Create-react-app</a> </li>
<li><a href="https://github.com/fmtabbara/nym-sdk-vanilla-template">Vanilla Typescript</a> </li>
</ul>
<h3 id="how-it-works"><a class="header" href="#how-it-works">How it works</a></h3>
<p>The SDK can be thought of as a ‘wrapper’ around the compiled <a href="https://github.com/nymtech/nym/tree/develop/clients/webassembly">WebAssembly client</a> code: it runs the client (a Wasm blob) in a web worker. This allows us to keep the work done by the client - such as the heavy lifting of creating and multiply-encrypting Sphinx packets - in a seperate thread from our UI, enabling you to build reactive frontends without worrying about the work done under the hood by the client eating your processing power. </p>
<p>The SDK exposes an interface that allows developers to interact with the Wasm blob inside the webworker from frontend code.</p>
<h3 id="framework-support"><a class="header" href="#framework-support">Framework Support</a></h3>
<p>Currently, the SDK <strong>only</strong> works with frameworks that use webpack as a bundler. If you want to use the SDK with a framework that isn’t on this list, such as Angular, or NodeJS, <strong>here be dragons!</strong> These frameworks will probably use a different bundler than the examples listed above, which are all using Webpack. </p>
<p>Support for environments with different bundlers will be added in subsequent releases. </p>
<div class="table-wrapper"><table><thead><tr><th>Bundler</th><th>Supported</th></tr></thead><tbody>
<tr><td>Webpack</td><td>✔️</td></tr>
<tr><td>Packer</td><td>❌</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Environment</th><th>Supported</th></tr></thead><tbody>
<tr><td>Browser</td><td>✔️</td></tr>
<tr><td>Headless NodeJS</td><td>❌</td></tr>
<tr><td>Electron Desktop</td><td>❌</td></tr>
</tbody></table>
</div>
<h3 id="think-about-what-youre-sending-1"><a class="header" href="#think-about-what-youre-sending-1">Think about what you’re sending!</a></h3>
<p>:::caution
Think about what information your app sends. That goes for whatever you put into your Sphinx packet messages as well as what your app’s environment may leak.
:::</p>
<p>Whenever you write client PEAPs using HTML/JavaScript, we recommend that you do not load external resources from CDNs. Webapp developers do this all the time, to save load time for common resources, or just for convenience. But when you’re writing privacy apps it’s better not to make these kinds of requests. Pack everything locally.</p>
<p>If you use only local resources within your Electron app or your browser extensions, explicitly encoding request data in a Sphinx packet does protect you from the normal leakage that gets sent in a browser HTTP request. <a href="https://panopticlick.eff.org/">There’s a lot of stuff that leaks when you make an HTTP request from a browser window</a>. Luckily, all that metadata and request leakage doesn’t happen in Nym, because you’re choosing very explicitly what to encode into Sphinx packets, instead of sending a whole browser environment by default.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-sdk-coming-soon"><a class="header" href="#rust-sdk-coming-soon">Rust SDK (coming soon)</a></h1>
<p>🦀 coming soon 🦀</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="desktop-wallet"><a class="header" href="#desktop-wallet">Desktop Wallet</a></h1>
<p>The Nym Desktop Wallet lets you interact with your Nym node and to delegate stake to others, see the vesting schedule of tokens, and transfer tokens. In future releases, it will also let you access the Nym mixnet.</p>
<p>You can download it for Mac, Windows, or Linux.</p>
<p><a href="https://github.com/nymtech/nym/releases/tag/nym-wallet-v1.1.1"><img src="wallet//img/docs/download-wallet.png" alt="download nym wallet" /></a></p>
<h3 id="bypassing-security-warnings"><a class="header" href="#bypassing-security-warnings">Bypassing security warnings</a></h3>
<p>On Windows you will see a security warning pop up when you attempt to run the wallet. We are in the process of getting app store keys from Microsoft so that this doesn’t happen. See the section below for details on steps to bypass these. </p>
<h4 id="linux"><a class="header" href="#linux">Linux</a></h4>
<p>You will need to <code>chmod +x</code> the AppImage in the terminal (or give it execute permission in your file browser) before it will run. </p>
<h4 id="windows"><a class="header" href="#windows">Windows</a></h4>
<p><em>You will still encounter warnings when opening the wallet on Windows. This is because - although the wallet is approved by Microsoft - it has less than 10 thousand downloads at the current time. Once the wallet has passed this threshold, this warning will disappear.</em></p>
<p>Follow the steps below to bypass the warnings. </p>
<ul>
<li>Select more-info after clicking the msi installer app: </li>
</ul>
<p>&lt;ThemedImage
alt=“”
sources={{
light: useBaseUrl(‘/img/docs/wallet-warnings/windows_warningv1-0-2.png’),
dark: useBaseUrl(‘/img/docs/wallet-warnings/windows_warningv1-0-2.png’),
}}
/&gt;</p>
<ul>
<li>Proceed to ‘run-anyway’:</li>
</ul>
<p>&lt;ThemedImage
alt=“”
sources={{
light: useBaseUrl(‘/img/docs/wallet-warnings/windows_warning2.png’),
dark: useBaseUrl(‘/img/docs/wallet-warnings/windows_warning2.png’),
}}
/&gt;</p>
<ul>
<li>Follow the installer instructions: </li>
</ul>
<p>&lt;ThemedImage
alt=“”
sources={{
light: useBaseUrl(‘/img/docs/wallet-warnings/windows_warning3.png’),
dark: useBaseUrl(‘/img/docs/wallet-warnings/windows_warning3.png’),
}}
/&gt;</p>
<p>&lt;ThemedImage
alt=“”
sources={{
light: useBaseUrl(‘/img/docs/wallet-warnings/windows_warning4.png’),
dark: useBaseUrl(‘/img/docs/wallet-warnings/windows_warning4.png’),
}}
/&gt;</p>
<p>&lt;ThemedImage
alt=“”
sources={{
light: useBaseUrl(‘/img/docs/wallet-warnings/windows_warning5.png’),
dark: useBaseUrl(‘/img/docs/wallet-warnings/windows_warning5.png’),
}}
/&gt;</p>
<h3 id="for-developers"><a class="header" href="#for-developers">For developers</a></h3>
<p>If you would like to the compile the wallet yourself, follow the instructions below. </p>
<blockquote>
<p>Please note that the wallet has currently only been built on the operating systems for which there are binaries as listed above. If you find an issue or any additional prerequisties, please create an issue or PR against <code>develop</code> on <a href="https://github.com/nymtech/docs">Github</a>.</p>
</blockquote>
<h4 id="software-prerequisites-for-building-the-wallet"><a class="header" href="#software-prerequisites-for-building-the-wallet">Software prerequisites for building the wallet</a></h4>
<ul>
<li><code>git</code></li>
</ul>
<pre><code>sudo apt update
sudo apt install git
</code></pre>
<p>Verify <code>git</code> is installed with:</p>
<pre><code>git version
# Should return: git version X.Y.Z
</code></pre>
<ul>
<li>
<p><a href="https://yarnpkg.com/">Yarn</a></p>
</li>
<li>
<p><code>NodeJS &gt;= v16.8.0</code></p>
</li>
<li>
<p><code>Rust &amp; cargo &gt;= v1.56</code></p>
</li>
</ul>
<p>We recommend using the <a href="https://www.rust-lang.org/tools/install">Rust shell script installer</a>. Installing cargo from your package manager (e.g. <code>apt</code>) is not recommended as the packaged versions are usually too old.</p>
<p>If you really don’t want to use the shell script installer, the <a href="https://forge.rust-lang.org/infra/other-installation-methods.html">Rust installation docs</a> contain instructions for many platforms.</p>
<h4 id="additional-prerequisites-for-ubuntudebian-systems"><a class="header" href="#additional-prerequisites-for-ubuntudebian-systems">Additional prerequisites for Ubuntu/Debian systems</a></h4>
<pre><code>sudo apt update
sudo apt install pkg-config build-essential libssl-dev curl jq
</code></pre>
<h4 id="additional-prerequisites-for-windows"><a class="header" href="#additional-prerequisites-for-windows">Additional prerequisites for Windows</a></h4>
<ul>
<li>When running on Windows you will need to install the <code>c++</code> build tools.</li>
<li>An easy guide to get Rust up and running can be found <a href="http://kennykerr.ca/2019/11/18/rust-getting-started/">here</a>.</li>
<li>When installing <code>NodeJS</code> please use the <code>current features</code> version.</li>
<li>Using a package manager like <a href="https://chocolatey.org/">Chocolatey</a> is recommended.</li>
</ul>
<h3 id="removing-signing-errors-when-building-in-development-mode"><a class="header" href="#removing-signing-errors-when-building-in-development-mode">Removing signing errors when building in development mode</a></h3>
<p>If you’re wanting to build the wallet yourself, you will need to make a few modifications to the file located at <code>nym-wallet/src-tauri/tauri.conf.json</code> before doing so. These relate to the wallet being accepted by Mac and Windows app stores, and so aren’t relevant to you when building and running the wallet yourself. </p>
<p>On <strong>all</strong> operating systems: </p>
<ul>
<li>set the value of line 49 to <code>false</code></li>
<li>remove lines 50 to 54 </li>
</ul>
<p>As well as these modifications for MacOS and Windows users: </p>
<ul>
<li>MacOS users must also remove line 39 </li>
<li>Windows users must remove lines 42 to 46 </li>
</ul>
<h3 id="installation"><a class="header" href="#installation">Installation</a></h3>
<p>Once you have made these modifications to <code>tauri.conf.json</code>, inside of the <code>nym-wallet</code> folder, run:</p>
<pre><code>yarn install
</code></pre>
<h3 id="running-in-development-mode"><a class="header" href="#running-in-development-mode">Running in Development Mode</a></h3>
<blockquote>
<p>Make sure you copy over the contents of the provided <code>.env.sample</code> to a new <code>.env</code> file before proceeding</p>
</blockquote>
<p>You can run the wallet without having to install it in development mode by running the following terminal command from the <code>nym-wallet</code> folder</p>
<pre><code>yarn dev
</code></pre>
<p>This will then start the Wallet GUI and produce a binary in <code>nym-wallet/target/debug/</code> named <code>nym-wallet</code>. </p>
<h3 id="running-in-production-mode"><a class="header" href="#running-in-production-mode">Running in Production Mode</a></h3>
<blockquote>
<p>Make sure you copy over the contents of the provided <code>.env.sample</code> to a new <code>.env</code> file before proceeding</p>
</blockquote>
<p>To build and install the wallet, run the following terminal command from the <code>nym-wallet</code> folder.</p>
<pre><code>yarn build
</code></pre>
<p>This will build an executable file that you can use to install the wallet on your machine. The output will compile different types of binaries dependent on your hardware / OS system. Once the binaries are built, they can be located as follows:</p>
<pre><code>Binary output directory structure
**macos**
|
└─── target/release
|   |─ nym-wallet
└───target/release/bundle/dmg
│   │─ bundle_dmg.sh
│   │─ nym-wallet.*.dmg
└───target/release/bundle/macos/MacOs
│   │─ nym-wallet
|
**Linux**
└─── target/release
|   │─  nym-wallet
└───target/release/bundle/appimage
│   │─  nym-wallet_*_.AppImage
│   │─  build_appimage.sh
└───target/release/bundle/deb
│   │─  nym-wallet_*_.deb
|
**Windows**
└─── target/release
|   │─  nym-wallet.exe
└───target/release/bundle/msi
│   │─  nym-wallet_*_.msi
</code></pre>
<h3 id="importing-or-creating-accounts-when-you-have-signed-in-with-mnemonic"><a class="header" href="#importing-or-creating-accounts-when-you-have-signed-in-with-mnemonic">Importing or creating account(s) when you have signed in with mnemonic</a></h3>
<p>To import or create a new account, first you need to create a password for your wallet:</p>
<ol>
<li>Log out of your wallet</li>
<li>Click on “Sign in with mnemonic”</li>
<li>On the next screen select “Create a password for your account”</li>
<li>Sign in to the wallet with your new password</li>
<li>Click on your account name, you can now create new accounts or import existing ones</li>
</ol>
<h3 id="importing-or-creating-accounts-when-you-have-signed-in-with-mnemonic-but-a-password-already-exists-on-your-machine"><a class="header" href="#importing-or-creating-accounts-when-you-have-signed-in-with-mnemonic-but-a-password-already-exists-on-your-machine">Importing or creating account(s) when you have signed in with mnemonic but a password already exists on your machine</a></h3>
<p>To import or create a new account, you need to log in with your existing password or create a new password. </p>
<blockquote>
<p>Creating a new password will overwrite any old one stored on your machine. Make sure you have saved any mnemonics associated with the password before creating a new one.</p>
</blockquote>
<ol>
<li>Log out</li>
<li>Click on “Forgot password” </li>
<li>On the next screen select “Create new password”</li>
<li>Follow the instructions and create a new password</li>
<li>Sign in using your new password</li>
</ol>
<h3 id="cli-tool-for-wallet-encrypted-file-password-recovery"><a class="header" href="#cli-tool-for-wallet-encrypted-file-password-recovery">CLI tool for wallet encrypted file (password) recovery:</a></h3>
<p>The mnemonics that are stored in the local password protected file can also be decrypted and recovered through a simple CLI tool, <code>nym-wallet-recovery-cli</code>. </p>
<pre><code>nym-wallet-recovery –file saved-wallet.json –password foo
</code></pre>
<p>The saved wallet file can be found in <code>$XDG_DATA_HOME</code> or <code>$HOME/.local/share</code> on Linux, <code>$HOME/Library/Application Support</code> on Mac, and <code>C:\Users\username\AppData\Local</code> on Windows.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cli-wallet"><a class="header" href="#cli-wallet">CLI Wallet</a></h1>
<p>If you have already read our validator setup and maintenance <a href="wallet//docs/next/run-nym-nodes/nodes/validators">documentation</a> you will have seen that we compile and use the <code>nyxd</code> binary primarily for our validators. This binary can however be used for many other tasks, such as creating and using keypairs for wallets, or automated setups that require the signing and broadcasting of transactions. </p>
<h3 id="using-nyxd-binary-as-a-cli-wallet"><a class="header" href="#using-nyxd-binary-as-a-cli-wallet">Using <code>nyxd</code> binary as a CLI wallet</a></h3>
<p>You can use the <code>nyxd</code> as a minimal CLI wallet if you want to set up an account (or multiple accounts). Just compile the binary as per the documentation, <strong>stopping after</strong> the <a href="wallet//docs/next/run-nym-nodes/nodes/validators#building-your-validator">building your validator</a> step is complete. You can then run <code>nyxd keys --help</code> to see how you can set up and store different keypairs with which to interact with the Nyx blockchain. </p>
<p>For more on interacting with the chain, see the <a href="wallet/../nyx/interacting-with-chain.html">Interacting with Nyx Chain and Smart Contracts</a> page. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mixnet-explorer"><a class="header" href="#mixnet-explorer">Mixnet Explorer</a></h1>
<p>The Nym Network Explorer lets you explore the Nym network. We have open-sourced the explorer so that anyone can run an instance of it, further decentralising the network! </p>
<h3 id="prerequisites-2"><a class="header" href="#prerequisites-2">Prerequisites</a></h3>
<ul>
<li><code>git</code></li>
</ul>
<pre><code>sudo apt update
sudo apt install git
</code></pre>
<p>Verify <code>git</code> is installed with:</p>
<pre><code>git version
# Should return: git version X.Y.Z
</code></pre>
<ul>
<li>(Debian/Ubuntu) <code>pkg-config</code>, <code>build-essential</code>, <code>libssl-dev</code>, <code>curl</code>, <code>jq</code></li>
</ul>
<pre><code>sudo apt update
sudo apt install pkg-config build-essential libssl-dev curl jq
</code></pre>
<ul>
<li>
<p><code>NodeJS</code> (use <code>nvm install</code> to automatically install the correct version) and <code>npm</code></p>
</li>
<li>
<p><code>Rust &amp; cargo &gt;= v1.56</code></p>
</li>
</ul>
<p>We recommend using the <a href="https://www.rust-lang.org/tools/install">Rust shell script installer</a>. Installing cargo from your package manager (e.g. <code>apt</code>) is not recommended as the packaged versions are usually too old.</p>
<p>If you really don’t want to use the shell script installer, the <a href="https://forge.rust-lang.org/infra/other-installation-methods.html">Rust installation docs</a> contain instructions for many platforms.</p>
<h3 id="local-development"><a class="header" href="#local-development">Local Development</a></h3>
<p>Complete the steps in the <a href="explorers/../binaries/building-nym.html">building nym</a> section, before <code>cd</code>-ing into <code>nym/explorer</code>. </p>
<p>Start a development server with hot reloading running on <code>http://localhost:3000</code> with the following commands from inside the <code>explorer</code> directory:</p>
<pre><code>nvm install # install relevant nodejs and npm versions 
npm install
npm run start
</code></pre>
<p><code>eslint</code> and <code>prettier</code> are already configured.</p>
<p>You can lint the code by running:</p>
<pre><code>npm run lint
</code></pre>
<blockquote>
<p>This command will only <strong>show</strong> linting errors and will not fix them!</p>
</blockquote>
<p>To fix all linting errors automatically run:</p>
<pre><code>npm run lint:fix
</code></pre>
<p>Please see the development docs in <code>explorer/docs</code> for more information on the structure and design of this app.</p>
<h3 id="deployment"><a class="header" href="#deployment">Deployment</a></h3>
<p>Complete the steps in the <a href="explorers/../binaries/building-nym.html">building nym</a> section, before <code>cd</code>-ing into <code>nym/explorer</code>. </p>
<blockquote>
<p>The Network Explorer should be run on a machine with at least 4GB of RAM - the build process might fail if run on a less powerful machine. </p>
</blockquote>
<h4 id="building-the-explorer-ui"><a class="header" href="#building-the-explorer-ui">Building the Explorer UI</a></h4>
<p>Build the UI with these commands from within the <code>explorer</code> directory:</p>
<pre><code>nvm install # install relevant nodejs and npm versions 
npm install
npm run build
</code></pre>
<p>The output will be in the <code>dist</code> directory. </p>
<p>This can then be either served directly from the <code>nym</code> directory, or from its own directory if you wish. See the template nginx config below for more on how to host this. </p>
<h4 id="building-the-explorer-api"><a class="header" href="#building-the-explorer-api">Building the Explorer API</a></h4>
<p>The Explorer API was built in the previous step with <code>cargo build</code>. </p>
<h3 id="automating-the-explorer-with-systemd"><a class="header" href="#automating-the-explorer-with-systemd">Automating the explorer with systemd</a></h3>
<p>You will most likely want to automate the Explorer-API restarting if your server reboots. Below is a systemd unit file to place at <code>/etc/systemd/system/nym-explorer-api.service</code>:</p>
<pre><code class="language-ini">[Unit]
Description=Nym Explorer API (1.1.0)
StartLimitIntervalSec=350
StartLimitBurst=10

[Service]
User=nym
Type=simple
Environment=&quot;API_STATE_FILE=/home/nym/network-explorer/explorer-api-state.json&quot;
Environment=&quot;GEO_IP_SERVICE_API_KEY=c69155d0-25f6-11ec-80bc-75e5dbd322c3&quot;
ExecStart={{ explorer_api_location }}
Restart=on-failure
RestartSec=30

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Proceed to start it with:</p>
<pre><code>systemctl daemon-reload # to pickup the new unit file
systemctl enable nymd   # to enable the service
systemctl start nymd    # to actually start the service
journalctl -f           # to monitor system logs showing the service start
</code></pre>
<h3 id="installing-and-configuring-nginx-for-https-1"><a class="header" href="#installing-and-configuring-nginx-for-https-1">Installing and configuring nginx for HTTPS</a></h3>
<h4 id="setup-1"><a class="header" href="#setup-1">Setup</a></h4>
<p><a href="https://www.nginx.com/resources/glossary/nginx/#:~:text=NGINX%20is%20open%20source%20software,%2C%20media%20streaming%2C%20and%20more.&amp;text=In%20addition%20to%20its%20HTTP,%2C%20TCP%2C%20and%20UDP%20servers.">Nginx</a> is an open source software used for operating high-performance web servers. It allows us to set up reverse proxying on our validator server to improve performance and security.</p>
<p>Install <code>nginx</code> and allow the ‘Nginx Full’ rule in your firewall:</p>
<pre><code>sudo ufw allow 'Nginx Full'
</code></pre>
<p>Check nginx is running via systemctl:</p>
<pre><code>systemctl status nginx
</code></pre>
<p>Which should return:</p>
<pre><code>● nginx.service - A high performance web server and a reverse proxy server
   Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: enabled)
   Active: active (running) since Fri 2018-04-20 16:08:19 UTC; 3 days ago
     Docs: man:nginx(8)
 Main PID: 2369 (nginx)
    Tasks: 2 (limit: 1153)
   CGroup: /system.slice/nginx.service
           ├─2369 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;
           └─2380 nginx: worker process
</code></pre>
<h4 id="configuration-1"><a class="header" href="#configuration-1">Configuration</a></h4>
<p>Replace the default nginx configuration at <code>/etc/nginx/sites-available/</code> with: </p>
<pre><code>server {
  listen 80;
  listen [::]:80;
  server_name {{ domain }};
  root {{ html_location }};
  location / {
    try_files /$uri /$uri/index.html /index.html =404;
  }

  location /api {
      proxy_pass http://127.0.0.1:8000;
		  rewrite /api/(.*) /$1  break;
                  proxy_set_header  X-Real-IP $remote_addr;
                  proxy_set_header  Host $host;
                  proxy_set_header  X-Real-IP $remote_addr;
  }
}
</code></pre>
<p>Followed by:</p>
<pre><code>sudo apt install certbot nginx python3
certbot --nginx -d nym-validator.yourdomain.com -m you@yourdomain.com --agree-tos --noninteractive --redirect
</code></pre>
<div id="admonition-caution" class="admonition warning">
<div class="admonition-title">
<p>Caution</p>
<p><a class="admonition-anchor-link" href="explorers/mixnet-explorer.html#admonition-caution"></a></p>
</div>
<div>
<p>If using a VPS running Ubuntu 20: replace <code>certbot nginx python3</code> with <code>python3-certbot-nginx</code></p>
</div>
</div>
<h3 id="configure-your-firewall-3"><a class="header" href="#configure-your-firewall-3">Configure your firewall</a></h3>
<p>The following commands will allow you to set up a firewall using <code>ufw</code>.</p>
<pre><code># check if you have ufw installed
ufw version
# if it is not installed, install with
sudo apt install ufw -y
# enable ufw
sudo ufw enable
# check the status of the firewall
sudo ufw status
</code></pre>
<p>Now open the ports: </p>
<pre><code>sudo ufw allow 22,80,443/tcp
# check the status of the firewall
sudo ufw status
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interacting-with-nyx-chain-and-smart-contracts"><a class="header" href="#interacting-with-nyx-chain-and-smart-contracts">Interacting with Nyx Chain and Smart Contracts</a></h1>
<p>There are two options for interacting with the blockchain to send tokens or interact with deployed smart contracts: </p>
<ul>
<li><a href="nyx/../tools/nym-cli.html"><code>Nym-CLI</code></a> tool </li>
<li><code>nyxd</code> binary</li>
</ul>
<h2 id="nym-cli-tool-recommended-in-most-cases"><a class="header" href="#nym-cli-tool-recommended-in-most-cases">Nym-CLI tool (recommended in most cases)</a></h2>
<p>The <code>nym-cli</code> tool is a binary offering a simple interface for interacting with deployed smart contract (for instance, bonding and unbonding a mix node from the CLI), as well as creating and managing accounts and keypairs, sending tokens, and querying the blockchain. </p>
<p>Instructions on how to do so can be found on the <a href="nyx/../tools/nym-cli.html"><code>nym-cli</code> docs page</a>.</p>
<h2 id="nyxd-binary"><a class="header" href="#nyxd-binary">Nyxd binary</a></h2>
<p>The <code>nyxd</code> binary, although more complex to compile and use, offers the full range of commands availiable to users of CosmosSDK chains. Use this if you are (e.g.) wanting to perform more granular queries about transactions from the CLI. </p>
<p>You can use the instructions on how to do this on from the <a href="https://hub.cosmos.network/main/delegators/delegator-guide-cli.html#querying-the-state"><code>gaiad</code> docs page</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="smart-contracts"><a class="header" href="#smart-contracts">Smart Contracts</a></h1>
<p>The Nyx blockchain is based on <a href="https://cosmwasm.com/">CosmWasm</a>. It allows users to code smart contracts in a safe subset of the Rust programming language, easily export them to WebAssembly, and upload them to the blockchain. Information about the chain can be found on the <a href="https://nym.explorers.guru/">Nyx blockchain explorer</a>. </p>
<p>There are currently two smart contracts on the Nyx chain: </p>
<ul>
<li>the <a href="nyx//docs/next/smart-contracts/mixnet">Mixnet contract</a> which manages the network topology of the mixnet, tracking delegations and rewarding. </li>
<li>the <a href="nyx//docs/next/smart-contracts/vesting">Vesting contract</a> which manages <code>NYM</code> token vesting functionality.</li>
</ul>
<p>:::note
Users will soon be able to create and upload their own CosmWasm smart contracts to Nyx and take advantage of applications such as <a href="nyx//docs/next/coconut">Coconut</a> - more to be announced regarding this very soon.
:::</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mixnet-contract"><a class="header" href="#mixnet-contract">Mixnet Contract</a></h1>
<p>The Mixnet smart contract is a core piece of the Nym system, functioning as the mixnet directory and keeping track of delegations and rewards: the core functionality required by an incentivised mixnet. You can find the code and build instructions <a href="https://github.com/nymtech/nym/tree/release/v1.1.5/contracts/mixnet">here</a>.</p>
<h3 id="functionality"><a class="header" href="#functionality">Functionality</a></h3>
<p>The Mixnet contract has multiple functions: </p>
<ul>
<li>storing bonded mix node and gateway information (and removing this on unbonding).</li>
<li>providing the network-topology to the (cached) validator API endpoint used by clients on startup for routing information. </li>
<li>storing delegation and bond amounts.</li>
<li>storing reward amounts. </li>
</ul>
<p><strong>TODO MAKE LINK TO RECENT RELEASE IN URL VARIABLE</strong></p>
<p>The addresses of deployed smart contracts can be found in the <a href="https://github.com/nymtech/nym/blob/release/v1.1.5/common/network-defaults/src/mainnet.rs"><code>network-defaults</code></a> directory of the codebase alongside other network default values.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vesting-contract"><a class="header" href="#vesting-contract">Vesting Contract</a></h1>
<p>The vesting contract allows for the creation of vesting accounts, allowing <code>NYM</code> tokens to vest over time, and for users to minimally interact with the Mixnet using their unvested tokens. You can find the code and build instructions <a href="https://github.com/nymtech/nym/tree/release/v1.1.2/contracts/vesting">here</a>. </p>
<h3 id="functionality-1"><a class="header" href="#functionality-1">Functionality</a></h3>
<p>The Vesting contract has multiple functions:</p>
<ul>
<li>Creating and storing vesting <code>NYM</code> token vesting accounts.</li>
<li>Interacting with the Mixnet using vesting (i.e. non-transferable) tokens, allowing users to delegate their unvested tokens. </li>
</ul>
<p><strong>TODO MAKE LINK TO RECENT RELEASE IN URL VARIABLE</strong></p>
<p>The addresses of deployed smart contracts can be found in the <a href="https://github.com/nymtech/nym/blob/release/v1.1.2/common/network-defaults/src/mainnet.rs"><code>network-defaults</code></a> directory of the codebase alongside other network default values.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rpc-nodes"><a class="header" href="#rpc-nodes">RPC Nodes</a></h1>
<p>RPC Nodes (which might otherwise be referred to as ‘Lite Nodes’ or just ‘Full Nodes’) differ from Validators in that they hold a copy of the Nyx blockchain, but do <strong>not</strong> participate in consensus / block-production. </p>
<p>You may want to set up an RPC Node for querying the blockchain, or in order to have an endpoint that your app can use to send transactions. </p>
<p>In order to set up an RPC Node, simply follow the instructions to set up a <a href="nyx/../nodes/validator-setup.html">Validator</a>, but <strong>exclude the <code>nyxd tx staking create-validator</code> command</strong>. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nym-cli"><a class="header" href="#nym-cli">Nym-CLI</a></h1>
<p>This is a CLI tool for interacting with:</p>
<ul>
<li>the Nyx blockchain (account management, querying the chain state, etc)</li>
<li>the smart contracts deployed on Nyx (bonding and unbonding mixnodes, collecting rewards, etc)</li>
</ul>
<p>It provides a convenient wrapper around the <code>nymd</code> client, and has similar functionality to the <code>nyxd</code> binary for querying the chain or executing smart contract methods.</p>
<h2 id="building"><a class="header" href="#building">Building</a></h2>
<p>The <code>nym-cli</code> binary can be built by running <code>cargo build --release</code> in the <code>nym/tools/nym-cli</code> directory. </p>
<h3 id="useage"><a class="header" href="#useage">Useage</a></h3>
<p>You can see all available commands with: </p>
<pre><code>./nym-cli --help      
</code></pre>
<details id="admonition-console-output" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="tools/nym-cli.html#admonition-console-output"></a></p>
</summary>
<div>
<pre><code>
nym-cli 
A client for interacting with Nym smart contracts and the Nyx blockchain

USAGE:
    nym-cli [OPTIONS] &lt;subcommand&gt;

OPTIONS:
        --config-env-file &lt;CONFIG_ENV_FILE&gt;
            Overrides configuration as a file of environment variables. Note: individual env vars
            take precedence over this file.

    -h, --help
            Print help information

        --mixnet-contract-address &lt;MIXNET_CONTRACT_ADDRESS&gt;
            Overrides the mixnet contract address provided either as an environment variable or in a
            config file

        --mnemonic &lt;MNEMONIC&gt;
            Provide the mnemonic for your account. You can also provide this is an env var called
            MNEMONIC.

        --nymd-url &lt;NYMD_URL&gt;
            Overrides the nymd URL provided either as an environment variable NYMD_VALIDATOR or in a
            config file

        --validator-api-url &lt;VALIDATOR_API_URL&gt;
            Overrides the validator API URL provided either as an environment variable API_VALIDATOR
            or in a config file

        --vesting-contract-address &lt;VESTING_CONTRACT_ADDRESS&gt;
            Overrides the vesting contract address provided either as an environment variable or in
            a config file

subcommandS:
    account             Query and manage Nyx blockchain accounts
    block               Query chain blocks
    cosmwasm            Manage and execute WASM smart contracts
    generate-fig        Generates shell completion
    help                Print this message or the help of the given subcommand(s)
    mixnet              Manage your mixnet infrastructure, delegate stake or query the directory
    signature           Sign and verify messages
    tx                  Query for transactions
    vesting-schedule    Create and query for a vesting schedule
</code></pre>
</div>
</details>
<h2 id="features"><a class="header" href="#features">Features</a></h2>
<p>You can use this binary for account management, querying and sending transactions to the mixnet <a href="https://github.com/nymtech/nym/tree/develop/contracts">smart contracts</a>. </p>
<p>Currently supported features include: </p>
<ul>
<li><strong>Account Management</strong>
<ul>
<li>create a new account with a random mnemonic</li>
<li>query the account balance</li>
<li>query the account public key (needed to verify signatures)</li>
<li>query for transactions originating from the account</li>
<li>send tokens to another account</li>
</ul>
</li>
<li><strong>Blockchain Queries</strong>
<ul>
<li>query for the current block height</li>
<li>query for a block at a height</li>
<li>query for a block at a timestamp</li>
</ul>
</li>
<li><strong>Smart Contract Interaction</strong>
<ul>
<li>upload a smart contract</li>
<li>instantiate a smart contract</li>
<li>upgrade a smart contract</li>
<li>execute a smart contract method</li>
</ul>
</li>
<li><strong>Mixnet Interaction</strong>
<ul>
<li>ledger Directory</li>
<li>query for mixnodes</li>
<li>query for gateways</li>
</ul>
</li>
<li><strong>Operators</strong>
<ul>
<li>bond/unbond a mixnode or gateway</li>
<li>query for waiting rewards</li>
<li>withdraw rewards</li>
<li>manage mixnode settings</li>
</ul>
</li>
<li><strong>Delegators</strong>
<ul>
<li>delegate/undelegate to a mixnode</li>
<li>query for waiting rewards</li>
<li>withdraw rewards</li>
</ul>
</li>
<li><strong>Signature Generation and Verification</strong>
<ul>
<li>create a signature for string data (UTF-8)</li>
<li>verify a signature for an account</li>
</ul>
</li>
<li><strong>Vesting</strong>
<ul>
<li>create a vesting schedule</li>
<li>query for a vesting schedule</li>
</ul>
</li>
<li><strong>Coconut (coming soon)</strong>
<ul>
<li>issue credentials</li>
<li>verify credentials</li>
</ul>
</li>
</ul>
<h2 id="example-usage"><a class="header" href="#example-usage">Example Usage</a></h2>
<p>Below we have listed some example commands for some of the features listed above. </p>
<p>If ever in doubt what you need to type, or if you want to see alternative parameters for a command, use the <code>nym-cli &lt;subcommand_name&gt; --help</code> to view all available options.</p>
<p>Example:</p>
<pre><code>./nym-cli account create --help     
</code></pre>
<details id="admonition-console-output-1" class="admonition example">
<summary class="admonition-title">
<p>Console output</p>
<p><a class="admonition-anchor-link" href="tools/nym-cli.html#admonition-console-output-1"></a></p>
</summary>
<div>
<pre><code>
Create a new mnemonic - note, this account does not appear on the chain until the account id is used in a transaction

USAGE:
    nym-cli account create [OPTIONS]

OPTIONS:
    --config-env-file &lt;CONFIG_ENV_FILE&gt;
        Overrides configuration as a file of environment variables. Note: individual env vars take precedence over this file.

-h, --help
        Print help information

    --mixnet-contract-address &lt;MIXNET_CONTRACT_ADDRESS&gt;
        Overrides the mixnet contract address provided either as an environment variable or in a
        config file

    --mnemonic &lt;MNEMONIC&gt;
        Provide the mnemonic for your account. You can also provide this is an env var called
        MNEMONIC.

    --nymd-url &lt;NYMD_URL&gt;
        Overrides the nymd URL provided either as an environment variable NYMD_VALIDATOR or in a
        config file

    --validator-api-url &lt;VALIDATOR_API_URL&gt;
        Overrides the validator API URL provided either as an environment variable API_VALIDATOR
        or in a config file

    --vesting-contract-address &lt;VESTING_CONTRACT_ADDRESS&gt;
        Overrides the vesting contract address provided either as an environment variable or in
        a config file

    --word-count &lt;WORD_COUNT&gt;
</code></pre>
</div>
</details>
<h4 id="create-account"><a class="header" href="#create-account">Create account</a></h4>
<p>Creates an account with a random Mnemonic and a new address.</p>
<pre><code>./nym-cli account create     
</code></pre>
<p><em>Result:</em></p>
<pre><code># Mnemonic
assist jungle spoil domain saddle energy box carpet toy resist castle faith talent note outdoor inform cage lecture syrup trigger dress oppose slender museum
# Address
n132tpw4kkfas7ah0vmq78dwurhxljf2f869tlf5
</code></pre>
<blockquote>
<p>NEVER share your mnemonic with anyone. Keep it stored in a safe and secure location.</p>
</blockquote>
<h3 id="check-the-current-balance-of-an-account"><a class="header" href="#check-the-current-balance-of-an-account">Check the current balance of an account</a></h3>
<p>Queries the existing balance of an account.</p>
<pre><code># Using adddress below for example purposes.
./nym-cli account balance n1hzn28p2c6pzr98r85jp3h53fy8mju5w7ndd5vh     
</code></pre>
<p><em>Result:</em></p>
<pre><code>2022-11-10T10:28:54.009Z INFO  nym_cli_commands::validator::account::balance &gt; Getting balance for n1hzn28p2c6pzr98r85jp3h53fy8mju5w7ndd5vh...

# Balance for each token will be listed here
0.264 nym
1921.995 nyx
</code></pre>
<p>You can also query an accounts balance by using its mnemonic:</p>
<pre><code>./nym-cli account balance --mnemonic &lt;mnemonic&gt;  
</code></pre>
<h3 id="send-tokens-to-an-account"><a class="header" href="#send-tokens-to-an-account">Send tokens to an account</a></h3>
<p>Sends tokens to an account using an address.</p>
<pre><code>./nym-cli account send &lt;ADDRESS&gt; &lt;AMOUNT&gt;
</code></pre>
<h3 id="get-the-current-height-of-a-block"><a class="header" href="#get-the-current-height-of-a-block">Get the current height of a block</a></h3>
<p>Queries the current height balance of an block.</p>
<pre><code>./nym-cli block current-height --mnemonic &lt;mnemonic&gt;
</code></pre>
<p><em>Result:</em></p>
<pre><code>Current block height:
&lt;BLOCK_HEIGHT&gt;
</code></pre>
<h3 id="query-for-a-mixnode"><a class="header" href="#query-for-a-mixnode">Query for a mixnode</a></h3>
<p>Query a mixnode on the mixnet.</p>
<pre><code>./nym-cli mixnet query mixnodes --mnemonic &lt;mnemonic&gt;
</code></pre>
<h3 id="bond-a-mix-node"><a class="header" href="#bond-a-mix-node">Bond a mix node</a></h3>
<p>Bond a mix node.</p>
<pre><code>nym-cli mixnet operators mixnode bond --mnemonic &lt;mnemonic&gt; --host &lt;HOST&gt; --signature &lt;SIGNATURE&gt; --sphinx-key &lt;SPHINX_KEY&gt; --identity-key &lt;IDENTITY_KEY&gt; --version &lt;VERSION&gt; --amount &lt;AMOUNT&gt;
</code></pre>
<blockquote>
<p>The same command can be applied with a gateway. Just replace <code>mixnode</code> with <code>gateway</code>.</p>
</blockquote>
<h3 id="unbond-a-gateway"><a class="header" href="#unbond-a-gateway">Unbond a gateway</a></h3>
<p>Unbond from a gateway. </p>
<pre><code>./nym-cli mixnet operators gateway unbound --mnemonic &lt;mnemonic&gt;
</code></pre>
<blockquote>
<p>The same command can be applied with a mixnode. Just replace <code>gateway</code> with <code>mixnode</code>.</p>
</blockquote>
<h3 id="claim-a-vesting-reward-for-a-mixnode"><a class="header" href="#claim-a-vesting-reward-for-a-mixnode">Claim a vesting reward for a mixnode</a></h3>
<p>Claim rewards for a mixnode bonded with locked tokens.</p>
<pre><code>./nym-cli mixnet operators mixnode rewards vesting-claim --mnemonic &lt;mnemonic&gt;
</code></pre>
<h3 id="claim-rewards"><a class="header" href="#claim-rewards">Claim rewards</a></h3>
<pre><code>./nym-cli mixnet operators mixnode rewards --mnemonic &lt;mnemonic&gt;
</code></pre>
<h3 id="manage-mix-node-settings"><a class="header" href="#manage-mix-node-settings">Manage Mix node Settings</a></h3>
<p>Manage your mix node settings stored in the directory.</p>
<pre><code>./nym-cli mixnet operators mixnode settings update-config --version &lt;VERSION_NUMBER&gt;
</code></pre>
<h3 id="delegate-stake"><a class="header" href="#delegate-stake">Delegate Stake</a></h3>
<p>Delegate to a mix node.</p>
<pre><code>./nym-cli mixnet delegators delegate --amount &lt;AMOUNT&gt; –mix-id &lt;MIX_ID&gt; --mnemonic &lt;mnemonic&gt;
</code></pre>
<h3 id="undelegate-stake"><a class="header" href="#undelegate-stake">Undelegate Stake</a></h3>
<p>Remove stake from a mix node.</p>
<pre><code>./nym-cli mixnet delegators undelegate --mix-id &lt;MIX-ID&gt; --mnemonic &lt;mnemonic&gt;
</code></pre>
<h3 id="query-a-reward-for-a-delegator"><a class="header" href="#query-a-reward-for-a-delegator">Query a reward for a delegator</a></h3>
<p>Claim rewards accumulated during the delegation of unlocked tokens.</p>
<pre><code>./nym-cli mixnet delegators rewards claim --mix-id &lt;MIX-ID&gt; --mnemonic &lt;mnemonic&gt;
</code></pre>
<h3 id="signature-generation--sign-a-message"><a class="header" href="#signature-generation--sign-a-message">Signature Generation : Sign a message</a></h3>
<p>Sign a message.</p>
<pre><code>./nym-cli signature sign --mnemonic &lt;mnemonic&gt; &lt;MESSAGE&gt;
</code></pre>
<p><em>Result:</em></p>
<pre><code>{&quot;account_id&quot;:&lt;ACCOUNT_ID&gt;,&quot;public_key&quot;:{&quot;@type&quot;:&quot;/cosmos.crypto.secp256k1.PubKey&quot;,&quot;key&quot;:&lt;PUBLIC_KEY&gt;},&quot;signature&quot;:&quot;&lt;OUTPUT_SIGNATURE&gt;&quot;}
</code></pre>
<p><strong>Signature Generation : Verify a signature</strong></p>
<p>Verify a signature.</p>
<pre><code>./nym-cli signature verify  --mnemonic &lt;mnemonic&gt; &lt;PUBLIC_KEY_OR_ADDRESS&gt; &lt;SIGNATURE_AS_HEX&gt; &lt;MESSAGE&gt; 
</code></pre>
<h3 id="create-a-vesting-schedule"><a class="header" href="#create-a-vesting-schedule">Create a Vesting Schedule</a></h3>
<p>Creates a vesting schedule.</p>
<pre><code>./nym-cli vesting-schedule create --mnemonic &lt;mnemonic&gt; --address &lt;ADDRESS&gt; --amount &lt;AMOUNT&gt;
</code></pre>
<h3 id="query-a-vesting-schedule"><a class="header" href="#query-a-vesting-schedule">Query a Vesting Schedule</a></h3>
<p>Query for vesting schedule.</p>
<pre><code>./nym-cli vesting-schedule query --mnemonic &lt;mnemonic&gt;
</code></pre>
<h2 id="staking-on-someones-behalf-for-custodians"><a class="header" href="#staking-on-someones-behalf-for-custodians">Staking on someone’s behalf (for custodians)</a></h2>
<p>There is a limitation the the staking address can only perform the following actions (and are visible via the Nym Wallet:</p>
<ul>
<li>Bond on the gaƒteway’s or mix node’s behalf.</li>
<li>Delegate or Undelegate (to a mix node in order to begin receiving rewards)</li>
<li>Claiming the rewards on the account</li>
</ul>
<p>:::note
The staking address has no ability to withdraw any coins from the parent’s account.
:::</p>
<p>The staking address must maintain the same level of security as the parent mnemonic; while the parent mnemonic’s delegations and bonding events will be visible to the parent owner, the staking address will be the only account capable of undoing the bonding and delegating from the mix nodes or gateway.</p>
<p>Query for staking on behlaf of someone else</p>
<pre><code>./nym-cli --config-env-file 'path/to/env/file' --mnemonic &lt;staking address mnemonic&gt;  mixnet delegators delegate --mix-id &lt;input&gt; --identity-key &lt;input&gt; --amount &lt;input&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="code-of-conduct"><a class="header" href="#code-of-conduct">Code of Conduct</a></h1>
<p>We are committed to providing a friendly, safe and welcoming environment for all, regardless of level of experience, gender identity and expression, sexual orientation, disability, personal appearance, body size, race, ethnicity, age, religion, nationality, or other similar characteristic.</p>
<p>Please avoid using overtly sexual aliases or other nicknames that might detract from a friendly, safe and welcoming environment for all.</p>
<p>Please be kind and courteous. There’s no need to be mean or rude.</p>
<p>Respect that people have differences of opinion and that every design or implementation choice carries a trade-off and numerous costs. There is seldom a right answer.</p>
<p>Please keep unstructured critique to a minimum. If you have solid ideas you want to experiment with, make a fork and see how it works.</p>
<p>We will exclude you from interaction if you insult, demean or harass anyone. That is not welcome behaviour. We interpret the term “harassment” as including the definition in the Citizen Code of Conduct; if you have any lack of clarity about what might be included in that concept, please read their definition. In particular, we don’t tolerate behaviour that excludes people in socially marginalized groups.</p>
<p>Private harassment is also unacceptable. No matter who you are, if you feel you have been or are being harassed or made uncomfortable by a community member, please contact one of the channel ops or any of the Rust moderation team immediately. Whether you’re a regular contributor or a newcomer, we care about making this community a safe place for you and we’ve got your back.</p>
<p>Likewise any spamming, trolling, flaming, baiting or other attention-stealing behaviour is not welcome.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="licensing"><a class="header" href="#licensing">Licensing</a></h1>
<p>Nym is Free Software released under the Apache License V2.</p>
<p>All of the contributions of the Nym core developers are © Nym Technologies SA. If you are interested in talking to us about other licenses, please get in touch.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="theme/pagetoc.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
